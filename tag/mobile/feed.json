{
    "version": "https://jsonfeed.org/version/1",
    "title": "ililiiY • All posts by \"mobile\" tag",
    "description": "承蒙的是希望 做出你想做的",
    "home_page_url": "https://lookhui.github.io",
    "items": [
        {
            "id": "https://lookhui.github.io/MOBILE%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/",
            "url": "https://lookhui.github.io/MOBILE%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95/",
            "title": "MOBILE刷题记录",
            "date_published": "2023-12-19T12:27:44.000Z",
            "content_html": "<h4 id=\"ciscn-2022-东北crackme_android\"><a class=\"anchor\" href=\"#ciscn-2022-东北crackme_android\">#</a> [CISCN 2022 东北] crackme_Android</h4>\n<p>安卓逆向使用 jadx 来转</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public boolean check(CharSequence flag) &#123;</span><br><span class=\"line\">       if (flag.length() == 38 &amp;&amp; flag.subSequence(0, 5).toString().equals(&quot;flag&#123;&quot;) &amp;&amp; flag.charAt(flag.length() - 1) == &#x27;&#125;&#x27;) &#123;</span><br><span class=\"line\">           CharSequence data = flag.subSequence(5, flag.length() - 1);</span><br><span class=\"line\">           StringBuilder sumval = new StringBuilder();</span><br><span class=\"line\">           for (int i = 0; i &lt; data.length(); i += 4) &#123;</span><br><span class=\"line\">               sumval.append(md5(data.subSequence(i, i + 4).toString()));</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">           return sumval.toString().equals(&quot;8393931a16db5a00f464a24abe24b17a9040b57d9cb2cbfa6bdc61d12e9b51f2789e8a8ae9406c969118e75e9bc65c4327fbc7c3accdf2c54675b0ddf3e0a6099b1b81046d525495e3a14ff6eae76eddfa1740cd6bd483da0f7684b2e4ec84b371f07bf95f0113eefab12552181dd832af8d1eb220186400c494db7091e402b0&quot;);</span><br><span class=\"line\">       &#125;</span><br><span class=\"line\">       return false;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   /* JADX INFO: Access modifiers changed from: protected */</span><br><span class=\"line\">   @Override // androidx.fragment.app.FragmentActivity, androidx.activity.ComponentActivity, androidx.core.app.ComponentActivity, android.app.Activity</span><br><span class=\"line\">   public void onCreate(Bundle savedInstanceState) &#123;</span><br><span class=\"line\">       super.onCreate(savedInstanceState);</span><br><span class=\"line\">       setContentView(R.layout.activity_main);</span><br><span class=\"line\">       Button button = (Button) findViewById(R.id.button);</span><br><span class=\"line\">       final EditText flagInput = (EditText) findViewById(R.id.flagInput);</span><br><span class=\"line\">       button.setOnClickListener(new View.OnClickListener() &#123; // from class: com.example.crackme1.MainActivity.1</span><br><span class=\"line\">           @Override // android.view.View.OnClickListener</span><br><span class=\"line\">           public void onClick(View view) &#123;</span><br><span class=\"line\">               CharSequence flag = flagInput.getText();</span><br><span class=\"line\">               if (MainActivity.this.check(flag)) &#123;</span><br><span class=\"line\">                   Toast.makeText(MainActivity.this, &quot;Right!&quot;, 0).show();</span><br><span class=\"line\">               &#125; else &#123;</span><br><span class=\"line\">                   Toast.makeText(MainActivity.this, &quot;Wrong!&quot;, 0).show();</span><br><span class=\"line\">               &#125;</span><br><span class=\"line\">           &#125;</span><br><span class=\"line\">       &#125;);</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<p>sumval.toString ().equals (&quot;8393931a16db5a00f464a24abe24b17a9040b57d9cb2cbfa6bdc61d12e9b51f2789e8a8ae9406c969118e75e9bc65c4327fbc7c3accdf2c54675b0ddf3e0a6099b1b81046d525495e3a14ff6eae76eddfa1740cd6bd483da0f7684b2e4ec84b371f07bf95f0113eefab12552181dd832af8d1eb220186400c494db7091e402b0&quot;); 需要注意的是这个上面有一个 md5 的信息</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt;&gt;&gt; s=&#x27;8393931a16db5a00f464a24abe24b17a9040b57d9cb2cbfa6bdc61d12e9b51f2789e8a8ae9406c969118e75e9bc65c4327fbc7c3accdf2c54675b0ddf3e0a6099b1b81046d525495e3a14ff6eae76eddfa1740cd6bd483da0f7684b2e4ec84b371f07bf95f0113eefab12552181dd832af8d1eb220186400c494db7091e402b0&#x27;</span><br><span class=\"line\">&gt;&gt;&gt; len(s)</span><br><span class=\"line\">256</span><br><span class=\"line\">&gt;&gt;&gt; 256/32</span><br><span class=\"line\">8.0</span><br></pre></td></tr></table></figure></p>\n<p>相当于 8 段 md5</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">s=&#x27;8393931a16db5a00f464a24abe24b17a9040b57d9cb2cbfa6bdc61d12e9b51f2789e8a8ae9406c969118e75e9bc65c4327fbc7c3accdf2c54675b0ddf3e0a6099b1b81046d525495e3a14ff6eae76eddfa1740cd6bd483da0f7684b2e4ec84b371f07bf95f0113eefab12552181dd832af8d1eb220186400c494db7091e402b0&#x27;</span><br><span class=\"line\">for j in range(0,len(s),32):</span><br><span class=\"line\">        print(s[j:j+32])</span><br></pre></td></tr></table></figure></p>\n<p>得到</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">8393931a16db5a00f464a24abe24b17a</span><br><span class=\"line\">9040b57d9cb2cbfa6bdc61d12e9b51f2</span><br><span class=\"line\">789e8a8ae9406c969118e75e9bc65c43</span><br><span class=\"line\">27fbc7c3accdf2c54675b0ddf3e0a609</span><br><span class=\"line\">9b1b81046d525495e3a14ff6eae76edd</span><br><span class=\"line\">fa1740cd6bd483da0f7684b2e4ec84b3</span><br><span class=\"line\">71f07bf95f0113eefab12552181dd832</span><br><span class=\"line\">af8d1eb220186400c494db7091e402b0</span><br></pre></td></tr></table></figure></p>\n<p 4aea146e9dc7365e4ec931f547284822=\"\">flag</p>\n<h4 id=\"hgame-2022-week1flagchecker\"><a class=\"anchor\" href=\"#hgame-2022-week1flagchecker\">#</a> [HGAME 2022 week1]flagchecker</h4>\n<p>类名查找找到 main 函数后在</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">public class MainActivity extends AppCompatActivity &#123;</span><br><span class=\"line\">    /* JADX INFO: Access modifiers changed from: protected */</span><br><span class=\"line\">    @Override // android.support.v7.app.AppCompatActivity, android.support.v4.app.FragmentActivity, android.support.v4.app.SupportActivity, android.app.Activity</span><br><span class=\"line\">    public void onCreate(Bundle bundle) &#123;</span><br><span class=\"line\">        super.onCreate(bundle);</span><br><span class=\"line\">        setContentView(R.layout.activity_main);</span><br><span class=\"line\">        ((Button) findViewById(R.id.button)).setOnClickListener(new View.OnClickListener() &#123; // from class: com.example.flagchecker.MainActivity.1</span><br><span class=\"line\">            @Override // android.view.View.OnClickListener</span><br><span class=\"line\">            public void onClick(View view) &#123;</span><br><span class=\"line\">                byte[] bArr = new byte[0];</span><br><span class=\"line\">                try &#123;</span><br><span class=\"line\">                    bArr = MainActivity.encrypt(((EditText) MainActivity.this.findViewById(R.id.editTextTextPersonName)).getText().toString(), &quot;carol&quot;);</span><br><span class=\"line\">                &#125; catch (Exception e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                if (Base64.encodeToString(bArr, 0).replace(&quot;\\n&quot;, &quot;&quot;).equals(&quot;mg6CITV6GEaFDTYnObFmENOAVjKcQmGncF90WhqvCFyhhsyqq1s=&quot;)) &#123;</span><br><span class=\"line\">                    Toast.makeText(MainActivity.this, &quot;Congratulations!!!&quot;, 1).show();</span><br><span class=\"line\">                &#125; else &#123;</span><br><span class=\"line\">                    Toast.makeText(MainActivity.this, &quot;Fail,try again.&quot;, 1).show();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public static byte[] encrypt(String str, String str2) throws Exception &#123;</span><br><span class=\"line\">        SecretKeySpec secretKeySpec = new SecretKeySpec(str2.getBytes(), 0, str2.length(), &quot;RC4&quot;);</span><br><span class=\"line\">        Cipher cipher = Cipher.getInstance(&quot;RC4&quot;);</span><br><span class=\"line\">        cipher.init(1, secretKeySpec);</span><br><span class=\"line\">        return cipher.doFinal(str.getBytes());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>这里的</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mg6CITV6GEaFDTYnObFmENOAVjKcQmGncF90WhqvCFyhhsyqq1s=</span><br></pre></td></tr></table></figure></p>\n<p>密钥</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">carol</span><br></pre></td></tr></table></figure></p>\n<p>厨子 rc4 解密得到 flag</p>\n<h4 id=\"swpu-2019easyapp\"><a class=\"anchor\" href=\"#swpu-2019easyapp\">#</a> [SWPU 2019]easyapp</h4>\n",
            "tags": [
                "mobile"
            ]
        }
    ]
}